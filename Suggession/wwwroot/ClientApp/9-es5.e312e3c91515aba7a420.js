!function(){function t(t,i){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,i){if(!t)return;if("string"==typeof t)return e(t,i);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,i)}(t))||i&&t&&"number"==typeof t.length){n&&(t=n);var c=0,o=function(){};return{s:o,n:function(){return c>=t.length?{done:!0}:{done:!1,value:t[c++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,l=!0,r=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return l=t.done,t},e:function(t){r=!0,a=t},f:function(){try{l||null==n.return||n.return()}finally{if(r)throw a}}}}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)}function n(t,e){return(n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=a(t);if(e){var c=a(this).constructor;i=Reflect.construct(n,arguments,c)}else i=n.apply(this,arguments);return o(this,i)}}function o(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function b(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"tm/U":function(e,n,o){"use strict";o.r(n),o.d(n,"HttpLoaderFactory",function(){return ni}),o.d(n,"ReportModule",function(){return ai});var a=o("10VE"),r=o("SVse"),u=o("s7LF"),d=o("TSSN"),s=o("OoJn"),p=o("sWsm"),f=o("PDtH"),g=o("emFE"),h=o("k5Gf"),m=o("4SUy"),v=o("1H6I"),U=o("2Vo4"),C=o("IheW"),V=o("AytR"),I=o("8Y7J");new C.e({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")});var S,y=((S=function(){function t(e,i){l(this,t),this.http=e,this.env=i,this.baseUrl=V.a.apiUrl,this.messageSource=new U.a(0),this.currentMessage=this.messageSource.asObservable()}return b(t,[{key:"changeMessage",value:function(t){this.messageSource.next(t)}},{key:"getQ1Q3Data",value:function(){return this.http.get("".concat(this.env.apiUrl,"Report/GetQ1Q3Data"),{})}},{key:"getGHRData",value:function(){return this.http.get("".concat(this.env.apiUrl,"Report/GetGHRData"),{})}},{key:"getQ1Q3DataByLeo",value:function(t){return this.http.get("".concat(this.env.apiUrl,"Report/getQ1Q3DataByLeo?currentTime=").concat(t),{})}},{key:"getQ1Q3ReportInfo",value:function(t){return this.http.get("".concat(this.env.apiUrl,"Report/getQ1Q3ReportInfo?accountId=").concat(t),{})}},{key:"q1q3ExportExcel",value:function(t){return this.http.get("".concat(this.env.apiUrl,"Report/ExportExcel/").concat(t),{responseType:"blob"})}},{key:"q1q3ExportExcelByLeo",value:function(t){return this.http.get("".concat(this.env.apiUrl,"Report/ExportExcelByLeo?currentTime=").concat(t),{responseType:"blob"})}},{key:"geH1H2Data",value:function(){return this.http.get("".concat(this.env.apiUrl,"Report/GetH1H2Data"),{})}},{key:"H1H2ExportExcel",value:function(t){return this.http.get("".concat(this.env.apiUrl,"Report/ExportH1H2Excel/").concat(t),{responseType:"blob"})}},{key:"getH1H2ReportInfo",value:function(t){return this.http.get("".concat(this.env.apiUrl,"Report/getH1H2ReportInfo?accountId=").concat(t),{})}},{key:"getGHRReportH1Info",value:function(t){return this.http.get("".concat(this.env.apiUrl,"Report/GetGHRReportH1Info?accountId=").concat(t),{})}},{key:"getGHRReportH2Info",value:function(t){return this.http.get("".concat(this.env.apiUrl,"Report/GetGHRReportH2Info?accountId=").concat(t),{})}},{key:"ReportUpdateComment",value:function(t){return this.http.put("".concat(this.env.apiUrl,"Report/ReportUpdateComment"),t)}},{key:"ReportUpdateAtScore",value:function(t){return this.http.put("".concat(this.env.apiUrl,"Report/ReportUpdateAtScore"),t)}},{key:"ReportUpdateSpe",value:function(t){return this.http.put("".concat(this.env.apiUrl,"Report/ReportUpdateSpeComment"),t)}},{key:"geHQHRData",value:function(){return this.http.get("".concat(this.env.apiUrl,"Report/GetHQHRData"),{})}}]),t}()).\u0275fac=function(t){return new(t||S)(I.cc(C.b),I.cc(v.a))},S.\u0275prov=I.Lb({token:S,factory:S.\u0275fac,providedIn:"root"}),S),H=o("dQqK"),w=o("HJFG"),x=o("L6UN"),k=o("G0yt"),D=o("7g+E"),Q=o("iInd"),A=o("4DqM"),R=o("7YrF"),P=["grid"],E=["detailModal"];function _(t,e){if(1&t&&I.Ic(0),2&t){var i=e.$implicit,n=I.ic();I.Kc(" ",n.NO(i.index)," ")}}function T(t,e){1&t&&I.Ic(0," # ")}function G(t,e){if(1&t){var i=I.Wb();I.Vb(0,"button",17),I.fc("click",function(){I.Ac(i);var t=e.$implicit,n=I.ic(),c=I.xc(22);return n.openModal(t,c,"H1")}),I.Ic(1,"H1"),I.Ub(),I.Ic(2," | "),I.Vb(3,"button",17),I.fc("click",function(){I.Ac(i);var t=e.$implicit,n=I.ic(),c=I.xc(24);return n.openModal(t,c,"H2")}),I.Ic(4,"H2"),I.Ub()}}function O(t,e){if(1&t&&I.Ic(0),2&t){var i=e.$implicit,n=I.ic(2);I.Kc(" ",n.NO(i.index)," ")}}function M(t,e){if(1&t&&(I.Vb(0,"li"),I.Ic(1),I.Ub()),2&t){var i=e.$implicit;I.Cb(1),I.Jc(i)}}function K(t,e){if(1&t&&(I.Vb(0,"ul",58),I.Gc(1,M,2,1,"li",59),I.Ub()),2&t){var i=e.$implicit;I.Cb(1),I.oc("ngForOf",i.l0ActionList)}}function L(t,e){if(1&t&&(I.Vb(0,"tr",61),I.Vb(1,"td",62),I.Ic(2),I.Ub(),I.Ub()),2&t){var i=e.$implicit;I.Cb(2),I.Jc(i.headerText)}}function q(t,e){if(1&t&&I.Gc(0,L,3,1,"tr",60),2&t){var i=I.ic(2);I.oc("ngForOf",i.columns)}}function $(t,e){if(1&t&&(I.Vb(0,"tr",61),I.Vb(1,"td",62),I.Ic(2),I.Ub(),I.Ub()),2&t){var i=e.$implicit;I.Cb(2),I.Jc(i.headerText)}}function J(t,e){if(1&t&&I.Gc(0,$,3,1,"tr",60),2&t){var i=I.ic(2);I.oc("ngForOf",i.Resultcolumns)}}function z(t,e){1&t&&I.Ic(0),2&t&&I.Kc(" ",e.$implicit.kpiComment," ")}function j(t,e){if(1&t&&(I.Tb(0),I.Qb(1,"input",66),I.Sb()),2&t){var i=I.ic().$implicit;I.Cb(1),I.oc("value",i.q1)}}function B(t,e){if(1&t&&I.Qb(0,"input",67),2&t){var i=I.ic().$implicit;I.oc("value",i.q1)}}function N(t,e){if(1&t&&(I.Vb(0,"span",63),I.Gc(1,j,2,1,"ng-container",64),I.Gc(2,B,1,1,"ng-template",null,65,I.Hc),I.Ub()),2&t){var i=e.$implicit,n=I.xc(3);I.oc("ngClass",""===i.q1?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),I.Cb(1),I.oc("ngIf",""===i.q1)("ngIfElse",n)}}function F(t,e){if(1&t&&(I.Tb(0),I.Qb(1,"input",68),I.Sb()),2&t){var i=I.ic().$implicit;I.Cb(1),I.oc("value",i.q2)}}function W(t,e){if(1&t&&I.Qb(0,"input",69),2&t){var i=I.ic().$implicit;I.oc("value",i.q2)}}function Y(t,e){if(1&t&&(I.Vb(0,"span",63),I.Gc(1,F,2,1,"ng-container",64),I.Gc(2,W,1,1,"ng-template",null,65,I.Hc),I.Ub()),2&t){var i=e.$implicit,n=I.xc(3);I.oc("ngClass",""===i.q2?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),I.Cb(1),I.oc("ngIf",""===i.q2)("ngIfElse",n)}}function X(t,e){1&t&&I.Ic(0),2&t&&I.Kc(" ",e.$implicit.attitudeComment," ")}function Z(t,e){if(1&t&&(I.Tb(0),I.Qb(1,"input",70),I.Sb()),2&t){var i=I.ic().$implicit;I.Cb(1),I.oc("value",i.h1)}}function tt(t,e){if(1&t&&I.Qb(0,"input",71),2&t){var i=I.ic().$implicit;I.oc("value",i.h1)}}function et(t,e){if(1&t&&(I.Vb(0,"span",63),I.Gc(1,Z,2,1,"ng-container",64),I.Gc(2,tt,1,1,"ng-template",null,65,I.Hc),I.Ub()),2&t){var i=e.$implicit,n=I.xc(3);I.oc("ngClass",""===i.h1?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),I.Cb(1),I.oc("ngIf",""===i.h1)("ngIfElse",n)}}function it(t,e){if(1&t&&(I.Tb(0),I.Qb(1,"input",72),I.Sb()),2&t){var i=I.ic().$implicit;I.Cb(1),I.oc("value",i.l1)}}function nt(t,e){if(1&t&&I.Qb(0,"input",73),2&t){var i=I.ic().$implicit;I.oc("value",i.l1)}}function ct(t,e){if(1&t&&(I.Vb(0,"span",63),I.Gc(1,it,2,1,"ng-container",64),I.Gc(2,nt,1,1,"ng-template",null,65,I.Hc),I.Ub()),2&t){var i=e.$implicit,n=I.xc(3);I.oc("ngClass",0===i.l1?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),I.Cb(1),I.oc("ngIf",0===i.l1)("ngIfElse",n)}}function ot(t,e){if(1&t&&(I.Tb(0),I.Qb(1,"input",74),I.Sb()),2&t){var i=I.ic().$implicit;I.Cb(1),I.oc("value",i.l2)}}function at(t,e){if(1&t&&I.Qb(0,"input",75),2&t){var i=I.ic().$implicit;I.oc("value",i.l2)}}function lt(t,e){if(1&t&&(I.Vb(0,"span",63),I.Gc(1,ot,2,1,"ng-container",64),I.Gc(2,at,1,1,"ng-template",null,65,I.Hc),I.Ub()),2&t){var i=e.$implicit,n=I.xc(3);I.oc("ngClass",0===i.l2?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),I.Cb(1),I.oc("ngIf",0===i.l2)("ngIfElse",n)}}function rt(t,e){if(1&t&&(I.Tb(0),I.Qb(1,"input",76),I.Sb()),2&t){var i=I.ic().$implicit;I.Cb(1),I.oc("value",i.fl)}}function bt(t,e){if(1&t&&I.Qb(0,"input",77),2&t){var i=I.ic().$implicit;I.oc("value",i.fl)}}function ut(t,e){if(1&t&&(I.Vb(0,"span",63),I.Gc(1,rt,2,1,"ng-container",64),I.Gc(2,bt,1,1,"ng-template",null,65,I.Hc),I.Ub()),2&t){var i=e.$implicit,n=I.xc(3);I.oc("ngClass",0===i.fl?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),I.Cb(1),I.oc("ngIf",0===i.fl)("ngIfElse",n)}}function dt(t,e){1&t&&I.Ic(0),2&t&&I.Kc(" ",e.$implicit.score," ")}function st(t,e){if(1&t&&(I.Tb(0),I.Qb(1,"input",78),I.Sb()),2&t){var i=I.ic().$implicit;I.Cb(1),I.oc("value",i.comment)}}function pt(t,e){if(1&t&&I.Qb(0,"input",79),2&t){var i=I.ic().$implicit;I.oc("value",i.comment)}}function ft(t,e){if(1&t&&(I.Vb(0,"span",63),I.Gc(1,st,2,1,"ng-container",64),I.Gc(2,pt,1,1,"ng-template",null,65,I.Hc),I.Ub()),2&t){var i=e.$implicit,n=I.xc(3);I.oc("ngClass",""===i.comment?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),I.Cb(1),I.oc("ngIf",""===i.comment)("ngIfElse",n)}}function gt(t,e){if(1&t){var i=I.Wb();I.Qb(0,"a",null,18),I.Vb(2,"div",19),I.Vb(3,"h4",20),I.Qb(4,"i",21),I.Ic(5," GHR Report "),I.Ub(),I.Vb(6,"button",22),I.fc("click",function(){return e.$implicit.dismiss("Cross click")}),I.Vb(7,"span",23),I.Ic(8,"\xd7"),I.Ub(),I.Ub(),I.Ub(),I.Vb(9,"div",24),I.Vb(10,"div",0),I.Vb(11,"div",1),I.Vb(12,"div",0),I.Vb(13,"div",1),I.Vb(14,"div",0),I.Vb(15,"div",25),I.Ic(16),I.Ub(),I.Vb(17,"div",25),I.Ic(18),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Vb(19,"div",26),I.Vb(20,"span"),I.Ic(21),I.Ub(),I.Ub(),I.Vb(22,"ejs-grid",27,7),I.fc("queryCellInfo",function(t){return I.Ac(i),I.ic().queryCellInfoEvent(t)}),I.Vb(24,"e-columns"),I.Vb(25,"e-column",28),I.Gc(26,O,1,1,"ng-template",null,9,I.Hc),I.Ub(),I.Qb(28,"e-column",29),I.Qb(29,"e-column",30),I.Vb(30,"e-column",31),I.Gc(31,K,2,1,"ng-template",null,9,I.Hc),I.Ub(),I.Vb(33,"e-column",32),I.Gc(34,q,1,1,"ng-template",null,9,I.Hc),I.Ub(),I.Vb(36,"e-column",33),I.Gc(37,J,1,1,"ng-template",null,9,I.Hc),I.Ub(),I.Ub(),I.Ub(),I.Qb(39,"hr"),I.Vb(40,"div",26),I.Vb(41,"span"),I.Ic(42,"KPI \u8a55\u8a9e"),I.Ub(),I.Ub(),I.Vb(43,"ejs-grid",34,35),I.fc("actionComplete",function(t){return I.Ac(i),I.ic().actionCompleteKPIComment(t)})("actionBegin",function(t){return I.Ac(i),I.ic().actionBeginKPIComment(t)})("recordDoubleClick",function(t){return I.Ac(i),I.ic().onDoubleClickKPIComment(t)}),I.Vb(45,"e-columns"),I.Vb(46,"e-column",36),I.Gc(47,z,1,1,"ng-template",null,10,I.Hc),I.Ub(),I.Vb(49,"e-column",37),I.Gc(50,N,4,3,"ng-template",null,10,I.Hc),I.Ub(),I.Vb(52,"e-column",38),I.Gc(53,Y,4,3,"ng-template",null,10,I.Hc),I.Ub(),I.Ub(),I.Ub(),I.Qb(55,"hr"),I.Vb(56,"div",26),I.Vb(57,"span"),I.Ic(58,"\u614b\u5ea6\u8a55\u8a9e"),I.Ub(),I.Ub(),I.Vb(59,"ejs-grid",39,7),I.fc("actionComplete",function(t){return I.Ac(i),I.ic().actionCompleteAtComment(t)})("actionBegin",function(t){return I.Ac(i),I.ic().actionBeginAtComment(t)}),I.Vb(61,"e-columns"),I.Vb(62,"e-column",40),I.Gc(63,X,1,1,"ng-template",null,10,I.Hc),I.Ub(),I.Vb(65,"e-column",41),I.Gc(66,et,4,3,"ng-template",null,10,I.Hc),I.Ub(),I.Ub(),I.Ub(),I.Qb(68,"hr"),I.Vb(69,"div",26),I.Vb(70,"span"),I.Ic(71),I.Ub(),I.Ub(),I.Vb(72,"ejs-grid",42,7),I.fc("actionComplete",function(t){return I.Ac(i),I.ic().actionCompleteAtScore(t)})("actionBegin",function(t){return I.Ac(i),I.ic().actionBeginAtScore(t)}),I.Vb(74,"e-columns"),I.Vb(75,"e-column",43),I.Gc(76,ct,4,3,"ng-template",null,10,I.Hc),I.Ub(),I.Vb(78,"e-column",44),I.Gc(79,lt,4,3,"ng-template",null,10,I.Hc),I.Ub(),I.Vb(81,"e-column",45),I.Gc(82,ut,4,3,"ng-template",null,10,I.Hc),I.Ub(),I.Ub(),I.Ub(),I.Qb(84,"hr"),I.Vb(85,"div",26),I.Vb(86,"span"),I.Ic(87),I.Ub(),I.Ub(),I.Vb(88,"ejs-grid",46,7),I.Vb(90,"e-columns"),I.Qb(91,"e-column",47),I.Qb(92,"e-column",43),I.Qb(93,"e-column",44),I.Qb(94,"e-column",48),I.Ub(),I.Ub(),I.Qb(95,"hr"),I.Vb(96,"div",26),I.Vb(97,"span"),I.Ic(98),I.Ub(),I.Ub(),I.Vb(99,"ejs-grid",49,7),I.fc("actionComplete",function(t){return I.Ac(i),I.ic().actionCompleteSpeScore(t)})("actionBegin",function(t){return I.Ac(i),I.ic().actionBeginSpeScore(t)}),I.Vb(101,"e-columns"),I.Vb(102,"e-column",50),I.Gc(103,dt,1,1,"ng-template",null,10,I.Hc),I.Ub(),I.Vb(105,"e-column",51),I.Gc(106,ft,4,3,"ng-template",null,10,I.Hc),I.Ub(),I.Ub(),I.Ub(),I.Qb(108,"hr"),I.Vb(109,"span"),I.Ic(110),I.Ub(),I.Vb(111,"div",52),I.Vb(112,"button",53),I.fc("click",function(){return e.$implicit.close("Close click")}),I.Ic(113,"Back"),I.Ub(),I.Ic(114," | "),I.Vb(115,"button",54),I.fc("click",function(){return I.Ac(i),I.ic().save()}),I.Ic(116,"Submit"),I.Ub(),I.Vb(117,"span",55),I.Ic(118,"| |"),I.Ub(),I.Vb(119,"a",56),I.fc("click",function(){I.Ac(i);var t=I.xc(1);return I.ic().scroll(t)}),I.Qb(120,"i",57),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub()}if(2&t){var n=I.ic();I.Cb(16),I.Kc("Dept. ",n.dept,""),I.Cb(2),I.Kc("Name: ",n.name,""),I.Cb(3),I.Jc(n.title),I.Cb(1),I.oc("dataSource",n.gridDataH1)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",n.toolbarOptions)("pageSettings",n.pageSettings)("allowExcelExport",!0),I.Cb(21),I.oc("dataSource",n.kpicommentH1)("allowResizing",!0)("showColumnMenu",!0)("editSettings",n.editCommentSettings),I.Cb(16),I.oc("allowResizing",!0)("editSettings",n.editCommentSettings)("dataSource",n.attitudecommentData)("showColumnMenu",!0),I.Cb(12),I.Kc("Attitude Score ",n.titles,""),I.Cb(1),I.oc("dataSource",n.atScoreData)("editSettings",n.editCommentSettings)("allowResizing",!0)("showColumnMenu",!0),I.Cb(15),I.Kc("KPI Score ",n.titles,""),I.Cb(1),I.oc("dataSource",n.kpiScoreData)("allowResizing",!0)("showColumnMenu",!0),I.Cb(10),I.Kc("Special Score ",n.titles,""),I.Cb(1),I.oc("allowResizing",!0)("dataSource",n.specialScoreData)("editSettings",n.editCommentSettings)("showColumnMenu",!0),I.Cb(11),I.Lc("",n.titles," Score: ",n.h1Score,"")}}function ht(t,e){if(1&t&&I.Ic(0),2&t){var i=e.$implicit,n=I.ic(2);I.Kc(" ",n.NO(i.index)," ")}}function mt(t,e){if(1&t&&(I.Vb(0,"li"),I.Ic(1),I.Ub()),2&t){var i=e.$implicit;I.Cb(1),I.Jc(i)}}function vt(t,e){if(1&t&&(I.Vb(0,"ul",58),I.Gc(1,mt,2,1,"li",59),I.Ub()),2&t){var i=e.$implicit;I.Cb(1),I.oc("ngForOf",i.l0ActionList)}}function Ut(t,e){if(1&t&&(I.Vb(0,"tr",61),I.Vb(1,"td",62),I.Ic(2),I.Ub(),I.Ub()),2&t){var i=e.$implicit;I.Cb(2),I.Jc(i.headerText)}}function Ct(t,e){if(1&t&&I.Gc(0,Ut,3,1,"tr",60),2&t){var i=I.ic(2);I.oc("ngForOf",i.columns)}}function Vt(t,e){if(1&t&&(I.Vb(0,"tr",61),I.Vb(1,"td",62),I.Ic(2),I.Ub(),I.Ub()),2&t){var i=e.$implicit;I.Cb(2),I.Jc(i.headerText)}}function It(t,e){if(1&t&&I.Gc(0,Vt,3,1,"tr",60),2&t){var i=I.ic(2);I.oc("ngForOf",i.Resultcolumns)}}function St(t,e){1&t&&I.Ic(0),2&t&&I.Kc(" ",e.$implicit.kpiComment," ")}function yt(t,e){if(1&t&&(I.Tb(0),I.Qb(1,"input",66),I.Sb()),2&t){var i=I.ic().$implicit;I.Cb(1),I.oc("value",i.q1)}}function Ht(t,e){if(1&t&&I.Qb(0,"input",67),2&t){var i=I.ic().$implicit;I.oc("value",i.q1)}}function wt(t,e){if(1&t&&(I.Vb(0,"span",63),I.Gc(1,yt,2,1,"ng-container",64),I.Gc(2,Ht,1,1,"ng-template",null,65,I.Hc),I.Ub()),2&t){var i=e.$implicit,n=I.xc(3);I.oc("ngClass",""===i.q1?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),I.Cb(1),I.oc("ngIf",""===i.q1)("ngIfElse",n)}}function xt(t,e){if(1&t&&(I.Tb(0),I.Qb(1,"input",68),I.Sb()),2&t){var i=I.ic().$implicit;I.Cb(1),I.oc("value",i.q2)}}function kt(t,e){if(1&t&&I.Qb(0,"input",69),2&t){var i=I.ic().$implicit;I.oc("value",i.q2)}}function Dt(t,e){if(1&t&&(I.Vb(0,"span",63),I.Gc(1,xt,2,1,"ng-container",64),I.Gc(2,kt,1,1,"ng-template",null,65,I.Hc),I.Ub()),2&t){var i=e.$implicit,n=I.xc(3);I.oc("ngClass",""===i.q2?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),I.Cb(1),I.oc("ngIf",""===i.q2)("ngIfElse",n)}}function Qt(t,e){1&t&&I.Ic(0),2&t&&I.Kc(" ",e.$implicit.attitudeComment," ")}function At(t,e){if(1&t&&(I.Tb(0),I.Qb(1,"input",70),I.Sb()),2&t){var i=I.ic().$implicit;I.Cb(1),I.oc("value",i.h1)}}function Rt(t,e){if(1&t&&I.Qb(0,"input",71),2&t){var i=I.ic().$implicit;I.oc("value",i.h1)}}function Pt(t,e){if(1&t&&(I.Vb(0,"span",63),I.Gc(1,At,2,1,"ng-container",64),I.Gc(2,Rt,1,1,"ng-template",null,65,I.Hc),I.Ub()),2&t){var i=e.$implicit,n=I.xc(3);I.oc("ngClass",""===i.h1?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),I.Cb(1),I.oc("ngIf",""===i.h1)("ngIfElse",n)}}function Et(t,e){if(1&t&&(I.Tb(0),I.Qb(1,"input",72),I.Sb()),2&t){var i=I.ic().$implicit;I.Cb(1),I.oc("value",i.l1)}}function _t(t,e){if(1&t&&I.Qb(0,"input",73),2&t){var i=I.ic().$implicit;I.oc("value",i.l1)}}function Tt(t,e){if(1&t&&(I.Vb(0,"span",63),I.Gc(1,Et,2,1,"ng-container",64),I.Gc(2,_t,1,1,"ng-template",null,65,I.Hc),I.Ub()),2&t){var i=e.$implicit,n=I.xc(3);I.oc("ngClass",0===i.l1?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),I.Cb(1),I.oc("ngIf",0===i.l1)("ngIfElse",n)}}function Gt(t,e){if(1&t&&(I.Tb(0),I.Qb(1,"input",74),I.Sb()),2&t){var i=I.ic().$implicit;I.Cb(1),I.oc("value",i.l2)}}function Ot(t,e){if(1&t&&I.Qb(0,"input",75),2&t){var i=I.ic().$implicit;I.oc("value",i.l2)}}function Mt(t,e){if(1&t&&(I.Vb(0,"span",63),I.Gc(1,Gt,2,1,"ng-container",64),I.Gc(2,Ot,1,1,"ng-template",null,65,I.Hc),I.Ub()),2&t){var i=e.$implicit,n=I.xc(3);I.oc("ngClass",0===i.l2?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),I.Cb(1),I.oc("ngIf",0===i.l2)("ngIfElse",n)}}function Kt(t,e){if(1&t&&(I.Tb(0),I.Qb(1,"input",76),I.Sb()),2&t){var i=I.ic().$implicit;I.Cb(1),I.oc("value",i.fl)}}function Lt(t,e){if(1&t&&I.Qb(0,"input",77),2&t){var i=I.ic().$implicit;I.oc("value",i.fl)}}function qt(t,e){if(1&t&&(I.Vb(0,"span",63),I.Gc(1,Kt,2,1,"ng-container",64),I.Gc(2,Lt,1,1,"ng-template",null,65,I.Hc),I.Ub()),2&t){var i=e.$implicit,n=I.xc(3);I.oc("ngClass",0===i.fl?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),I.Cb(1),I.oc("ngIf",0===i.fl)("ngIfElse",n)}}function $t(t,e){1&t&&I.Ic(0),2&t&&I.Kc(" ",e.$implicit.score," ")}function Jt(t,e){if(1&t&&(I.Tb(0),I.Qb(1,"input",78),I.Sb()),2&t){var i=I.ic().$implicit;I.Cb(1),I.oc("value",i.comment)}}function zt(t,e){if(1&t&&I.Qb(0,"input",79),2&t){var i=I.ic().$implicit;I.oc("value",i.comment)}}function jt(t,e){if(1&t&&(I.Vb(0,"span",63),I.Gc(1,Jt,2,1,"ng-container",64),I.Gc(2,zt,1,1,"ng-template",null,65,I.Hc),I.Ub()),2&t){var i=e.$implicit,n=I.xc(3);I.oc("ngClass",""===i.comment?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),I.Cb(1),I.oc("ngIf",""===i.comment)("ngIfElse",n)}}function Bt(t,e){if(1&t){var i=I.Wb();I.Qb(0,"a",null,18),I.Vb(2,"div",19),I.Vb(3,"h4",20),I.Qb(4,"i",21),I.Ic(5," GHR Report "),I.Ub(),I.Vb(6,"button",22),I.fc("click",function(){return e.$implicit.dismiss("Cross click")}),I.Vb(7,"span",23),I.Ic(8,"\xd7"),I.Ub(),I.Ub(),I.Ub(),I.Vb(9,"div",24),I.Vb(10,"div",0),I.Vb(11,"div",1),I.Vb(12,"div",0),I.Vb(13,"div",1),I.Vb(14,"div",0),I.Vb(15,"div",25),I.Ic(16),I.Ub(),I.Vb(17,"div",25),I.Ic(18),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Vb(19,"div",26),I.Vb(20,"span"),I.Ic(21),I.Ub(),I.Ub(),I.Vb(22,"ejs-grid",27,7),I.fc("queryCellInfo",function(t){return I.Ac(i),I.ic().queryCellInfoEvent(t)}),I.Vb(24,"e-columns"),I.Vb(25,"e-column",28),I.Gc(26,ht,1,1,"ng-template",null,9,I.Hc),I.Ub(),I.Qb(28,"e-column",29),I.Qb(29,"e-column",30),I.Vb(30,"e-column",31),I.Gc(31,vt,2,1,"ng-template",null,9,I.Hc),I.Ub(),I.Vb(33,"e-column",80),I.Gc(34,Ct,1,1,"ng-template",null,9,I.Hc),I.Ub(),I.Vb(36,"e-column",33),I.Gc(37,It,1,1,"ng-template",null,9,I.Hc),I.Ub(),I.Ub(),I.Ub(),I.Qb(39,"hr"),I.Vb(40,"div",26),I.Vb(41,"span"),I.Ic(42,"KPI \u8a55\u8a9e"),I.Ub(),I.Ub(),I.Vb(43,"ejs-grid",34,35),I.fc("actionComplete",function(t){return I.Ac(i),I.ic().actionCompleteKPIComment(t)})("actionBegin",function(t){return I.Ac(i),I.ic().actionBeginKPIComment(t)})("recordDoubleClick",function(t){return I.Ac(i),I.ic().onDoubleClickKPIComment(t)}),I.Vb(45,"e-columns"),I.Vb(46,"e-column",36),I.Gc(47,St,1,1,"ng-template",null,10,I.Hc),I.Ub(),I.Vb(49,"e-column",81),I.Gc(50,wt,4,3,"ng-template",null,10,I.Hc),I.Ub(),I.Vb(52,"e-column",82),I.Gc(53,Dt,4,3,"ng-template",null,10,I.Hc),I.Ub(),I.Ub(),I.Ub(),I.Qb(55,"hr"),I.Vb(56,"div",26),I.Vb(57,"span"),I.Ic(58,"\u614b\u5ea6\u8a55\u8a9e"),I.Ub(),I.Ub(),I.Vb(59,"ejs-grid",39,7),I.fc("actionComplete",function(t){return I.Ac(i),I.ic().actionCompleteAtComment(t)})("actionBegin",function(t){return I.Ac(i),I.ic().actionBeginAtComment(t)}),I.Vb(61,"e-columns"),I.Vb(62,"e-column",40),I.Gc(63,Qt,1,1,"ng-template",null,10,I.Hc),I.Ub(),I.Vb(65,"e-column",83),I.Gc(66,Pt,4,3,"ng-template",null,10,I.Hc),I.Ub(),I.Ub(),I.Ub(),I.Qb(68,"hr"),I.Vb(69,"div",26),I.Vb(70,"span"),I.Ic(71),I.Ub(),I.Ub(),I.Vb(72,"ejs-grid",42,7),I.fc("actionComplete",function(t){return I.Ac(i),I.ic().actionCompleteAtScore(t)})("actionBegin",function(t){return I.Ac(i),I.ic().actionBeginAtScore(t)}),I.Vb(74,"e-columns"),I.Vb(75,"e-column",43),I.Gc(76,Tt,4,3,"ng-template",null,10,I.Hc),I.Ub(),I.Vb(78,"e-column",44),I.Gc(79,Mt,4,3,"ng-template",null,10,I.Hc),I.Ub(),I.Vb(81,"e-column",45),I.Gc(82,qt,4,3,"ng-template",null,10,I.Hc),I.Ub(),I.Ub(),I.Ub(),I.Qb(84,"hr"),I.Vb(85,"div",26),I.Vb(86,"span"),I.Ic(87),I.Ub(),I.Ub(),I.Vb(88,"ejs-grid",46,7),I.Vb(90,"e-columns"),I.Qb(91,"e-column",47),I.Qb(92,"e-column",43),I.Qb(93,"e-column",44),I.Qb(94,"e-column",48),I.Ub(),I.Ub(),I.Qb(95,"hr"),I.Vb(96,"div",26),I.Vb(97,"span"),I.Ic(98),I.Ub(),I.Ub(),I.Vb(99,"ejs-grid",49,7),I.fc("actionComplete",function(t){return I.Ac(i),I.ic().actionCompleteSpeScore(t)})("actionBegin",function(t){return I.Ac(i),I.ic().actionBeginSpeScore(t)}),I.Vb(101,"e-columns"),I.Vb(102,"e-column",50),I.Gc(103,$t,1,1,"ng-template",null,10,I.Hc),I.Ub(),I.Vb(105,"e-column",51),I.Gc(106,jt,4,3,"ng-template",null,10,I.Hc),I.Ub(),I.Ub(),I.Ub(),I.Qb(108,"hr"),I.Vb(109,"span"),I.Ic(110),I.Ub(),I.Vb(111,"div",52),I.Vb(112,"button",53),I.fc("click",function(){return e.$implicit.close("Close click")}),I.Ic(113,"Back"),I.Ub(),I.Ic(114," | "),I.Vb(115,"button",54),I.fc("click",function(){return I.Ac(i),I.ic().save()}),I.Ic(116,"Submit"),I.Ub(),I.Vb(117,"span",55),I.Ic(118,"| |"),I.Ub(),I.Vb(119,"a",56),I.fc("click",function(){I.Ac(i);var t=I.xc(1);return I.ic().scroll(t)}),I.Qb(120,"i",57),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub()}if(2&t){var n=I.ic();I.Cb(16),I.Kc("Dept. ",n.dept,""),I.Cb(2),I.Kc("Name: ",n.name,""),I.Cb(3),I.Jc(n.title),I.Cb(1),I.oc("dataSource",n.gridDataH1)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",n.toolbarOptions)("pageSettings",n.pageSettings)("allowExcelExport",!0),I.Cb(21),I.oc("dataSource",n.kpicommentH1)("allowResizing",!0)("showColumnMenu",!0)("editSettings",n.editCommentSettings),I.Cb(16),I.oc("allowResizing",!0)("editSettings",n.editCommentSettings)("dataSource",n.attitudecommentData)("showColumnMenu",!0),I.Cb(12),I.Kc("Attitude Score ",n.titles,""),I.Cb(1),I.oc("dataSource",n.atScoreData)("editSettings",n.editCommentSettings)("allowResizing",!0)("showColumnMenu",!0),I.Cb(15),I.Kc("KPI Score ",n.titles,""),I.Cb(1),I.oc("dataSource",n.kpiScoreData)("allowResizing",!0)("showColumnMenu",!0),I.Cb(10),I.Kc("Special Score ",n.titles,""),I.Cb(1),I.oc("allowResizing",!0)("dataSource",n.specialScoreData)("editSettings",n.editCommentSettings)("showColumnMenu",!0),I.Cb(11),I.Lc("",n.titles," Score: ",n.h1Score,"")}}var Nt,Ft=((Nt=function(e){i(o,e);var n=c(o);function o(e,i,c,a,r){var b;return l(this,o),(b=n.call(this)).modalService=e,b.alertify=i,b.spinner=c,b.service=a,b.route=r,b.data=[],b.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},b.locale=localStorage.getItem("lang"),b.editSettings={showDeleteConfirmDialog:!1,allowEditing:!1,allowAdding:!1,allowDeleting:!1,mode:"Normal"},b.editCommentSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!1,allowDeleting:!1,mode:"Normal"},b.toolbarOptions=["Search"],b.avg=0,b.dataCommentPicked=[],b.dataAtScorePicked=[],b.dataSpeScorePicked=[],b.topPosToStartShowing=0,b.queryCellInfoEvent=function(e){var i,n,c=e.data,o=t(b.halfYearSettingsData);try{var a=function(){var t=n.value;(""+t).includes(e.column.field)&&(e.cell.innerText=(null===(i=c.resultOfMonth.filter(function(e){return e.month===t})[0])||void 0===i?void 0:i.title)||"N/A")};for(o.s();!(n=o.n()).done;)a()}catch(l){o.e(l)}finally{o.f()}},b}return b(o,[{key:"onScroll",value:function(t){console.log("aa")}},{key:"ngAfterViewInit",value:function(){}},{key:"ngOnInit",value:function(){this.loadData()}},{key:"scroll",value:function(t){t.scrollIntoView()}},{key:"gotoTop",value:function(){console.log("aaa"),window.scrollTo(0,0)}},{key:"actionBeginKPIComment",value:function(e){if("beginEdit"===e.requestType&&(this.Q1CommentDefault=e.rowData.q1,this.Q2CommentDefault=e.rowData.q2),"save"===e.requestType){this.tempQ1Change=e.data.q1,this.tempQ2Change=e.data.q2;var i=this.Q2CommentDefault.length<this.tempQ2Change.length||this.Q2CommentDefault.length>this.tempQ2Change.length;if((this.Q1CommentDefault.length<this.tempQ1Change.length||this.Q1CommentDefault.length>this.tempQ1Change.length)&&e.data.q1ID>0){var n={ID:e.data.q1ID,Content:e.data.q1},c=this.dataCommentPicked.filter(function(t){return t.ID===e.data.q1ID});if(0===c.length)this.dataCommentPicked.push(n);else{var o,a=t(c);try{for(a.s();!(o=a.n()).done;)for(var l=o.value,r=0;r<c.length;r++)if(l.ID===e.data.q1ID){l.Content=e.data.q1;break}}catch(f){a.e(f)}finally{a.f()}}}if(i&&e.data.q2ID>0){var b={ID:e.data.q2ID,Content:e.data.q2},u=this.dataCommentPicked.filter(function(t){return t.ID===e.data.q2ID});if(0===u.length)this.dataCommentPicked.push(b);else{var d,s=t(u);try{for(s.s();!(d=s.n()).done;){var p=d.value;for(r=0;r<u.length;r++)if(p.ID===e.data.q2ID){p.Content=e.data.q2;break}}}catch(f){s.e(f)}finally{s.f()}}}}}},{key:"onDoubleClickKPIComment",value:function(t){}},{key:"actionCompleteKPIComment",value:function(t){}},{key:"actionBeginAtComment",value:function(e){if("beginEdit"===e.requestType&&(this.H1CommentDefault=e.rowData.h1),"save"===e.requestType&&(this.tempH1Change=e.data.h1,(this.H1CommentDefault.length<this.tempH1Change.length||this.H1CommentDefault.length>this.tempH1Change.length)&&e.data.h1ID>0)){var i={ID:e.data.h1ID,Content:e.data.h1},n=this.dataCommentPicked.filter(function(t){return t.ID===e.data.h1ID});if(0===n.length)this.dataCommentPicked.push(i);else{var c,o=t(n);try{for(o.s();!(c=o.n()).done;)for(var a=c.value,l=0;l<n.length;l++)if(a.ID===e.data.h1ID){a.Content=e.data.h1;break}}catch(r){o.e(r)}finally{o.f()}}}}},{key:"actionCompleteAtComment",value:function(t){}},{key:"actionBeginAtScore",value:function(e){if("beginEdit"===e.requestType&&(this.L1AtDefault=e.rowData.l1,this.L2AtDefault=e.rowData.l2,this.FLAtDefault=e.rowData.fl),"save"===e.requestType){this.tempL1AtChange=parseInt(e.data.l1),this.tempL2AtChange=parseInt(e.data.l2),this.tempFLAtChange=parseInt(e.data.fl);var i=this.L2AtDefault!==this.tempL2AtChange,n=this.FLAtDefault!==this.tempFLAtChange;if(this.L1AtDefault!==this.tempL1AtChange&&e.data.l1ID>0){var c={ID:e.data.l1ID,Point:e.data.l1},o=this.dataAtScorePicked.filter(function(t){return t.ID===e.data.l1ID});if(0===o.length)this.dataAtScorePicked.push(c);else{var a,l=t(o);try{for(l.s();!(a=l.n()).done;)for(var r=a.value,b=0;b<o.length;b++)if(r.ID===e.data.l1ID){r.Point=e.data.l1;break}}catch(C){l.e(C)}finally{l.f()}}}if(i&&e.data.l2ID>0){var u={ID:e.data.l2ID,Point:e.data.l2},d=this.dataAtScorePicked.filter(function(t){return t.ID===e.data.l2ID});if(0===d.length)this.dataAtScorePicked.push(u);else{var s,p=t(d);try{for(p.s();!(s=p.n()).done;){var f=s.value;for(b=0;b<d.length;b++)if(f.ID===e.data.l2ID){f.Point=e.data.l2;break}}}catch(C){p.e(C)}finally{p.f()}}}if(n&&e.data.flid>0){var g={ID:e.data.flid,Point:e.data.fl},h=this.dataAtScorePicked.filter(function(t){return t.ID===e.data.flid});if(0===h.length)this.dataAtScorePicked.push(g);else{var m,v=t(h);try{for(v.s();!(m=v.n()).done;){var U=m.value;for(b=0;b<h.length;b++)if(U.ID===e.data.flid){U.Point=e.data.fl;break}}}catch(C){v.e(C)}finally{v.f()}}}}}},{key:"actionCompleteAtScore",value:function(t){}},{key:"actionBeginSpeScore",value:function(e){if("beginEdit"===e.requestType&&(this.SpeCommentDefault=e.rowData.comment),"save"===e.requestType&&(this.tempSpeChange=e.data.comment,(this.SpeCommentDefault.length<this.tempSpeChange.length||this.SpeCommentDefault.length>this.tempSpeChange.length)&&e.data.id>0)){var i={ID:e.data.id,Content:e.data.comment},n=this.dataSpeScorePicked.filter(function(t){return t.ID===e.data.id});if(0===n.length)this.dataSpeScorePicked.push(i);else{var c,o=t(n);try{for(o.s();!(c=o.n()).done;)for(var a=c.value,l=0;l<n.length;l++)if(a.ID===e.data.id){a.Content=e.data.comment;break}}catch(r){o.e(r)}finally{o.f()}}}}},{key:"actionCompleteSpeScore",value:function(t){}},{key:"loadData",value:function(){var t=this;this.service.getGHRData().subscribe(function(e){console.log(e),t.data=e})}},{key:"openModal",value:function(t,e,i){var n=this;this.userid=t.id,"H1"===i?this.getGHRReportH1Info(t.id):this.getGHRReportH2Info(t.id),this.modalRef=this.modalService.open(e,{size:"xl",backdrop:"static"}),this.modalRef.result.then(function(t){n.dataCommentPicked=[],n.dataAtScorePicked=[],n.dataSpeScorePicked=[]},function(t){n.dataCommentPicked=[],n.dataAtScorePicked=[],n.dataSpeScorePicked=[]})}},{key:"getHalfYearSetting",value:function(){this.columns=[];var e,i=t(this.halfYearSettingsData);try{for(i.s();!(e=i.n()).done;){var n=e.value;this.columns.push({field:"".concat(n),headerText:this.getMonthListInCurrentQuarter(n),month:n})}}catch(c){i.e(c)}finally{i.f()}}},{key:"getResultOfMonthData",value:function(){var e,i=this;this.Resultcolumns=[];var n,c=t(this.halfYearSettingsData);try{var o=function(){var t=n.value;i.Resultcolumns.push({field:"".concat(t),headerText:(null===(e=i.ResultOfMonthData.filter(function(e){return e.month===t})[0])||void 0===e?void 0:e.title)||"N/A",month:t})};for(c.s();!(n=c.n()).done;)o()}catch(a){c.e(a)}finally{c.f()}}},{key:"getMonthListInCurrentQuarter",value:function(t){return["Jan.","Feb.","Mar.","Apr.","May.","Jun.","Jul.","Aug.","Sep.","Oct.","Nov.","Dec."][t-1]}},{key:"save",value:function(){this.updateAtScore(),this.updateComment(),this.updateSpe(),this.alertify.success(x.a.CREATED_OK_MSG),this.clearData(),this.modalRef.close()}},{key:"clearData",value:function(){this.dataCommentPicked=[],this.dataAtScorePicked=[],this.dataSpeScorePicked=[]}},{key:"updateComment",value:function(){this.service.ReportUpdateComment(this.dataCommentPicked).subscribe(function(t){})}},{key:"updateAtScore",value:function(){this.service.ReportUpdateAtScore(this.dataAtScorePicked).subscribe(function(t){})}},{key:"updateSpe",value:function(){this.service.ReportUpdateSpe(this.dataSpeScorePicked).subscribe(function(t){})}},{key:"getGHRReportH1Info",value:function(t){var e=this;this.service.getGHRReportH1Info(t).subscribe(function(t){e.detailH1=t.h1,e.title="H1\uff1aQ1-Q2",e.titles="H1",e.detailH2=t.h2,e.kpicommentH1=t.kpicommentH1,e.attitudecommentData=t.attitudecomment,e.atScoreData=t.attitudeScore,e.kpiScoreData=t.kpiScore,e.specialScoreData=t.specialScore,e.halfYearSettingsData=t.dataObjectH1[0].settings||[],e.ResultOfMonthData=t.dataObjectH1[0].resultOfMonth||[],e.gridDataH1=t.dataObjectH1,e.avg=t.avg,e.h1Score=t.h1Score,e.dept=t.dept,e.name=t.name,e.getHalfYearSetting(),e.getResultOfMonthData()})}},{key:"getGHRReportH2Info",value:function(t){var e=this;this.service.getGHRReportH2Info(t).subscribe(function(t){e.detailH1=t.h1,e.title="H2\uff1aQ3-Q4",e.titles="H2",e.detailH2=t.h2,e.kpicommentH1=t.kpicommentH1,e.attitudecommentData=t.attitudecomment,e.atScoreData=t.attitudeScore,e.kpiScoreData=t.kpiScore,e.specialScoreData=t.specialScore,e.halfYearSettingsData=t.dataObjectH1[0].settings||[],e.ResultOfMonthData=t.dataObjectH1[0].resultOfMonth||[],e.gridDataH1=t.dataObjectH1,e.avg=t.avg,e.h1Score=t.h1Score,e.dept=t.dept,e.name=t.name,e.getHalfYearSetting(),e.getResultOfMonthData()})}},{key:"exportExcel",value:function(){this.service.H1H2ExportExcel(this.userid).subscribe(function(t){new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});var e=window.URL.createObjectURL(t),i=document.createElement("a");i.href=e,i.download="H1,H2 Report \u5b63\u5831\u8868.xlsx",i.click()})}},{key:"NO",value:function(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}]),o}(H.a)).\u0275fac=function(t){return new(t||Nt)(I.Pb(k.b),I.Pb(w.a),I.Pb(D.c),I.Pb(y),I.Pb(Q.a))},Nt.\u0275cmp=I.Jb({type:Nt,selectors:[["app-ghr-report"]],viewQuery:function(t,e){var i;1&t&&(I.Mc(P,1),I.Mc(E,1)),2&t&&(I.wc(i=I.gc())&&(e.grid=i.first),I.wc(i=I.gc())&&(e.detailModal=i.first))},hostBindings:function(t,e){1&t&&I.fc("scroll",function(t){return e.onScroll(t)})},features:[I.zb],decls:25,vars:9,consts:[[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body","table-responsive","p-0"],["id","grid","gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","locale","toolbar","pageSettings","allowExcelExport","editSettings"],["grid",""],["field","ID","textAlign","Center","width","80","isPrimaryKey","true","headerText","#"],["template",""],["editTemplate",""],["field","oc","textAlign","Center","headerText","Dept."],["field","fullName","textAlign","Center","headerText","Name"],["field","score","textAlign","Center","headerText","Score"],["field","#","textAlign","Center","headerText","Option"],["detailH1Modal",""],["detailH2Modal",""],[1,"btn","btn-sm","btn-success",3,"click"],["top",""],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body",2,"font-size","15px"],[1,"col"],[1,"d-flex","justify-content-start"],["height","300px","allowTextWrap","true","gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","toolbar","pageSettings","allowExcelExport","queryCellInfo"],["field","#","headerText","#","textAlign","Center","width","30","type","number"],["field","objective","headerText","KPI Objective","type","string"],["field","l0TargetList","headerText","L0 Target","type","string"],["field","l0ActionList","headerText","L0 Action","type","string"],["field","l0ActionList","headerText","H1","textAlign","Center","width","100"],["field","l0ActionList","headerText","Result Of Month.","type","string"],["id","grid","allowTextWrap","true","gridLines","Both",3,"dataSource","allowResizing","showColumnMenu","editSettings","actionComplete","actionBegin","recordDoubleClick"],["gridKpicomment",""],["field","kpiComment","isPrimaryKey","true","headerText","KPI Comments","type","string"],["field","q1","headerText","Q1","type","string"],["field","q2","headerText","Q2","type","string"],["allowTextWrap","true","gridLines","Both",3,"allowResizing","editSettings","dataSource","showColumnMenu","actionComplete","actionBegin"],["field","attitudeComment","isPrimaryKey","true","headerText","Attitude Comments","type","string"],["field","h1","headerText","H1","type","string"],["allowTextWrap","true","gridLines","Both",3,"dataSource","editSettings","allowResizing","showColumnMenu","actionComplete","actionBegin"],["field","l1","textAlign","Center","headerText","L1","type","string"],["field","l2","textAlign","Center","headerText","L2","type","string"],["field","fl","textAlign","Center","headerText","Functional leader","type","string"],["allowTextWrap","true","gridLines","Both",3,"dataSource","allowResizing","showColumnMenu"],["field","self","textAlign","Center","headerText","Self","type","string"],["field","ghrSmartScore","headerText","GHR SMART Score","textAlign","Center","width","100"],["allowTextWrap","true","gridLines","Both",3,"allowResizing","dataSource","editSettings","showColumnMenu","actionComplete","actionBegin"],["field","score","headerText","Special score","type","string"],["field","comment","headerText","Special Contribution or Mistake (If any) \u91cd\u5927\u8ca2\u737b\u6216\u932f\u8aa4(\u5982\u6709)","type","string"],[1,"d-flex","justify-content-end"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],[2,"color","transparent"],[1,"btn","btn-outline-warning",3,"click"],[1,"fas","fa-chevron-up"],[2,"padding","0 0 0 8px"],[4,"ngFor","ngForOf"],["class","e-row",4,"ngFor","ngForOf"],[1,"e-row"],[1,"e-rowcell",2,"text-align","center"],[3,"ngClass"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["disabled","disabled","type","text","name","q1",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["type","text","name","q1",1,"e-field","e-input","e-defaultcell",3,"value"],["disabled","disabled","type","text","name","q2",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["type","text","name","q2",1,"e-field","e-input","e-defaultcell",3,"value"],["disabled","disabled","type","text","name","h1",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["type","text","name","h1",1,"e-field","e-input","e-defaultcell",3,"value"],["disabled","disabled","type","text","name","l1",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["type","text","name","l1",1,"e-field","e-input","e-defaultcell",3,"value"],["disabled","disabled","type","text","name","l2",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["type","text","name","l2",1,"e-field","e-input","e-defaultcell",3,"value"],["disabled","disabled","type","text","name","fl",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["type","text","name","fl",1,"e-field","e-input","e-defaultcell",3,"value"],["disabled","disabled","type","text","name","comment",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["type","text","name","comment",1,"e-field","e-input","e-defaultcell",3,"value"],["field","l0ActionList","headerText","H2","textAlign","Center","width","100"],["field","q1","headerText","Q3","type","string"],["field","q2","headerText","Q4","type","string"],["field","h1","headerText","H2","type","string"]],template:function(t,e){1&t&&(I.Vb(0,"div",0),I.Vb(1,"div",1),I.Vb(2,"div",2),I.Vb(3,"div",3),I.Vb(4,"h3",4),I.Ic(5,"GHR Report "),I.Ub(),I.Ub(),I.Vb(6,"div",5),I.Vb(7,"ejs-grid",6,7),I.Vb(9,"e-columns"),I.Vb(10,"e-column",8),I.Gc(11,_,1,1,"ng-template",null,9,I.Hc),I.Gc(13,T,1,0,"ng-template",null,10,I.Hc),I.Ub(),I.Qb(15,"e-column",11),I.Qb(16,"e-column",12),I.Qb(17,"e-column",13),I.Vb(18,"e-column",14),I.Gc(19,G,5,0,"ng-template",null,9,I.Hc),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Gc(21,gt,121,34,"ng-template",null,15,I.Hc),I.Gc(23,Bt,121,34,"ng-template",null,16,I.Hc)),2&t&&(I.Cb(7),I.oc("dataSource",e.data)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("locale",e.locale)("toolbar",e.toolbarOptions)("pageSettings",e.pageSettings)("allowExcelExport",!0)("editSettings",e.editSettings))},directives:[g.g,g.d,g.b,A.d,A.b,R.d,g.c,g.a,A.c,A.a,R.c,r.l,r.k,r.m],styles:[".small-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{width:16%;text-align:center}.tooltip-kpi-table[_ngcontent-%COMP%]{display:none;transition:all .5s ease;position:absolute;left:0}.hover-box[_ngcontent-%COMP%]{position:relative}.hover-box[_ngcontent-%COMP%]:hover   .tooltip-kpi-table[_ngcontent-%COMP%]{display:block;background:#84c1ff;position:absolute;z-index:999}.tooltip-attitude-table[_ngcontent-%COMP%]{display:none;background:#84c1ff;position:absolute;left:0;z-index:999}.hover-box[_ngcontent-%COMP%]:hover   .tooltip-attitude-table[_ngcontent-%COMP%]{display:block;background:#84c1ff;position:absolute;z-index:999}"]}),Nt),Wt=["grid"];function Yt(t,e){if(1&t&&I.Ic(0),2&t){var i=e.$implicit,n=I.ic();I.Kc(" ",n.NO(i.index)," ")}}function Xt(t,e){1&t&&I.Ic(0," # ")}function Zt(t,e){1&t&&(I.Vb(0,"button",13),I.Ic(1,"Export"),I.Ub())}var te,ee=((te=function(t){i(n,t);var e=c(n);function n(t,i,c,o){var a;return l(this,n),(a=e.call(this)).modalService=t,a.alertify=i,a.service=c,a.route=o,a.data=[],a.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},a.locale=localStorage.getItem("lang"),a.editSettings={showDeleteConfirmDialog:!1,allowEditing:!1,allowAdding:!1,allowDeleting:!1,mode:"Normal"},a.toolbarOptions=["Search"],a}return b(n,[{key:"ngOnInit",value:function(){this.loadData()}},{key:"onDoubleClick",value:function(t){}},{key:"actionBegin",value:function(t){}},{key:"toolbarClick",value:function(t){switch(t.item.id){case"grid_excelexport":this.grid.excelExport({hierarchyExportMode:"All"})}}},{key:"actionComplete",value:function(t){}},{key:"loadData",value:function(){var t=this;this.service.geH1H2Data().subscribe(function(e){t.data=e})}},{key:"NO",value:function(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}]),n}(H.a)).\u0275fac=function(t){return new(t||te)(I.Pb(k.b),I.Pb(w.a),I.Pb(y),I.Pb(Q.a))},te.\u0275cmp=I.Jb({type:te,selectors:[["app-hq-hr-report"]],viewQuery:function(t,e){var i;1&t&&I.Mc(Wt,1),2&t&&I.wc(i=I.gc())&&(e.grid=i.first)},features:[I.zb],decls:19,vars:9,consts:[[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body","table-responsive","p-0"],["id","grid","gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","locale","toolbar","pageSettings","allowExcelExport","editSettings"],["grid",""],["field","ID","textAlign","Center","width","80","isPrimaryKey","true","headerText","ID"],["template",""],["editTemplate",""],["field","fullName","textAlign","Center","headerText","Name"],["field","#","textAlign","Center","headerText","Option"],[1,"btn","btn-sm","btn-success"]],template:function(t,e){1&t&&(I.Vb(0,"div",0),I.Vb(1,"div",1),I.Vb(2,"div",2),I.Vb(3,"div",3),I.Vb(4,"h3",4),I.Ic(5," HQ HR Report \u5e74\u4e2d\u8003\u6838\u540d\u55ae "),I.Ub(),I.Ub(),I.Vb(6,"div",5),I.Vb(7,"ejs-grid",6,7),I.Vb(9,"e-columns"),I.Vb(10,"e-column",8),I.Gc(11,Yt,1,1,"ng-template",null,9,I.Hc),I.Gc(13,Xt,1,0,"ng-template",null,10,I.Hc),I.Ub(),I.Qb(15,"e-column",11),I.Vb(16,"e-column",12),I.Gc(17,Zt,2,0,"ng-template",null,9,I.Hc),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub()),2&t&&(I.Cb(7),I.oc("dataSource",e.data)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("locale",e.locale)("toolbar",e.toolbarOptions)("pageSettings",e.pageSettings)("allowExcelExport",!0)("editSettings",e.editSettings))},directives:[g.g,g.d,g.b,A.d,A.b,R.d,g.c,g.a,A.c,A.a,R.c],styles:[""]}),te),ie=["grid"],ne=["detailModal"];function ce(t,e){if(1&t&&I.Ic(0),2&t){var i=e.$implicit,n=I.ic();I.Kc(" ",n.NO(i.index)," ")}}function oe(t,e){1&t&&I.Ic(0," # ")}function ae(t,e){if(1&t){var i=I.Wb();I.Vb(0,"button",14),I.fc("click",function(){I.Ac(i);var t=e.$implicit,n=I.ic(),c=I.xc(20);return n.openModal(t,c)}),I.Ic(1,"Detail"),I.Ub()}}function le(t,e){if(1&t){var i=I.Wb();I.Vb(0,"div",15),I.Vb(1,"h4",16),I.Qb(2,"i",17),I.Ic(3," H1 & H2 Report "),I.Ub(),I.Vb(4,"button",18),I.fc("click",function(){return e.$implicit.dismiss("Cross click")}),I.Vb(5,"span",19),I.Ic(6,"\xd7"),I.Ub(),I.Ub(),I.Ub(),I.Vb(7,"div",20),I.Vb(8,"div",21),I.Vb(9,"div",22),I.Vb(10,"div",0),I.Vb(11,"div",23),I.Ic(12,"\u7fd4\u946b\u5821\u5de5\u696d\u80a1\u4efd\u6709\u9650\u516c\u53f8\u7b2c\u4e8c\u4e8b\u696d\u90e8"),I.Ub(),I.Vb(13,"div",24),I.Ic(14,"\u5de5\u4f5c\u8003\u6838\u8868"),I.Ub(),I.Ub(),I.Ub(),I.Vb(15,"div",22),I.Vb(16,"div",0),I.Vb(17,"div",25),I.Ic(18),I.Ub(),I.Vb(19,"div",25),I.Ic(20),I.Ub(),I.Vb(21,"div",25),I.Ic(22,"Position:"),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Vb(23,"div",21),I.Vb(24,"div",22),I.Vb(25,"div",26),I.Vb(26,"span"),I.Ic(27,"H1\uff1aQ1-Q2"),I.Ub(),I.Ub(),I.Vb(28,"table",27),I.Vb(29,"tbody"),I.Vb(30,"tr"),I.Qb(31,"th",28),I.Qb(32,"th",28),I.Vb(33,"td"),I.Ic(34,"L1"),I.Ub(),I.Vb(35,"td"),I.Ic(36,"L2"),I.Ub(),I.Vb(37,"td"),I.Ic(38,"FL"),I.Ub(),I.Ub(),I.Vb(39,"tr"),I.Vb(40,"th",29),I.Ic(41," Attitude: 20 "),I.Vb(42,"table",30),I.Vb(43,"thead"),I.Vb(44,"tr"),I.Vb(45,"th",31),I.Ic(46,"\u5de5\u4f5c\u614b\u5ea6 = \u4e3b\u52d5\u7a4d\u6975 + \u6e9d\u901a\u53caEQ + \u914d\u5408\u5ea6"),I.Ub(),I.Vb(47,"th",31),I.Ic(48,"\u975e\u5e38\u597d 10 \u5206"),I.Ub(),I.Vb(49,"th",31),I.Ic(50,"\u8f03\u597d 8-9 \u5206"),I.Ub(),I.Vb(51,"th",31),I.Ic(52,"\u4e00\u822c 6-7 \u5206"),I.Ub(),I.Vb(53,"th",31),I.Ic(54,"\u8f03\u5dee 4-5 \u5206"),I.Ub(),I.Vb(55,"th",31),I.Ic(56,"\u6975\u5dee 3 \u5206\u4ee5\u4e0b"),I.Ub(),I.Ub(),I.Ub(),I.Vb(57,"tbody"),I.Vb(58,"tr"),I.Vb(59,"td"),I.Ic(60,"Attitude = Proactiveness + Communication & EQ + Cooperation"),I.Ub(),I.Vb(61,"td"),I.Ic(62,"Excellent 10 points"),I.Ub(),I.Vb(63,"td"),I.Ic(64,"Good 8-9 points"),I.Ub(),I.Vb(65,"td"),I.Ic(66,"Normal 6-7 points"),I.Ub(),I.Vb(67,"td"),I.Ic(68,"Not goo 4-5 points"),I.Ub(),I.Vb(69,"td"),I.Ic(70,"Poor 3 points or below"),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Vb(71,"th",28),I.Ic(72),I.Ub(),I.Vb(73,"td"),I.Ic(74),I.Ub(),I.Vb(75,"td"),I.Ic(76),I.Ub(),I.Vb(77,"td"),I.Ic(78),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Vb(79,"div",22),I.Vb(80,"div",26),I.Vb(81,"span"),I.Ic(82,"H2\uff1aQ3-Q4"),I.Ub(),I.Ub(),I.Vb(83,"table",27),I.Vb(84,"tbody"),I.Vb(85,"tr"),I.Qb(86,"th",28),I.Qb(87,"th",28),I.Vb(88,"td"),I.Ic(89,"L1 "),I.Ub(),I.Vb(90,"td"),I.Ic(91,"L2 "),I.Ub(),I.Vb(92,"td"),I.Ic(93,"FL "),I.Ub(),I.Ub(),I.Vb(94,"tr"),I.Vb(95,"th",28),I.Ic(96,"Attitude: 20"),I.Ub(),I.Vb(97,"th",28),I.Ic(98),I.Ub(),I.Vb(99,"td"),I.Ic(100),I.Ub(),I.Vb(101,"td"),I.Ic(102),I.Ub(),I.Vb(103,"td"),I.Ic(104),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Vb(105,"div",21),I.Vb(106,"div",1),I.Vb(107,"table",32),I.Vb(108,"thead"),I.Vb(109,"tr"),I.Vb(110,"th",33),I.Ic(111,"L0 Self-Evaluation"),I.Ub(),I.Vb(112,"th",34),I.Ic(113),I.Ub(),I.Vb(114,"th",33),I.Ic(115,"L0 Self-Evaluation"),I.Ub(),I.Vb(116,"th",34),I.Ic(117),I.Ub(),I.Ub(),I.Ub(),I.Vb(118,"tbody"),I.Vb(119,"tr"),I.Vb(120,"td",35),I.Ic(121,"L1 Comment"),I.Ub(),I.Vb(122,"td"),I.Ic(123),I.Ub(),I.Vb(124,"td",35),I.Ic(125,"L1 Comment"),I.Ub(),I.Vb(126,"td"),I.Ic(127),I.Ub(),I.Ub(),I.Vb(128,"tr"),I.Vb(129,"td"),I.Ic(130),I.Ub(),I.Vb(131,"td"),I.Ic(132),I.Ub(),I.Ub(),I.Vb(133,"tr"),I.Vb(134,"td"),I.Ic(135),I.Ub(),I.Vb(136,"td"),I.Ic(137),I.Ub(),I.Ub(),I.Vb(138,"tr"),I.Vb(139,"td",35),I.Ic(140,"L2 Comment"),I.Ub(),I.Vb(141,"td"),I.Ic(142),I.Ub(),I.Vb(143,"td",35),I.Ic(144,"L2 Comment"),I.Ub(),I.Vb(145,"td"),I.Ic(146),I.Ub(),I.Ub(),I.Vb(147,"tr"),I.Vb(148,"td"),I.Ic(149),I.Ub(),I.Vb(150,"td"),I.Ic(151),I.Ub(),I.Ub(),I.Vb(152,"tr"),I.Vb(153,"td"),I.Ic(154),I.Ub(),I.Vb(155,"td"),I.Ic(156),I.Ub(),I.Ub(),I.Vb(157,"tr"),I.Vb(158,"td"),I.Ic(159,"FL Comment"),I.Ub(),I.Vb(160,"td"),I.Ic(161),I.Ub(),I.Vb(162,"td"),I.Ic(163),I.Ub(),I.Vb(164,"td"),I.Ic(165),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Vb(166,"div",21),I.Vb(167,"div",22),I.Vb(168,"table",27),I.Vb(169,"tbody"),I.Vb(170,"tr"),I.Qb(171,"th",36),I.Qb(172,"th",36),I.Vb(173,"td"),I.Ic(174,"Self-Score (10)"),I.Ub(),I.Vb(175,"td"),I.Ic(176,"L1 (30)"),I.Ub(),I.Vb(177,"td"),I.Ic(178,"L2 (20)"),I.Ub(),I.Vb(179,"td"),I.Ic(180,"SMART (20)"),I.Ub(),I.Ub(),I.Vb(181,"tr"),I.Vb(182,"th",37),I.Ic(183,"KPI: 80 "),I.Vb(184,"table",38),I.Vb(185,"thead"),I.Vb(186,"tr"),I.Vb(187,"th",31),I.Ic(188,"5>= X >=4.5 \u8d85\u51fa\u9810\u671f"),I.Ub(),I.Vb(189,"th",31),I.Ic(190,"4.5> X >=4 \u7b26\u5408\u9810\u671f"),I.Ub(),I.Vb(191,"th",31),I.Ic(192,"4 > X >=3 \u5927\u90e8\u5206\u7b26\u5408\u9810\u671f"),I.Ub(),I.Vb(193,"th",31),I.Ic(194,"3> X >=2 \u90e8\u5206\u7b26\u5408\u9810\u671f"),I.Ub(),I.Vb(195,"th",31),I.Ic(196,"2> X >= 0 \u4e0d\u4f73\u4e0d\u7b26\u5408\u9810\u671f"),I.Ub(),I.Ub(),I.Ub(),I.Vb(197,"tbody"),I.Vb(198,"tr"),I.Vb(199,"td"),I.Ic(200,"Exceed expectation"),I.Ub(),I.Vb(201,"td"),I.Ic(202,"Meet expectation"),I.Ub(),I.Vb(203,"td"),I.Ic(204,"Mostly meet expectation"),I.Ub(),I.Vb(205,"td"),I.Ic(206,"Partly meet expectation"),I.Ub(),I.Vb(207,"td"),I.Ic(208,"Poorly or not meet expectation"),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Vb(209,"th",36),I.Ic(210),I.Ub(),I.Vb(211,"td"),I.Ic(212),I.Ub(),I.Vb(213,"td"),I.Ic(214),I.Ub(),I.Vb(215,"td"),I.Ic(216),I.Ub(),I.Vb(217,"td"),I.Ic(218),I.Ub(),I.Ub(),I.Vb(219,"tr"),I.Qb(220,"th",36),I.Qb(221,"th",36),I.Vb(222,"td"),I.Ic(223),I.Ub(),I.Vb(224,"td"),I.Ic(225),I.Ub(),I.Vb(226,"td"),I.Ic(227),I.Ub(),I.Vb(228,"td"),I.Ic(229),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Vb(230,"div",22),I.Vb(231,"table",27),I.Vb(232,"tbody"),I.Vb(233,"tr"),I.Qb(234,"th",36),I.Vb(235,"td"),I.Ic(236,"Self-Score (10)"),I.Ub(),I.Vb(237,"td"),I.Ic(238,"L1 (30)"),I.Ub(),I.Vb(239,"td"),I.Ic(240,"L2 (20)"),I.Ub(),I.Vb(241,"td"),I.Ic(242,"SMART (20)"),I.Ub(),I.Ub(),I.Vb(243,"tr"),I.Vb(244,"th",36),I.Ic(245),I.Ub(),I.Vb(246,"td"),I.Ic(247),I.Ub(),I.Vb(248,"td"),I.Ic(249),I.Ub(),I.Vb(250,"td"),I.Ic(251),I.Ub(),I.Vb(252,"td"),I.Ic(253),I.Ub(),I.Ub(),I.Vb(254,"tr"),I.Qb(255,"th",36),I.Vb(256,"td"),I.Ic(257),I.Ub(),I.Vb(258,"td"),I.Ic(259),I.Ub(),I.Vb(260,"td"),I.Ic(261),I.Ub(),I.Vb(262,"td"),I.Ic(263),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Vb(264,"div",21),I.Vb(265,"div",1),I.Vb(266,"table",32),I.Vb(267,"thead"),I.Vb(268,"tr"),I.Vb(269,"th",33),I.Ic(270,"Special contribution or mistake"),I.Ub(),I.Vb(271,"th",34),I.Vb(272,"tr"),I.Vb(273,"td"),I.Ic(274),I.Ub(),I.Vb(275,"td"),I.Ic(276),I.Ub(),I.Ub(),I.Ub(),I.Vb(277,"th",33),I.Ic(278,"Special contribution or mistake"),I.Ub(),I.Vb(279,"th",34),I.Vb(280,"tr"),I.Vb(281,"td"),I.Ic(282),I.Ub(),I.Vb(283,"td"),I.Ic(284),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Vb(285,"tr"),I.Vb(286,"th",33),I.Ic(287,"Special contribution or mistake comment"),I.Ub(),I.Vb(288,"span",39),I.Ic(289),I.Ub(),I.Vb(290,"th",33),I.Ic(291,"Special contribution or mistake comment"),I.Ub(),I.Vb(292,"span",39),I.Ic(293),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Vb(294,"div",21),I.Vb(295,"div",40),I.Vb(296,"p"),I.Ic(297),I.Ub(),I.Vb(298,"p"),I.Ic(299),I.Ub(),I.Ub(),I.Vb(300,"div",40),I.Vb(301,"span"),I.Ic(302),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Vb(303,"div",41),I.Vb(304,"button",42),I.fc("click",function(){return I.Ac(i),I.ic().exportExcel()}),I.Ic(305,"Export Excel"),I.Ub(),I.Vb(306,"button",43),I.fc("click",function(){return e.$implicit.close("Close click")}),I.Ic(307,"Close"),I.Ub(),I.Ub()}if(2&t){var n=I.ic();I.Cb(18),I.Kc("Dept. ",void 0!==n.detailH1?n.detailH1.oc:"",""),I.Cb(2),I.Kc("Name: ",void 0!==n.detailH1?n.detailH1.fullName:"",""),I.Cb(52),I.Kc("H1\u5f97\u5206: ",void 0!==n.detailH1?n.detailH1.a_total:"N/A",""),I.Cb(2),I.Jc(void 0!==n.detailH1?n.detailH1.l1Score:"N/A"),I.Cb(2),I.Jc(void 0!==n.detailH1?n.detailH1.l2Score:"N/A"),I.Cb(2),I.Jc(void 0!==n.detailH1?n.detailH1.flScore:"N/A"),I.Cb(20),I.Kc("H2\u5f97\u5206: ",void 0!==n.detailH2?n.detailH2.a_total:"N/A",""),I.Cb(2),I.Jc(void 0!==n.detailH2?n.detailH2.l1Score:"N/A"),I.Cb(2),I.Jc(void 0!==n.detailH2?n.detailH2.l2Score:"N/A"),I.Cb(2),I.Jc(void 0!==n.detailH2?n.detailH2.flScore:"N/A"),I.Cb(9),I.Kc("H1: ",void 0!==n.detailH1?n.detailH1.l0SelfScoreComment:"",""),I.Cb(4),I.Kc("H2: ",void 0!==n.detailH2?n.detailH2.l0SelfScoreComment:"",""),I.Cb(6),I.Kc("Q1 KPI: ",void 0!==n.detailH1?n.detailH1.l1Q1Comment:"",""),I.Cb(4),I.Kc("Q3 KPI: ",void 0!==n.detailH2?n.detailH2.l1Q1Comment:"",""),I.Cb(3),I.Kc("Q2 KPI: ",void 0!==n.detailH1?n.detailH1.l1Q2Comment:"",""),I.Cb(2),I.Kc("Q4 KPI: ",void 0!==n.detailH2?n.detailH2.l1Q2Comment:"",""),I.Cb(3),I.Kc("H1 Attitude: ",void 0!==n.detailH1?n.detailH1.l1HComment:"",""),I.Cb(2),I.Kc("H2 Attitude: ",void 0!==n.detailH2?n.detailH2.l1HComment:"",""),I.Cb(5),I.Kc("Q1 KPI: ",void 0!==n.detailH1?n.detailH1.l2Q1Comment:"",""),I.Cb(4),I.Kc("Q3 KPI: ",void 0!==n.detailH2?n.detailH2.l2Q1Comment:"",""),I.Cb(3),I.Kc("Q2 KPI: ",void 0!==n.detailH1?n.detailH1.l2Q2Comment:"",""),I.Cb(2),I.Kc("Q4 KPI: ",void 0!==n.detailH2?n.detailH2.l2Q2Comment:"",""),I.Cb(3),I.Kc("H1 Attitude: ",void 0!==n.detailH1?n.detailH1.l2HComment:"",""),I.Cb(2),I.Kc("H2 Attitude: ",void 0!==n.detailH2?n.detailH2.l2HComment:"",""),I.Cb(5),I.Kc("H1 Attitude: ",void 0!==n.detailH1?n.detailH1.flhComment:"",""),I.Cb(2),I.Kc("FL Comment: ","",""),I.Cb(2),I.Kc("H2 Attitude: ",void 0!==n.detailH2?n.detailH2.flhComment:"",""),I.Cb(45),I.Kc("H1\u5f97\u5206: ",void 0!==n.detailH1?n.detailH1.b_total:0,""),I.Cb(2),I.Jc(void 0!==n.detailH1?n.detailH1.selfScore:0),I.Cb(2),I.Jc(void 0!==n.detailH1?n.detailH1.l1:0),I.Cb(2),I.Jc(void 0!==n.detailH1?n.detailH1.l2:0),I.Cb(2),I.Jc(void 0!==n.detailH1?n.detailH1.smart:0),I.Cb(5),I.Jc(void 0!==n.detailH1?n.detailH1.b_selfScore:0),I.Cb(2),I.Jc(void 0!==n.detailH1?n.detailH1.b_L1:0),I.Cb(2),I.Jc(void 0!==n.detailH1?n.detailH1.b_L2:0),I.Cb(2),I.Jc(void 0!==n.detailH1?n.detailH1.b_Smart:0),I.Cb(16),I.Kc("H2\u5f97\u5206: ",void 0!==n.detailH2?n.detailH2.b_total:0,""),I.Cb(2),I.Jc(void 0!==n.detailH2?n.detailH2.selfScore:0),I.Cb(2),I.Jc(void 0!==n.detailH2?n.detailH2.l1:0),I.Cb(2),I.Jc(void 0!==n.detailH2?n.detailH2.l2:0),I.Cb(2),I.Jc(void 0!==n.detailH2?n.detailH2.smart:0),I.Cb(4),I.Jc(void 0!==n.detailH2?n.detailH2.b_selfScore:0),I.Cb(2),I.Jc(void 0!==n.detailH2?n.detailH2.b_L1:0),I.Cb(2),I.Jc(void 0!==n.detailH2?n.detailH2.b_L2:0),I.Cb(2),I.Jc(void 0!==n.detailH2?n.detailH2.b_Smart:0),I.Cb(11),I.Kc("H1: ",void 0!==n.detailH1?n.detailH1.c_total:0,""),I.Cb(2),I.Jc(void 0!==n.detailH1?n.detailH1.specialScore:0),I.Cb(6),I.Kc("H2: ",void 0!==n.detailH2?n.detailH2.c_total:0,""),I.Cb(2),I.Jc(void 0!==n.detailH2?n.detailH2.specialScore:0),I.Cb(5),I.Kc(" ",void 0!==n.detailH1?n.detailH1.specialComment:""," "),I.Cb(4),I.Kc(" ",void 0!==n.detailH2?n.detailH2.specialComment:""," "),I.Cb(4),I.Kc("H1\u5f97\u5206: ",void 0!==n.detailH1?n.detailH1.d_total:0,""),I.Cb(2),I.Kc("\u5e74\u5ea6\u5f97\u5206: ",n.avg,""),I.Cb(3),I.Kc("H2\u5f97\u5206: ",void 0!==n.detailH2?n.detailH2.d_total:0,"")}}var re,be=((re=function(t){i(n,t);var e=c(n);function n(t,i,c,o,a){var r;return l(this,n),(r=e.call(this)).modalService=t,r.alertify=i,r.spinner=c,r.service=o,r.route=a,r.data=[],r.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},r.locale=localStorage.getItem("lang"),r.editSettings={showDeleteConfirmDialog:!1,allowEditing:!1,allowAdding:!1,allowDeleting:!1,mode:"Normal"},r.toolbarOptions=["Search"],r.avg=0,r}return b(n,[{key:"ngAfterViewInit",value:function(){}},{key:"ngOnInit",value:function(){this.loadData()}},{key:"loadData",value:function(){var t=this;this.service.getQ1Q3Data().subscribe(function(e){t.data=e})}},{key:"openModal",value:function(t,e){this.userid=t.id,this.getH1H2ReportInfo(t.id),this.modalRef=this.modalService.open(e,{size:"xl",backdrop:"static"})}},{key:"getH1H2ReportInfo",value:function(t){var e=this;this.service.getH1H2ReportInfo(t).subscribe(function(t){e.detailH1=t.h1,e.detailH2=t.h2,e.avg=t.avg})}},{key:"exportExcel",value:function(){this.service.H1H2ExportExcel(this.userid).subscribe(function(t){new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});var e=window.URL.createObjectURL(t),i=document.createElement("a");i.href=e,i.download="H1,H2 Report \u5b63\u5831\u8868.xlsx",i.click()})}},{key:"NO",value:function(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}]),n}(H.a)).\u0275fac=function(t){return new(t||re)(I.Pb(k.b),I.Pb(w.a),I.Pb(D.c),I.Pb(y),I.Pb(Q.a))},re.\u0275cmp=I.Jb({type:re,selectors:[["app-h1-h2-report"]],viewQuery:function(t,e){var i;1&t&&(I.Mc(ie,1),I.Mc(ne,1)),2&t&&(I.wc(i=I.gc())&&(e.grid=i.first),I.wc(i=I.gc())&&(e.detailModal=i.first))},features:[I.zb],decls:21,vars:9,consts:[[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body","table-responsive","p-0"],["id","grid","gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","locale","toolbar","pageSettings","allowExcelExport","editSettings"],["grid",""],["field","ID","textAlign","Center","width","80","isPrimaryKey","true","headerText","ID"],["template",""],["editTemplate",""],["field","fullName","textAlign","Center","headerText","Name"],["field","#","textAlign","Center","headerText","Option"],["detailModal",""],[1,"btn","btn-sm","btn-success",3,"click"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"row","mb-2"],[1,"col-md-6"],[1,"col-md-7"],[1,"col-md-5"],[1,"col"],[1,"d-flex","justify-content-end"],[1,"table","table-bordered","small-table"],["scope","row","colspan","2"],["scope","row","colspan","2",1,"hover-box"],[1,"table","table-bordered","tooltip-attitude-table",2,"width","800px"],["scope","col"],[1,"table","table-bordered"],["scope","col",2,"width","10%"],["scope","col",2,"width","40%"],["rowspan","3"],["scope","row","colspan","3"],["scope","row","colspan","3",1,"hover-box"],[1,"table","table-bordered","tooltip-kpi-table",2,"width","800px"],[2,"vertical-align","top"],[1,"col-md-6","text-center"],[1,"modal-footer"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(t,e){1&t&&(I.Vb(0,"div",0),I.Vb(1,"div",1),I.Vb(2,"div",2),I.Vb(3,"div",3),I.Vb(4,"h3",4),I.Ic(5,"H1 & H2 Report "),I.Ub(),I.Ub(),I.Vb(6,"div",5),I.Vb(7,"ejs-grid",6,7),I.Vb(9,"e-columns"),I.Vb(10,"e-column",8),I.Gc(11,ce,1,1,"ng-template",null,9,I.Hc),I.Gc(13,oe,1,0,"ng-template",null,10,I.Hc),I.Ub(),I.Qb(15,"e-column",11),I.Vb(16,"e-column",12),I.Gc(17,ae,2,0,"ng-template",null,9,I.Hc),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Gc(19,le,308,54,"ng-template",null,13,I.Hc)),2&t&&(I.Cb(7),I.oc("dataSource",e.data)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("locale",e.locale)("toolbar",e.toolbarOptions)("pageSettings",e.pageSettings)("allowExcelExport",!0)("editSettings",e.editSettings))},directives:[g.g,g.d,g.b,A.d,A.b,R.d,g.c,g.a,A.c,A.a,R.c],styles:[".small-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{width:16%;text-align:center}.tooltip-kpi-table[_ngcontent-%COMP%]{display:none;transition:all .5s ease;position:absolute;left:0}.hover-box[_ngcontent-%COMP%]{position:relative}.hover-box[_ngcontent-%COMP%]:hover   .tooltip-kpi-table[_ngcontent-%COMP%]{display:block;background:#84c1ff;position:absolute;z-index:999}.tooltip-attitude-table[_ngcontent-%COMP%]{display:none;background:#84c1ff;position:absolute;left:0;z-index:999}.hover-box[_ngcontent-%COMP%]:hover   .tooltip-attitude-table[_ngcontent-%COMP%]{display:block;background:#84c1ff;position:absolute;z-index:999}"]}),re),ue=["will-change",""],de=[[["","pIcon",""],["","p-icon",""],["","pSvg",""],["","p-svg",""],["","pImage",""],["","p-image",""]],"*"],se=["[pIcon], [p-icon], [pSvg], [p-svg], [pImage], [p-image]","*"],pe=["inputElem"],fe=["stateElem"];function ge(t,e){1&t&&(I.Vb(0,"div",3,4),I.mc(2,1),I.Vb(3,"label"),I.mc(4,2),I.Ub(),I.Ub())}var he,me,ve,Ue=[[["ngx-p-indeterminate"],["p-indeterminate"],["ngx-p-hover"],["p-hover"],["ngx-p-toggle"],["p-toggle"]],[["","pIcon",""],["","p-icon",""],["","pSvg",""],["","p-svg",""],["","pImage",""],["","p-image",""]],"*"],Ce=["ngx-p-indeterminate, p-indeterminate, ngx-p-hover, p-hover, ngx-p-toggle, p-toggle","[pIcon], [p-icon], [pSvg], [p-svg], [pImage], [p-image]","*"],Ve=((ve=function t(e){l(this,t),this.elemRef=e,this.elemRef.nativeElement.classList.add("icon")}).\u0275fac=function(t){return new(t||ve)(I.Pb(I.l))},ve.\u0275dir=I.Kb({type:ve,selectors:[["","pIcon",""],["","p-icon",""]]}),ve),Ie=((me=function t(e){l(this,t),this.elemRef=e,this.elemRef.nativeElement.classList.add("image")}).\u0275fac=function(t){return new(t||me)(I.Pb(I.l))},me.\u0275dir=I.Kb({type:me,selectors:[["","pImage",""],["","p-image",""]]}),me),Se=((he=function(){function t(e){l(this,t),this.elemRef=e}return b(t,[{key:"ngAfterViewInit",value:function(){this.elemRef.nativeElement.classList.add("svg")}}]),t}()).\u0275fac=function(t){return new(t||he)(I.Pb(I.l))},he.\u0275dir=I.Kb({type:he,selectors:[["","pSvg",""],["","p-svg",""]]}),he),ye=function(t){return t.On="on",t.Off="off",t}({});function He(t,e){return t?"p-"+t+(e?"-o":""):null}function we(t){return"boolean"==typeof t?t:/^\s*(true|1|on|enable)\s*$/i.test(t)}var xe,ke,De,Qe,Ae,Re,Pe,Ee,_e=((Ee=function(){function t(e,i){l(this,t),this.el=e,this.renderer=i,this.outline=!1}return b(t,[{key:"ngOnChanges",value:function(t){if(t.color||t.outline){var e=He(t.color?t.color.previousValue:this.color,t.outline?t.outline.previousValue:null),i=He(t.color?t.color.currentValue:this.color,t.outline?t.outline.currentValue:null);this.renderer.removeClass(this.el.nativeElement,e),this.renderer.addClass(this.el.nativeElement,i)}}}]),t}()).\u0275fac=function(t){return new(t||Ee)(I.Pb(I.l),I.Pb(I.E))},Ee.\u0275cmp=I.Jb({type:Ee,selectors:[["ngx-p-hover","will-change",""],["p-hover","will-change",""]],hostAttrs:[1,"state","p-is-hover"],inputs:{outline:"outline",color:"color"},features:[I.Ab],attrs:ue,ngContentSelectors:se,decls:3,vars:0,template:function(t,e){1&t&&(I.nc(de),I.mc(0),I.Vb(1,"label"),I.mc(2,1),I.Ub())},encapsulation:2,changeDetection:0}),Ee),Te=((Pe=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=arguments.length>3?arguments[3]:void 0;l(this,t),this.el=e,this.renderer=i,this._outline=n,this._color=c}return b(t,[{key:"ngAfterViewInit",value:function(){this._color&&this.renderer.addClass(this.el.nativeElement,"p-".concat(this._color).concat(this._outline?"-o":""))}}]),t}()).\u0275fac=function(t){return new(t||Pe)(I.Pb(I.l),I.Pb(I.E),I.dc("outline"),I.dc("color"))},Pe.\u0275cmp=I.Jb({type:Pe,selectors:[["ngx-p-hover",3,"will-change",""],["p-hover",3,"will-change",""]],hostAttrs:[1,"state","p-is-hover"],ngContentSelectors:se,decls:3,vars:0,template:function(t,e){1&t&&(I.nc(de),I.mc(0),I.Vb(1,"label"),I.mc(2,1),I.Ub())},encapsulation:2,changeDetection:0}),Pe),Ge=((Re=function(){function t(e,i){l(this,t),this.el=e,this.renderer=i,this.outline=!1}return b(t,[{key:"ngOnChanges",value:function(t){if(t.color||t.outline){var e=He(t.color?t.color.previousValue:this.color,t.outline?t.outline.previousValue:null),i=He(t.color?t.color.currentValue:this.color,t.outline?t.outline.currentValue:null);this.renderer.removeClass(this.el.nativeElement,e),this.renderer.addClass(this.el.nativeElement,i)}}}]),t}()).\u0275fac=function(t){return new(t||Re)(I.Pb(I.l),I.Pb(I.E))},Re.\u0275cmp=I.Jb({type:Re,selectors:[["ngx-p-indeterminate","will-change",""],["p-indeterminate","will-change",""]],hostAttrs:[1,"state","p-is-indeterminate"],inputs:{outline:"outline",color:"color"},features:[I.Ab],attrs:ue,ngContentSelectors:se,decls:3,vars:0,template:function(t,e){1&t&&(I.nc(de),I.mc(0),I.Vb(1,"label"),I.mc(2,1),I.Ub())},encapsulation:2,changeDetection:0}),Re),Oe=((Ae=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=arguments.length>3?arguments[3]:void 0;l(this,t),this.el=e,this.renderer=i,this._outline=n,this._color=c}return b(t,[{key:"ngAfterViewInit",value:function(){this._color&&this.renderer.addClass(this.el.nativeElement,"p-".concat(this._color).concat(this._outline?"-o":""))}}]),t}()).\u0275fac=function(t){return new(t||Ae)(I.Pb(I.l),I.Pb(I.E),I.dc("outline"),I.dc("color"))},Ae.\u0275cmp=I.Jb({type:Ae,selectors:[["ngx-p-indeterminate",3,"will-change",""],["p-indeterminate",3,"will-change",""]],hostAttrs:[1,"state","p-is-indeterminate"],ngContentSelectors:se,decls:3,vars:0,template:function(t,e){1&t&&(I.nc(de),I.mc(0),I.Vb(1,"label"),I.mc(2,1),I.Ub())},encapsulation:2,changeDetection:0}),Ae),Me=((Qe=function(){function t(e,i){l(this,t),this.el=e,this.renderer=i,this.outline=!1}return b(t,[{key:"isToggleOn",get:function(){return this.type===ye.On}},{key:"isToggleOff",get:function(){return this.type===ye.Off}},{key:"ngOnChanges",value:function(t){if(t.color||t.outline){var e=He(t.color?t.color.previousValue:this.color,t.outline?t.outline.previousValue:null),i=He(t.color?t.color.currentValue:this.color,t.outline?t.outline.currentValue:null);this.renderer.removeClass(this.el.nativeElement,e),this.renderer.addClass(this.el.nativeElement,i)}}}]),t}()).\u0275fac=function(t){return new(t||Qe)(I.Pb(I.l),I.Pb(I.E))},Qe.\u0275cmp=I.Jb({type:Qe,selectors:[["ngx-p-toggle","will-change",""],["p-toggle","will-change",""]],hostAttrs:[1,"state"],hostVars:4,hostBindings:function(t,e){2&t&&I.Hb("p-on",e.isToggleOn)("p-off",e.isToggleOff)},inputs:{outline:"outline",type:"type",color:"color"},features:[I.Ab],attrs:ue,ngContentSelectors:se,decls:3,vars:0,template:function(t,e){1&t&&(I.nc(de),I.mc(0),I.Vb(1,"label"),I.mc(2,1),I.Ub())},encapsulation:2,changeDetection:0}),Qe),Ke=((De=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;l(this,t),this.el=e,this.renderer=i,this._outline=n,this._color=c,this._type=o}return b(t,[{key:"ngAfterViewInit",value:function(){this._color&&this.renderer.addClass(this.el.nativeElement,"p-".concat(this._color).concat(this._outline?"-o":"")),this.renderer.addClass(this.el.nativeElement,"p-".concat(this._type))}}]),t}()).\u0275fac=function(t){return new(t||De)(I.Pb(I.l),I.Pb(I.E),I.dc("outline"),I.dc("color"),I.dc("type"))},De.\u0275cmp=I.Jb({type:De,selectors:[["ngx-p-toggle",3,"will-change",""],["p-toggle",3,"will-change",""]],hostAttrs:[1,"state"],ngContentSelectors:se,decls:3,vars:0,template:function(t,e){1&t&&(I.nc(de),I.mc(0),I.Vb(1,"label"),I.mc(2,1),I.Ub())},encapsulation:2,changeDetection:0}),De),Le=((ke=function(){function t(e,i,n,c,o,a){var r=arguments.length>6&&void 0!==arguments[6]&&arguments[6],b=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=arguments.length>8&&void 0!==arguments[8]&&arguments[8],d=arguments.length>9&&void 0!==arguments[9]&&arguments[9],s=arguments.length>10&&void 0!==arguments[10]&&arguments[10],p=arguments.length>11?arguments[11]:void 0;l(this,t),this.renderer=e,this.el=i,this.cd=n,this._stroke=c,this._shape=o,this._animation=a,this._isSwitch=r,this._bigger=b,this._enableFocus=u,this._plain=d,this._outline=s,this._color=p,this.checked=!1,this.disabled=!1,this.lock=!1,this.change=new I.n,this._isSwitch=we(this._isSwitch),this._bigger=we(this._bigger),this._enableFocus=we(this._enableFocus),this._plain=we(this._plain),this._outline=we(this._outline)}return b(t,[{key:"ngAfterViewInit",value:function(){var t=this.el.nativeElement;this._isSwitch&&this.renderer.addClass(t,"p-switch"),this._bigger&&this.renderer.addClass(t,"p-bigger"),this._enableFocus&&this.renderer.addClass(t,"p-has-focus"),this._plain&&this.renderer.addClass(t,"p-plain"),this._stroke&&this.renderer.addClass(t,"p-".concat(this._stroke)),this._shape&&this.renderer.addClass(t,"p-".concat(this._shape)),this._animation&&this.renderer.addClass(t,"p-".concat(this._animation)),this._iconDir&&this.renderer.addClass(t,"p-icon"),this._svgDir&&this.renderer.addClass(t,"p-svg"),this._imgDir&&this.renderer.addClass(t,"p-image"),(this._hoverDir||this._hoverWillChangeDir)&&this.renderer.addClass(t,"p-has-hover"),(this._indeterminateDir||this._indeterminateWillChangeDir)&&this.renderer.addClass(t,"p-has-indeterminate"),this._isToggle&&this.renderer.addClass(t,"p-toggle"),this._isSwitch||this._iconDir||this._svgDir||this._imgDir||this.renderer.addClass(t,"p-default"),this._color&&!this._isToggle&&this.renderer.addClass(this._stateElem.nativeElement,"p-".concat(this._color).concat(this._outline?"-o":""))}},{key:"_onChange",value:function(t,e,i){t.stopPropagation(),this.checked=e,this.change.emit({value:i,checked:e,event:t})}},{key:"_isToggle",get:function(){return 2===this._toggleComps.length||2===this._toggleWillChangeComps.length}},{key:"setIndeterminate",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._inputElem.nativeElement.indeterminate=t}},{key:"forceCheck",value:function(t){this.checked=t,this.cd.markForCheck()}}]),t}()).\u0275fac=function(t){return new(t||ke)(I.Pb(I.E),I.Pb(I.l),I.Pb(I.h),I.dc("stroke"),I.dc("shape"),I.dc("animation"),I.dc("isSwitch"),I.dc("bigger"),I.dc("enableFocus"),I.dc("plain"),I.dc("outline"),I.dc("color"))},ke.\u0275cmp=I.Jb({type:ke,selectors:[["ngx-pretty-checkbox",3,"will-change",""],["p-checkbox",3,"will-change",""]],contentQueries:function(t,e,i){var n;1&t&&(I.Ib(i,Ve,1),I.Ib(i,Se,1),I.Ib(i,Ie,1),I.Ib(i,Te,1),I.Ib(i,_e,1),I.Ib(i,Oe,1),I.Ib(i,Ge,1),I.Ib(i,Ke,0),I.Ib(i,Me,0)),2&t&&(I.wc(n=I.gc())&&(e._iconDir=n.first),I.wc(n=I.gc())&&(e._svgDir=n.first),I.wc(n=I.gc())&&(e._imgDir=n.first),I.wc(n=I.gc())&&(e._hoverDir=n.first),I.wc(n=I.gc())&&(e._hoverWillChangeDir=n.first),I.wc(n=I.gc())&&(e._indeterminateDir=n.first),I.wc(n=I.gc())&&(e._indeterminateWillChangeDir=n.first),I.wc(n=I.gc())&&(e._toggleComps=n),I.wc(n=I.gc())&&(e._toggleWillChangeComps=n))},viewQuery:function(t,e){var i;1&t&&(I.Mc(pe,3),I.Mc(fe,1)),2&t&&(I.wc(i=I.gc())&&(e._inputElem=i.first),I.wc(i=I.gc())&&(e._stateElem=i.first))},hostAttrs:[1,"pretty"],hostVars:2,hostBindings:function(t,e){2&t&&I.Hb("p-locked",e.lock)},inputs:{checked:"checked",disabled:"disabled",lock:"lock",value:"value"},outputs:{change:"change"},exportAs:["ngxPrettyCheckbox"],ngContentSelectors:Ce,decls:4,vars:4,consts:[["type","checkbox",3,"value","checked","disabled","change"],["inputElem",""],["class","state",4,"ngIf"],[1,"state"],["stateElem",""]],template:function(t,e){if(1&t){var i=I.Wb();I.nc(Ue),I.Vb(0,"input",0,1),I.fc("change",function(t){I.Ac(i);var n=I.xc(1);return e._onChange(t,n.checked,n.value)}),I.Ub(),I.Gc(2,ge,5,0,"div",2),I.mc(3)}2&t&&(I.oc("value",e.value)("checked",e.checked)("disabled",e.disabled),I.Cb(2),I.oc("ngIf",!e._isToggle))},directives:[r.m],encapsulation:2}),ke),qe=((xe=function t(){l(this,t)}).\u0275fac=function(t){return new(t||xe)},xe.\u0275mod=I.Nb({type:xe}),xe.\u0275inj=I.Mb({imports:[[r.c,u.b]]}),xe),$e=["grid"],Je=["detailModal"];function ze(t,e){if(1&t){var i=I.Wb();I.Vb(0,"span",13),I.Vb(1,"button",23),I.fc("click",function(){return I.Ac(i),I.ic().exportExcel()}),I.Ic(2,"Export Excel"),I.Ub(),I.Ub()}}function je(t,e){if(1&t&&(I.Vb(0,"tr"),I.Vb(1,"td"),I.Ic(2),I.Ub(),I.Vb(3,"td"),I.Ic(4),I.Ub(),I.Vb(5,"td",25),I.Ic(6),I.Ub(),I.Vb(7,"td"),I.Ic(8),I.Ub(),I.Vb(9,"td",25),I.Ic(10),I.Ub(),I.Vb(11,"td"),I.Ic(12),I.Ub(),I.Vb(13,"td",25),I.Ic(14),I.Ub(),I.Ub()),2&t){var i=e.$implicit;I.Cb(2),I.Jc(null==i?null:i.oc),I.Cb(2),I.Jc(null==i?null:i.fullName),I.Cb(2),I.Jc(null==i?null:i.l1Score),I.Cb(2),I.Jc(null==i?null:i.l1Comment),I.Cb(2),I.Jc(null==i?null:i.l2Score),I.Cb(2),I.Jc(null==i?null:i.l2Comment),I.Cb(2),I.Jc(null==i?null:i.smartScore)}}function Be(t,e){if(1&t&&(I.Tb(0),I.Gc(1,je,15,7,"tr",24),I.Sb()),2&t){var i=I.ic();I.Cb(1),I.oc("ngForOf",i.detail)}}function Ne(t,e){1&t&&(I.Vb(0,"tr"),I.Ic(1," No records "),I.Ub())}function Fe(t,e){if(1&t){var i=I.Wb();I.Vb(0,"div",26),I.Vb(1,"h4",27),I.Qb(2,"i",28),I.Ic(3," Q1, Q3 report "),I.Ub(),I.Vb(4,"button",29),I.fc("click",function(){return e.$implicit.dismiss("Cross click")}),I.Vb(5,"span",30),I.Ic(6,"\xd7"),I.Ub(),I.Ub(),I.Ub(),I.Vb(7,"div",5),I.Vb(8,"div",0),I.Vb(9,"div",10),I.Vb(10,"span",11),I.Ic(11," \u4eba\u4e8b\u5b63\u5831\u8868 "),I.Ub(),I.Ub(),I.Vb(12,"div",12),I.Vb(13,"span",11),I.Ic(14),I.Ub(),I.Vb(15,"span",13),I.Ic(16," \u5ee0\u5340 SHC "),I.Ub(),I.Vb(17,"span",13),I.Ic(18),I.Ub(),I.Ub(),I.Vb(19,"div",1),I.Vb(20,"table",17),I.Vb(21,"thead"),I.Vb(22,"tr"),I.Vb(23,"th",18),I.Ic(24,"\u90e8\u9580\u55ae\u4f4d Dept."),I.Ub(),I.Vb(25,"th",18),I.Ic(26,"\u59d3\u540d Full Name"),I.Ub(),I.Vb(27,"th",19),I.Ic(28,"\u76f4\u5c6c\u4e3b\u7ba1\u8a55\u5206 L1 score"),I.Ub(),I.Vb(29,"th",18),I.Ic(30,"\u76f4\u5c6c\u4e3b\u7ba1\u8a55\u8a9e L1 comment"),I.Ub(),I.Vb(31,"th",19),I.Ic(32,"\u4e8c\u968e\u4e3b\u7ba1\u8a55\u5206 L2 score"),I.Ub(),I.Vb(33,"th",18),I.Ic(34,"\u4e8c\u968e\u4e3b\u7ba1\u8a55\u8a9e L2 comment"),I.Ub(),I.Vb(35,"th",19),I.Ic(36,"SMART \u5206\u6578"),I.Ub(),I.Ub(),I.Ub(),I.Vb(37,"tbody"),I.Vb(38,"tr"),I.Vb(39,"td"),I.Ic(40),I.Ub(),I.Vb(41,"td"),I.Ic(42),I.Ub(),I.Vb(43,"td",25),I.Ic(44),I.Ub(),I.Vb(45,"td"),I.Ic(46),I.Ub(),I.Vb(47,"td",25),I.Ic(48),I.Ub(),I.Vb(49,"td"),I.Ic(50),I.Ub(),I.Vb(51,"td",25),I.Ic(52),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Vb(53,"div",31),I.Vb(54,"button",23),I.fc("click",function(){return I.Ac(i),I.ic().exportExcel()}),I.Ic(55,"Export Excel"),I.Ub(),I.Vb(56,"button",32),I.fc("click",function(){return e.$implicit.close("Close click")}),I.Ic(57,"Close"),I.Ub(),I.Ub()}if(2&t){var n=I.ic();I.Cb(14),I.Kc(" \u5e74\u5ea6 ",(null==n.detail?null:n.detail.year)||2021," "),I.Cb(4),I.Kc(" \u5b63\u5ea6 Quarter Q",(null==n.detail?null:n.detail.quarter)||0," "),I.Cb(22),I.Jc(null==n.detail?null:n.detail.oc),I.Cb(2),I.Jc(null==n.detail?null:n.detail.fullName),I.Cb(2),I.Jc(null==n.detail?null:n.detail.l1Score),I.Cb(2),I.Jc(null==n.detail?null:n.detail.l1Comment),I.Cb(2),I.Jc(null==n.detail?null:n.detail.l2Score),I.Cb(2),I.Jc(null==n.detail?null:n.detail.l2Comment),I.Cb(2),I.Jc(null==n.detail?null:n.detail.smartScore)}}var We,Ye,Xe,Ze=[{path:"",data:{title:"",breadcrumb:"System"},children:[{path:"q1-q3-report",component:(We=function(t){i(n,t);var e=c(n);function n(t,i,c,o,a){var r;return l(this,n),(r=e.call(this)).modalService=t,r.alertify=i,r.service=c,r.datePipe=o,r.route=a,r.data=[],r.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},r.locale=localStorage.getItem("lang"),r.editSettings={showDeleteConfirmDialog:!1,allowEditing:!1,allowAdding:!1,allowDeleting:!1,mode:"Normal"},r.toolbarOptions=["Search"],r}return b(n,[{key:"ngOnInit",value:function(){this.currentTime=new Date,this.loadData()}},{key:"onChangeReportTime",value:function(t){this.loadData()}},{key:"openModal",value:function(t){this.itemData=t,this.getQ1Q3ReportInfo(t.id),this.modalService.open(this.detailModal,{size:"xl",backdrop:"static"}).result.then(function(t){},function(t){})}},{key:"toolbarClick",value:function(t){switch(t.item.id){case"grid_excelexport":this.grid.excelExport({hierarchyExportMode:"All"})}}},{key:"exportExcel",value:function(){this.service.q1q3ExportExcelByLeo(this.currentTimeRequest).subscribe(function(t){new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});var e=window.URL.createObjectURL(t),i=document.createElement("a");i.href=e,i.download="Q1,Q3 Report \u5b63\u5831\u8868.xlsx",i.click()})}},{key:"loadData",value:function(){var t=this;this.currentTimeRequest=this.datePipe.transform(this.currentTime,"YYYY-MM-dd HH:mm"),this.service.getQ1Q3DataByLeo(this.currentTimeRequest).subscribe(function(e){t.detail=e.data,console.log(t.detail),t.currentquater=e.currentQuarter})}},{key:"getQ1Q3ReportInfo",value:function(t){var e=this;this.service.getQ1Q3ReportInfo(t).subscribe(function(t){e.detail=t})}},{key:"NO",value:function(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}]),n}(H.a),We.\u0275fac=function(t){return new(t||We)(I.Pb(k.b),I.Pb(w.a),I.Pb(y),I.Pb(r.e),I.Pb(Q.a))},We.\u0275cmp=I.Jb({type:We,selectors:[["app-q1-q3-report"]],viewQuery:function(t,e){var i;1&t&&(I.Mc($e,1),I.Mc(Je,1)),2&t&&(I.wc(i=I.gc())&&(e.grid=i.first),I.wc(i=I.gc())&&(e.detailModal=i.first))},features:[I.Bb([r.e]),I.zb],decls:58,vars:7,consts:[[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"modal-body"],[1,"col-md-3","d-flex","justify-content-center"],[1,"form-group"],["for","exampleInputEmail1"],[2,"width","100%",3,"ngModel","ngModelChange","valueChange"],[1,"col-md-12","text-center","py-2"],[2,"font-size","x-large"],[1,"col-md-12","d-flex","justify-content-start","py-2"],[2,"font-size","x-large","margin-left","20px"],["shape","round","color","success","lock","true",3,"checked"],["p-icon","",1,"material-icons"],["style","font-size: x-large;margin-left: 20px",4,"ngIf"],[1,"table","table-bordered"],["scope","col"],["scope","col",2,"width","10%"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["detailModal",""],["type","button",1,"btn","btn-primary",3,"click"],[4,"ngFor","ngForOf"],[2,"text-align","center"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-footer"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(t,e){if(1&t&&(I.Vb(0,"div",0),I.Vb(1,"div",1),I.Vb(2,"div",2),I.Vb(3,"div",3),I.Vb(4,"h3",4),I.Ic(5," Q1,Q3 Report \u5b63\u5831\u8868 "),I.Ub(),I.Ub(),I.Vb(6,"div",5),I.Vb(7,"div",0),I.Vb(8,"div",6),I.Vb(9,"div",7),I.Vb(10,"label",8),I.Ic(11,"Change System Date"),I.Ub(),I.Vb(12,"kendo-datepicker",9),I.fc("ngModelChange",function(t){return e.currentTime=t})("valueChange",function(t){return e.onChangeReportTime(t)}),I.Ub(),I.Ub(),I.Ub(),I.Vb(13,"div",10),I.Vb(14,"span",11),I.Ic(15," \u4eba\u4e8b\u5b63\u5831\u8868 "),I.Ub(),I.Ub(),I.Vb(16,"div",12),I.Vb(17,"span",11),I.Ic(18),I.Ub(),I.Vb(19,"span",13),I.Ic(20," \u5ee0\u5340 SHC "),I.Ub(),I.Vb(21,"span",13),I.Ic(22," \u5b63\u5ea6 Quarter "),I.Ub(),I.Vb(23,"span",13),I.Vb(24,"p-checkbox",14),I.Vb(25,"i",15),I.Ic(26,"done"),I.Ub(),I.Ic(27," Q1 "),I.Ub(),I.Ub(),I.Vb(28,"span",13),I.Vb(29,"p-checkbox",14),I.Vb(30,"i",15),I.Ic(31,"done"),I.Ub(),I.Ic(32," Q3 "),I.Ub(),I.Ub(),I.Gc(33,ze,3,0,"span",16),I.Ub(),I.Vb(34,"div",1),I.Vb(35,"table",17),I.Vb(36,"thead"),I.Vb(37,"tr"),I.Vb(38,"th",18),I.Ic(39,"\u90e8\u9580\u55ae\u4f4d Dept."),I.Ub(),I.Vb(40,"th",18),I.Ic(41,"\u59d3\u540d Full Name"),I.Ub(),I.Vb(42,"th",19),I.Ic(43,"\u76f4\u5c6c\u4e3b\u7ba1\u8a55\u5206 L1 score"),I.Ub(),I.Vb(44,"th",18),I.Ic(45,"\u76f4\u5c6c\u4e3b\u7ba1\u8a55\u8a9e L1 comment"),I.Ub(),I.Vb(46,"th",19),I.Ic(47,"\u4e8c\u968e\u4e3b\u7ba1\u8a55\u5206 L2 score"),I.Ub(),I.Vb(48,"th",18),I.Ic(49,"\u4e8c\u968e\u4e3b\u7ba1\u8a55\u8a9e L2 comment"),I.Ub(),I.Vb(50,"th",19),I.Ic(51,"SMART \u5206\u6578"),I.Ub(),I.Ub(),I.Ub(),I.Vb(52,"tbody"),I.Gc(53,Be,2,1,"ng-container",20),I.Gc(54,Ne,2,0,"ng-template",null,21,I.Hc),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Ub(),I.Gc(56,Fe,58,9,"ng-template",null,22,I.Hc)),2&t){var i=I.xc(55);I.Cb(12),I.oc("ngModel",e.currentTime),I.Cb(6),I.Kc(" \u5e74\u5ea6 ",(null==e.detail?null:e.detail.year)||2021," "),I.Cb(6),I.oc("checked",1===e.currentquater),I.Cb(5),I.oc("checked",3===e.currentquater),I.Cb(4),I.oc("ngIf",1===e.currentquater||3===e.currentquater),I.Cb(20),I.oc("ngIf",void 0!==e.detail)("ngIfElse",i)}},directives:[s.b,u.f,u.i,Le,Ve,r.m,r.l],styles:[""]}),We),data:{title:"Q1,Q3 Report \u5b63\u5831\u8868",breadcrumb:"Q1,Q3 Report \u5b63\u5831\u8868",functionCode:"q1-q3-report"}},{path:"h1-h2-report",component:be,data:{title:"H1 & H2 Report",breadcrumb:"H1 & H2 Report",functionCode:"h1-h2-report"}},{path:"hq-hr-report",component:ee,data:{title:"HQ HR Report \u5e74\u4e2d\u8003\u6838\u540d\u55ae",breadcrumb:"HQ HR Report \u5e74\u4e2d\u8003\u6838\u540d\u55ae",functionCode:"q1-q3-report"}},{path:"ghr-report",component:Ft,data:{title:"GHR Report",breadcrumb:"GHR Report",functionCode:"ghr-report"}}]}],ti=((Ye=function t(){l(this,t)}).\u0275fac=function(t){return new(t||Ye)},Ye.\u0275mod=I.Nb({type:Ye}),Ye.\u0275inj=I.Mb({imports:[[Q.g.forChild(Ze)],Q.g]}),Ye),ei=o("BrIm"),ii=o("e7Im");function ni(t){return new h.a(t,"./assets/i18n/",".json")}var ci=localStorage.getItem("lang");Object(m.eb)(o("2PVe"),o("GFvd"),o("GFWS"),o("0zpJ"),o("LRxf")),Object(m.eb)(o("2PVe"),o("oP7I"),o("Joj5"),o("3JeS"),o("LRxf")),Object(m.eb)(o("2PVe"),o("1OsK"),o("pm0Y"),o("K8f6"),o("LRxf")),Xe="vi"===ci?ci:"en"===ci?"en":"zh";var oi,ai=((oi=function t(){l(this,t),"vi"===ci?(Xe="vi",setTimeout(function(){m.q.load(o("+7Wi")),Object(m.qb)("vi")})):"en"===ci?(Xe="en",setTimeout(function(){m.q.load(o("7j5C")),Object(m.qb)("en")})):(Xe="zh",setTimeout(function(){m.q.load(o("7e+1")),Object(m.qb)("zh")}))}).\u0275fac=function(t){return new(t||oi)},oi.\u0275mod=I.Nb({type:oi}),oi.\u0275inj=I.Mb({imports:[[qe,r.c,u.b,u.k,f.c,g.f,A.e,p.a,p.b,ti,s.a,ei.e,ii.a,f.d,a.b,ei.d,R.k,d.b.forChild({loader:{provide:d.a,useFactory:ni,deps:[C.b]},defaultLanguage:Xe})]]}),oi)}}])}();