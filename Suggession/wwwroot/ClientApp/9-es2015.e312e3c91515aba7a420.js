(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"tm/U":function(t,e,i){"use strict";i.r(e),i.d(e,"HttpLoaderFactory",function(){return Ee}),i.d(e,"ReportModule",function(){return Te});var n=i("10VE"),c=i("SVse"),o=i("s7LF"),l=i("TSSN"),a=i("OoJn"),r=i("sWsm"),b=i("PDtH"),s=i("emFE"),d=i("k5Gf"),u=i("4SUy"),p=i("1H6I"),h=i("2Vo4"),g=i("IheW"),m=i("AytR"),f=i("8Y7J");new g.e({"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("token")});let U=(()=>{class t{constructor(t,e){this.http=t,this.env=e,this.baseUrl=m.a.apiUrl,this.messageSource=new h.a(0),this.currentMessage=this.messageSource.asObservable()}changeMessage(t){this.messageSource.next(t)}getQ1Q3Data(){return this.http.get(`${this.env.apiUrl}Report/GetQ1Q3Data`,{})}getGHRData(){return this.http.get(`${this.env.apiUrl}Report/GetGHRData`,{})}getQ1Q3DataByLeo(t){return this.http.get(`${this.env.apiUrl}Report/getQ1Q3DataByLeo?currentTime=${t}`,{})}getQ1Q3ReportInfo(t){return this.http.get(`${this.env.apiUrl}Report/getQ1Q3ReportInfo?accountId=${t}`,{})}q1q3ExportExcel(t){return this.http.get(`${this.env.apiUrl}Report/ExportExcel/${t}`,{responseType:"blob"})}q1q3ExportExcelByLeo(t){return this.http.get(`${this.env.apiUrl}Report/ExportExcelByLeo?currentTime=${t}`,{responseType:"blob"})}geH1H2Data(){return this.http.get(`${this.env.apiUrl}Report/GetH1H2Data`,{})}H1H2ExportExcel(t){return this.http.get(`${this.env.apiUrl}Report/ExportH1H2Excel/${t}`,{responseType:"blob"})}getH1H2ReportInfo(t){return this.http.get(`${this.env.apiUrl}Report/getH1H2ReportInfo?accountId=${t}`,{})}getGHRReportH1Info(t){return this.http.get(`${this.env.apiUrl}Report/GetGHRReportH1Info?accountId=${t}`,{})}getGHRReportH2Info(t){return this.http.get(`${this.env.apiUrl}Report/GetGHRReportH2Info?accountId=${t}`,{})}ReportUpdateComment(t){return this.http.put(`${this.env.apiUrl}Report/ReportUpdateComment`,t)}ReportUpdateAtScore(t){return this.http.put(`${this.env.apiUrl}Report/ReportUpdateAtScore`,t)}ReportUpdateSpe(t){return this.http.put(`${this.env.apiUrl}Report/ReportUpdateSpeComment`,t)}geHQHRData(){return this.http.get(`${this.env.apiUrl}Report/GetHQHRData`,{})}}return t.\u0275fac=function(e){return new(e||t)(f.cc(g.b),f.cc(p.a))},t.\u0275prov=f.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var C=i("dQqK"),V=i("HJFG"),v=i("L6UN"),I=i("G0yt"),S=i("7g+E"),H=i("iInd"),x=i("4DqM"),w=i("7YrF");const D=["grid"],y=["detailModal"];function Q(t,e){if(1&t&&f.Ic(0),2&t){const t=e.$implicit,i=f.ic();f.Kc(" ",i.NO(t.index)," ")}}function k(t,e){1&t&&f.Ic(0," # ")}function A(t,e){if(1&t){const t=f.Wb();f.Vb(0,"button",17),f.fc("click",function(){f.Ac(t);const i=e.$implicit,n=f.ic(),c=f.xc(22);return n.openModal(i,c,"H1")}),f.Ic(1,"H1"),f.Ub(),f.Ic(2," | "),f.Vb(3,"button",17),f.fc("click",function(){f.Ac(t);const i=e.$implicit,n=f.ic(),c=f.xc(24);return n.openModal(i,c,"H2")}),f.Ic(4,"H2"),f.Ub()}}function R(t,e){if(1&t&&f.Ic(0),2&t){const t=e.$implicit,i=f.ic(2);f.Kc(" ",i.NO(t.index)," ")}}function P(t,e){if(1&t&&(f.Vb(0,"li"),f.Ic(1),f.Ub()),2&t){const t=e.$implicit;f.Cb(1),f.Jc(t)}}function E(t,e){if(1&t&&(f.Vb(0,"ul",58),f.Gc(1,P,2,1,"li",59),f.Ub()),2&t){const t=e.$implicit;f.Cb(1),f.oc("ngForOf",t.l0ActionList)}}function _(t,e){if(1&t&&(f.Vb(0,"tr",61),f.Vb(1,"td",62),f.Ic(2),f.Ub(),f.Ub()),2&t){const t=e.$implicit;f.Cb(2),f.Jc(t.headerText)}}function G(t,e){if(1&t&&f.Gc(0,_,3,1,"tr",60),2&t){const t=f.ic(2);f.oc("ngForOf",t.columns)}}function T(t,e){if(1&t&&(f.Vb(0,"tr",61),f.Vb(1,"td",62),f.Ic(2),f.Ub(),f.Ub()),2&t){const t=e.$implicit;f.Cb(2),f.Jc(t.headerText)}}function $(t,e){if(1&t&&f.Gc(0,T,3,1,"tr",60),2&t){const t=f.ic(2);f.oc("ngForOf",t.Resultcolumns)}}function M(t,e){1&t&&f.Ic(0),2&t&&f.Kc(" ",e.$implicit.kpiComment," ")}function O(t,e){if(1&t&&(f.Tb(0),f.Qb(1,"input",66),f.Sb()),2&t){const t=f.ic().$implicit;f.Cb(1),f.oc("value",t.q1)}}function K(t,e){if(1&t&&f.Qb(0,"input",67),2&t){const t=f.ic().$implicit;f.oc("value",t.q1)}}function L(t,e){if(1&t&&(f.Vb(0,"span",63),f.Gc(1,O,2,1,"ng-container",64),f.Gc(2,K,1,1,"ng-template",null,65,f.Hc),f.Ub()),2&t){const t=e.$implicit,i=f.xc(3);f.oc("ngClass",""===t.q1?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),f.Cb(1),f.oc("ngIf",""===t.q1)("ngIfElse",i)}}function q(t,e){if(1&t&&(f.Tb(0),f.Qb(1,"input",68),f.Sb()),2&t){const t=f.ic().$implicit;f.Cb(1),f.oc("value",t.q2)}}function J(t,e){if(1&t&&f.Qb(0,"input",69),2&t){const t=f.ic().$implicit;f.oc("value",t.q2)}}function z(t,e){if(1&t&&(f.Vb(0,"span",63),f.Gc(1,q,2,1,"ng-container",64),f.Gc(2,J,1,1,"ng-template",null,65,f.Hc),f.Ub()),2&t){const t=e.$implicit,i=f.xc(3);f.oc("ngClass",""===t.q2?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),f.Cb(1),f.oc("ngIf",""===t.q2)("ngIfElse",i)}}function B(t,e){1&t&&f.Ic(0),2&t&&f.Kc(" ",e.$implicit.attitudeComment," ")}function N(t,e){if(1&t&&(f.Tb(0),f.Qb(1,"input",70),f.Sb()),2&t){const t=f.ic().$implicit;f.Cb(1),f.oc("value",t.h1)}}function j(t,e){if(1&t&&f.Qb(0,"input",71),2&t){const t=f.ic().$implicit;f.oc("value",t.h1)}}function F(t,e){if(1&t&&(f.Vb(0,"span",63),f.Gc(1,N,2,1,"ng-container",64),f.Gc(2,j,1,1,"ng-template",null,65,f.Hc),f.Ub()),2&t){const t=e.$implicit,i=f.xc(3);f.oc("ngClass",""===t.h1?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),f.Cb(1),f.oc("ngIf",""===t.h1)("ngIfElse",i)}}function W(t,e){if(1&t&&(f.Tb(0),f.Qb(1,"input",72),f.Sb()),2&t){const t=f.ic().$implicit;f.Cb(1),f.oc("value",t.l1)}}function Y(t,e){if(1&t&&f.Qb(0,"input",73),2&t){const t=f.ic().$implicit;f.oc("value",t.l1)}}function X(t,e){if(1&t&&(f.Vb(0,"span",63),f.Gc(1,W,2,1,"ng-container",64),f.Gc(2,Y,1,1,"ng-template",null,65,f.Hc),f.Ub()),2&t){const t=e.$implicit,i=f.xc(3);f.oc("ngClass",0===t.l1?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),f.Cb(1),f.oc("ngIf",0===t.l1)("ngIfElse",i)}}function Z(t,e){if(1&t&&(f.Tb(0),f.Qb(1,"input",74),f.Sb()),2&t){const t=f.ic().$implicit;f.Cb(1),f.oc("value",t.l2)}}function tt(t,e){if(1&t&&f.Qb(0,"input",75),2&t){const t=f.ic().$implicit;f.oc("value",t.l2)}}function et(t,e){if(1&t&&(f.Vb(0,"span",63),f.Gc(1,Z,2,1,"ng-container",64),f.Gc(2,tt,1,1,"ng-template",null,65,f.Hc),f.Ub()),2&t){const t=e.$implicit,i=f.xc(3);f.oc("ngClass",0===t.l2?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),f.Cb(1),f.oc("ngIf",0===t.l2)("ngIfElse",i)}}function it(t,e){if(1&t&&(f.Tb(0),f.Qb(1,"input",76),f.Sb()),2&t){const t=f.ic().$implicit;f.Cb(1),f.oc("value",t.fl)}}function nt(t,e){if(1&t&&f.Qb(0,"input",77),2&t){const t=f.ic().$implicit;f.oc("value",t.fl)}}function ct(t,e){if(1&t&&(f.Vb(0,"span",63),f.Gc(1,it,2,1,"ng-container",64),f.Gc(2,nt,1,1,"ng-template",null,65,f.Hc),f.Ub()),2&t){const t=e.$implicit,i=f.xc(3);f.oc("ngClass",0===t.fl?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),f.Cb(1),f.oc("ngIf",0===t.fl)("ngIfElse",i)}}function ot(t,e){1&t&&f.Ic(0),2&t&&f.Kc(" ",e.$implicit.score," ")}function lt(t,e){if(1&t&&(f.Tb(0),f.Qb(1,"input",78),f.Sb()),2&t){const t=f.ic().$implicit;f.Cb(1),f.oc("value",t.comment)}}function at(t,e){if(1&t&&f.Qb(0,"input",79),2&t){const t=f.ic().$implicit;f.oc("value",t.comment)}}function rt(t,e){if(1&t&&(f.Vb(0,"span",63),f.Gc(1,lt,2,1,"ng-container",64),f.Gc(2,at,1,1,"ng-template",null,65,f.Hc),f.Ub()),2&t){const t=e.$implicit,i=f.xc(3);f.oc("ngClass",""===t.comment?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),f.Cb(1),f.oc("ngIf",""===t.comment)("ngIfElse",i)}}function bt(t,e){if(1&t){const t=f.Wb();f.Qb(0,"a",null,18),f.Vb(2,"div",19),f.Vb(3,"h4",20),f.Qb(4,"i",21),f.Ic(5," GHR Report "),f.Ub(),f.Vb(6,"button",22),f.fc("click",function(){return e.$implicit.dismiss("Cross click")}),f.Vb(7,"span",23),f.Ic(8,"\xd7"),f.Ub(),f.Ub(),f.Ub(),f.Vb(9,"div",24),f.Vb(10,"div",0),f.Vb(11,"div",1),f.Vb(12,"div",0),f.Vb(13,"div",1),f.Vb(14,"div",0),f.Vb(15,"div",25),f.Ic(16),f.Ub(),f.Vb(17,"div",25),f.Ic(18),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Vb(19,"div",26),f.Vb(20,"span"),f.Ic(21),f.Ub(),f.Ub(),f.Vb(22,"ejs-grid",27,7),f.fc("queryCellInfo",function(e){return f.Ac(t),f.ic().queryCellInfoEvent(e)}),f.Vb(24,"e-columns"),f.Vb(25,"e-column",28),f.Gc(26,R,1,1,"ng-template",null,9,f.Hc),f.Ub(),f.Qb(28,"e-column",29),f.Qb(29,"e-column",30),f.Vb(30,"e-column",31),f.Gc(31,E,2,1,"ng-template",null,9,f.Hc),f.Ub(),f.Vb(33,"e-column",32),f.Gc(34,G,1,1,"ng-template",null,9,f.Hc),f.Ub(),f.Vb(36,"e-column",33),f.Gc(37,$,1,1,"ng-template",null,9,f.Hc),f.Ub(),f.Ub(),f.Ub(),f.Qb(39,"hr"),f.Vb(40,"div",26),f.Vb(41,"span"),f.Ic(42,"KPI \u8a55\u8a9e"),f.Ub(),f.Ub(),f.Vb(43,"ejs-grid",34,35),f.fc("actionComplete",function(e){return f.Ac(t),f.ic().actionCompleteKPIComment(e)})("actionBegin",function(e){return f.Ac(t),f.ic().actionBeginKPIComment(e)})("recordDoubleClick",function(e){return f.Ac(t),f.ic().onDoubleClickKPIComment(e)}),f.Vb(45,"e-columns"),f.Vb(46,"e-column",36),f.Gc(47,M,1,1,"ng-template",null,10,f.Hc),f.Ub(),f.Vb(49,"e-column",37),f.Gc(50,L,4,3,"ng-template",null,10,f.Hc),f.Ub(),f.Vb(52,"e-column",38),f.Gc(53,z,4,3,"ng-template",null,10,f.Hc),f.Ub(),f.Ub(),f.Ub(),f.Qb(55,"hr"),f.Vb(56,"div",26),f.Vb(57,"span"),f.Ic(58,"\u614b\u5ea6\u8a55\u8a9e"),f.Ub(),f.Ub(),f.Vb(59,"ejs-grid",39,7),f.fc("actionComplete",function(e){return f.Ac(t),f.ic().actionCompleteAtComment(e)})("actionBegin",function(e){return f.Ac(t),f.ic().actionBeginAtComment(e)}),f.Vb(61,"e-columns"),f.Vb(62,"e-column",40),f.Gc(63,B,1,1,"ng-template",null,10,f.Hc),f.Ub(),f.Vb(65,"e-column",41),f.Gc(66,F,4,3,"ng-template",null,10,f.Hc),f.Ub(),f.Ub(),f.Ub(),f.Qb(68,"hr"),f.Vb(69,"div",26),f.Vb(70,"span"),f.Ic(71),f.Ub(),f.Ub(),f.Vb(72,"ejs-grid",42,7),f.fc("actionComplete",function(e){return f.Ac(t),f.ic().actionCompleteAtScore(e)})("actionBegin",function(e){return f.Ac(t),f.ic().actionBeginAtScore(e)}),f.Vb(74,"e-columns"),f.Vb(75,"e-column",43),f.Gc(76,X,4,3,"ng-template",null,10,f.Hc),f.Ub(),f.Vb(78,"e-column",44),f.Gc(79,et,4,3,"ng-template",null,10,f.Hc),f.Ub(),f.Vb(81,"e-column",45),f.Gc(82,ct,4,3,"ng-template",null,10,f.Hc),f.Ub(),f.Ub(),f.Ub(),f.Qb(84,"hr"),f.Vb(85,"div",26),f.Vb(86,"span"),f.Ic(87),f.Ub(),f.Ub(),f.Vb(88,"ejs-grid",46,7),f.Vb(90,"e-columns"),f.Qb(91,"e-column",47),f.Qb(92,"e-column",43),f.Qb(93,"e-column",44),f.Qb(94,"e-column",48),f.Ub(),f.Ub(),f.Qb(95,"hr"),f.Vb(96,"div",26),f.Vb(97,"span"),f.Ic(98),f.Ub(),f.Ub(),f.Vb(99,"ejs-grid",49,7),f.fc("actionComplete",function(e){return f.Ac(t),f.ic().actionCompleteSpeScore(e)})("actionBegin",function(e){return f.Ac(t),f.ic().actionBeginSpeScore(e)}),f.Vb(101,"e-columns"),f.Vb(102,"e-column",50),f.Gc(103,ot,1,1,"ng-template",null,10,f.Hc),f.Ub(),f.Vb(105,"e-column",51),f.Gc(106,rt,4,3,"ng-template",null,10,f.Hc),f.Ub(),f.Ub(),f.Ub(),f.Qb(108,"hr"),f.Vb(109,"span"),f.Ic(110),f.Ub(),f.Vb(111,"div",52),f.Vb(112,"button",53),f.fc("click",function(){return e.$implicit.close("Close click")}),f.Ic(113,"Back"),f.Ub(),f.Ic(114," | "),f.Vb(115,"button",54),f.fc("click",function(){return f.Ac(t),f.ic().save()}),f.Ic(116,"Submit"),f.Ub(),f.Vb(117,"span",55),f.Ic(118,"| |"),f.Ub(),f.Vb(119,"a",56),f.fc("click",function(){f.Ac(t);const e=f.xc(1);return f.ic().scroll(e)}),f.Qb(120,"i",57),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub()}if(2&t){const t=f.ic();f.Cb(16),f.Kc("Dept. ",t.dept,""),f.Cb(2),f.Kc("Name: ",t.name,""),f.Cb(3),f.Jc(t.title),f.Cb(1),f.oc("dataSource",t.gridDataH1)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings)("allowExcelExport",!0),f.Cb(21),f.oc("dataSource",t.kpicommentH1)("allowResizing",!0)("showColumnMenu",!0)("editSettings",t.editCommentSettings),f.Cb(16),f.oc("allowResizing",!0)("editSettings",t.editCommentSettings)("dataSource",t.attitudecommentData)("showColumnMenu",!0),f.Cb(12),f.Kc("Attitude Score ",t.titles,""),f.Cb(1),f.oc("dataSource",t.atScoreData)("editSettings",t.editCommentSettings)("allowResizing",!0)("showColumnMenu",!0),f.Cb(15),f.Kc("KPI Score ",t.titles,""),f.Cb(1),f.oc("dataSource",t.kpiScoreData)("allowResizing",!0)("showColumnMenu",!0),f.Cb(10),f.Kc("Special Score ",t.titles,""),f.Cb(1),f.oc("allowResizing",!0)("dataSource",t.specialScoreData)("editSettings",t.editCommentSettings)("showColumnMenu",!0),f.Cb(11),f.Lc("",t.titles," Score: ",t.h1Score,"")}}function st(t,e){if(1&t&&f.Ic(0),2&t){const t=e.$implicit,i=f.ic(2);f.Kc(" ",i.NO(t.index)," ")}}function dt(t,e){if(1&t&&(f.Vb(0,"li"),f.Ic(1),f.Ub()),2&t){const t=e.$implicit;f.Cb(1),f.Jc(t)}}function ut(t,e){if(1&t&&(f.Vb(0,"ul",58),f.Gc(1,dt,2,1,"li",59),f.Ub()),2&t){const t=e.$implicit;f.Cb(1),f.oc("ngForOf",t.l0ActionList)}}function pt(t,e){if(1&t&&(f.Vb(0,"tr",61),f.Vb(1,"td",62),f.Ic(2),f.Ub(),f.Ub()),2&t){const t=e.$implicit;f.Cb(2),f.Jc(t.headerText)}}function ht(t,e){if(1&t&&f.Gc(0,pt,3,1,"tr",60),2&t){const t=f.ic(2);f.oc("ngForOf",t.columns)}}function gt(t,e){if(1&t&&(f.Vb(0,"tr",61),f.Vb(1,"td",62),f.Ic(2),f.Ub(),f.Ub()),2&t){const t=e.$implicit;f.Cb(2),f.Jc(t.headerText)}}function mt(t,e){if(1&t&&f.Gc(0,gt,3,1,"tr",60),2&t){const t=f.ic(2);f.oc("ngForOf",t.Resultcolumns)}}function ft(t,e){1&t&&f.Ic(0),2&t&&f.Kc(" ",e.$implicit.kpiComment," ")}function Ut(t,e){if(1&t&&(f.Tb(0),f.Qb(1,"input",66),f.Sb()),2&t){const t=f.ic().$implicit;f.Cb(1),f.oc("value",t.q1)}}function Ct(t,e){if(1&t&&f.Qb(0,"input",67),2&t){const t=f.ic().$implicit;f.oc("value",t.q1)}}function Vt(t,e){if(1&t&&(f.Vb(0,"span",63),f.Gc(1,Ut,2,1,"ng-container",64),f.Gc(2,Ct,1,1,"ng-template",null,65,f.Hc),f.Ub()),2&t){const t=e.$implicit,i=f.xc(3);f.oc("ngClass",""===t.q1?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),f.Cb(1),f.oc("ngIf",""===t.q1)("ngIfElse",i)}}function vt(t,e){if(1&t&&(f.Tb(0),f.Qb(1,"input",68),f.Sb()),2&t){const t=f.ic().$implicit;f.Cb(1),f.oc("value",t.q2)}}function It(t,e){if(1&t&&f.Qb(0,"input",69),2&t){const t=f.ic().$implicit;f.oc("value",t.q2)}}function St(t,e){if(1&t&&(f.Vb(0,"span",63),f.Gc(1,vt,2,1,"ng-container",64),f.Gc(2,It,1,1,"ng-template",null,65,f.Hc),f.Ub()),2&t){const t=e.$implicit,i=f.xc(3);f.oc("ngClass",""===t.q2?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),f.Cb(1),f.oc("ngIf",""===t.q2)("ngIfElse",i)}}function Ht(t,e){1&t&&f.Ic(0),2&t&&f.Kc(" ",e.$implicit.attitudeComment," ")}function xt(t,e){if(1&t&&(f.Tb(0),f.Qb(1,"input",70),f.Sb()),2&t){const t=f.ic().$implicit;f.Cb(1),f.oc("value",t.h1)}}function wt(t,e){if(1&t&&f.Qb(0,"input",71),2&t){const t=f.ic().$implicit;f.oc("value",t.h1)}}function Dt(t,e){if(1&t&&(f.Vb(0,"span",63),f.Gc(1,xt,2,1,"ng-container",64),f.Gc(2,wt,1,1,"ng-template",null,65,f.Hc),f.Ub()),2&t){const t=e.$implicit,i=f.xc(3);f.oc("ngClass",""===t.h1?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),f.Cb(1),f.oc("ngIf",""===t.h1)("ngIfElse",i)}}function yt(t,e){if(1&t&&(f.Tb(0),f.Qb(1,"input",72),f.Sb()),2&t){const t=f.ic().$implicit;f.Cb(1),f.oc("value",t.l1)}}function Qt(t,e){if(1&t&&f.Qb(0,"input",73),2&t){const t=f.ic().$implicit;f.oc("value",t.l1)}}function kt(t,e){if(1&t&&(f.Vb(0,"span",63),f.Gc(1,yt,2,1,"ng-container",64),f.Gc(2,Qt,1,1,"ng-template",null,65,f.Hc),f.Ub()),2&t){const t=e.$implicit,i=f.xc(3);f.oc("ngClass",0===t.l1?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),f.Cb(1),f.oc("ngIf",0===t.l1)("ngIfElse",i)}}function At(t,e){if(1&t&&(f.Tb(0),f.Qb(1,"input",74),f.Sb()),2&t){const t=f.ic().$implicit;f.Cb(1),f.oc("value",t.l2)}}function Rt(t,e){if(1&t&&f.Qb(0,"input",75),2&t){const t=f.ic().$implicit;f.oc("value",t.l2)}}function Pt(t,e){if(1&t&&(f.Vb(0,"span",63),f.Gc(1,At,2,1,"ng-container",64),f.Gc(2,Rt,1,1,"ng-template",null,65,f.Hc),f.Ub()),2&t){const t=e.$implicit,i=f.xc(3);f.oc("ngClass",0===t.l2?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),f.Cb(1),f.oc("ngIf",0===t.l2)("ngIfElse",i)}}function Et(t,e){if(1&t&&(f.Tb(0),f.Qb(1,"input",76),f.Sb()),2&t){const t=f.ic().$implicit;f.Cb(1),f.oc("value",t.fl)}}function _t(t,e){if(1&t&&f.Qb(0,"input",77),2&t){const t=f.ic().$implicit;f.oc("value",t.fl)}}function Gt(t,e){if(1&t&&(f.Vb(0,"span",63),f.Gc(1,Et,2,1,"ng-container",64),f.Gc(2,_t,1,1,"ng-template",null,65,f.Hc),f.Ub()),2&t){const t=e.$implicit,i=f.xc(3);f.oc("ngClass",0===t.fl?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),f.Cb(1),f.oc("ngIf",0===t.fl)("ngIfElse",i)}}function Tt(t,e){1&t&&f.Ic(0),2&t&&f.Kc(" ",e.$implicit.score," ")}function $t(t,e){if(1&t&&(f.Tb(0),f.Qb(1,"input",78),f.Sb()),2&t){const t=f.ic().$implicit;f.Cb(1),f.oc("value",t.comment)}}function Mt(t,e){if(1&t&&f.Qb(0,"input",79),2&t){const t=f.ic().$implicit;f.oc("value",t.comment)}}function Ot(t,e){if(1&t&&(f.Vb(0,"span",63),f.Gc(1,$t,2,1,"ng-container",64),f.Gc(2,Mt,1,1,"ng-template",null,65,f.Hc),f.Ub()),2&t){const t=e.$implicit,i=f.xc(3);f.oc("ngClass",""===t.comment?"e-input-group e-control-wrapper e-valid-input e-disabled":"e-input-group e-control-wrapper e-valid-input"),f.Cb(1),f.oc("ngIf",""===t.comment)("ngIfElse",i)}}function Kt(t,e){if(1&t){const t=f.Wb();f.Qb(0,"a",null,18),f.Vb(2,"div",19),f.Vb(3,"h4",20),f.Qb(4,"i",21),f.Ic(5," GHR Report "),f.Ub(),f.Vb(6,"button",22),f.fc("click",function(){return e.$implicit.dismiss("Cross click")}),f.Vb(7,"span",23),f.Ic(8,"\xd7"),f.Ub(),f.Ub(),f.Ub(),f.Vb(9,"div",24),f.Vb(10,"div",0),f.Vb(11,"div",1),f.Vb(12,"div",0),f.Vb(13,"div",1),f.Vb(14,"div",0),f.Vb(15,"div",25),f.Ic(16),f.Ub(),f.Vb(17,"div",25),f.Ic(18),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Vb(19,"div",26),f.Vb(20,"span"),f.Ic(21),f.Ub(),f.Ub(),f.Vb(22,"ejs-grid",27,7),f.fc("queryCellInfo",function(e){return f.Ac(t),f.ic().queryCellInfoEvent(e)}),f.Vb(24,"e-columns"),f.Vb(25,"e-column",28),f.Gc(26,st,1,1,"ng-template",null,9,f.Hc),f.Ub(),f.Qb(28,"e-column",29),f.Qb(29,"e-column",30),f.Vb(30,"e-column",31),f.Gc(31,ut,2,1,"ng-template",null,9,f.Hc),f.Ub(),f.Vb(33,"e-column",80),f.Gc(34,ht,1,1,"ng-template",null,9,f.Hc),f.Ub(),f.Vb(36,"e-column",33),f.Gc(37,mt,1,1,"ng-template",null,9,f.Hc),f.Ub(),f.Ub(),f.Ub(),f.Qb(39,"hr"),f.Vb(40,"div",26),f.Vb(41,"span"),f.Ic(42,"KPI \u8a55\u8a9e"),f.Ub(),f.Ub(),f.Vb(43,"ejs-grid",34,35),f.fc("actionComplete",function(e){return f.Ac(t),f.ic().actionCompleteKPIComment(e)})("actionBegin",function(e){return f.Ac(t),f.ic().actionBeginKPIComment(e)})("recordDoubleClick",function(e){return f.Ac(t),f.ic().onDoubleClickKPIComment(e)}),f.Vb(45,"e-columns"),f.Vb(46,"e-column",36),f.Gc(47,ft,1,1,"ng-template",null,10,f.Hc),f.Ub(),f.Vb(49,"e-column",81),f.Gc(50,Vt,4,3,"ng-template",null,10,f.Hc),f.Ub(),f.Vb(52,"e-column",82),f.Gc(53,St,4,3,"ng-template",null,10,f.Hc),f.Ub(),f.Ub(),f.Ub(),f.Qb(55,"hr"),f.Vb(56,"div",26),f.Vb(57,"span"),f.Ic(58,"\u614b\u5ea6\u8a55\u8a9e"),f.Ub(),f.Ub(),f.Vb(59,"ejs-grid",39,7),f.fc("actionComplete",function(e){return f.Ac(t),f.ic().actionCompleteAtComment(e)})("actionBegin",function(e){return f.Ac(t),f.ic().actionBeginAtComment(e)}),f.Vb(61,"e-columns"),f.Vb(62,"e-column",40),f.Gc(63,Ht,1,1,"ng-template",null,10,f.Hc),f.Ub(),f.Vb(65,"e-column",83),f.Gc(66,Dt,4,3,"ng-template",null,10,f.Hc),f.Ub(),f.Ub(),f.Ub(),f.Qb(68,"hr"),f.Vb(69,"div",26),f.Vb(70,"span"),f.Ic(71),f.Ub(),f.Ub(),f.Vb(72,"ejs-grid",42,7),f.fc("actionComplete",function(e){return f.Ac(t),f.ic().actionCompleteAtScore(e)})("actionBegin",function(e){return f.Ac(t),f.ic().actionBeginAtScore(e)}),f.Vb(74,"e-columns"),f.Vb(75,"e-column",43),f.Gc(76,kt,4,3,"ng-template",null,10,f.Hc),f.Ub(),f.Vb(78,"e-column",44),f.Gc(79,Pt,4,3,"ng-template",null,10,f.Hc),f.Ub(),f.Vb(81,"e-column",45),f.Gc(82,Gt,4,3,"ng-template",null,10,f.Hc),f.Ub(),f.Ub(),f.Ub(),f.Qb(84,"hr"),f.Vb(85,"div",26),f.Vb(86,"span"),f.Ic(87),f.Ub(),f.Ub(),f.Vb(88,"ejs-grid",46,7),f.Vb(90,"e-columns"),f.Qb(91,"e-column",47),f.Qb(92,"e-column",43),f.Qb(93,"e-column",44),f.Qb(94,"e-column",48),f.Ub(),f.Ub(),f.Qb(95,"hr"),f.Vb(96,"div",26),f.Vb(97,"span"),f.Ic(98),f.Ub(),f.Ub(),f.Vb(99,"ejs-grid",49,7),f.fc("actionComplete",function(e){return f.Ac(t),f.ic().actionCompleteSpeScore(e)})("actionBegin",function(e){return f.Ac(t),f.ic().actionBeginSpeScore(e)}),f.Vb(101,"e-columns"),f.Vb(102,"e-column",50),f.Gc(103,Tt,1,1,"ng-template",null,10,f.Hc),f.Ub(),f.Vb(105,"e-column",51),f.Gc(106,Ot,4,3,"ng-template",null,10,f.Hc),f.Ub(),f.Ub(),f.Ub(),f.Qb(108,"hr"),f.Vb(109,"span"),f.Ic(110),f.Ub(),f.Vb(111,"div",52),f.Vb(112,"button",53),f.fc("click",function(){return e.$implicit.close("Close click")}),f.Ic(113,"Back"),f.Ub(),f.Ic(114," | "),f.Vb(115,"button",54),f.fc("click",function(){return f.Ac(t),f.ic().save()}),f.Ic(116,"Submit"),f.Ub(),f.Vb(117,"span",55),f.Ic(118,"| |"),f.Ub(),f.Vb(119,"a",56),f.fc("click",function(){f.Ac(t);const e=f.xc(1);return f.ic().scroll(e)}),f.Qb(120,"i",57),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub()}if(2&t){const t=f.ic();f.Cb(16),f.Kc("Dept. ",t.dept,""),f.Cb(2),f.Kc("Name: ",t.name,""),f.Cb(3),f.Jc(t.title),f.Cb(1),f.oc("dataSource",t.gridDataH1)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings)("allowExcelExport",!0),f.Cb(21),f.oc("dataSource",t.kpicommentH1)("allowResizing",!0)("showColumnMenu",!0)("editSettings",t.editCommentSettings),f.Cb(16),f.oc("allowResizing",!0)("editSettings",t.editCommentSettings)("dataSource",t.attitudecommentData)("showColumnMenu",!0),f.Cb(12),f.Kc("Attitude Score ",t.titles,""),f.Cb(1),f.oc("dataSource",t.atScoreData)("editSettings",t.editCommentSettings)("allowResizing",!0)("showColumnMenu",!0),f.Cb(15),f.Kc("KPI Score ",t.titles,""),f.Cb(1),f.oc("dataSource",t.kpiScoreData)("allowResizing",!0)("showColumnMenu",!0),f.Cb(10),f.Kc("Special Score ",t.titles,""),f.Cb(1),f.oc("allowResizing",!0)("dataSource",t.specialScoreData)("editSettings",t.editCommentSettings)("showColumnMenu",!0),f.Cb(11),f.Lc("",t.titles," Score: ",t.h1Score,"")}}let Lt=(()=>{class t extends C.a{constructor(t,e,i,n,c){super(),this.modalService=t,this.alertify=e,this.spinner=i,this.service=n,this.route=c,this.data=[],this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.locale=localStorage.getItem("lang"),this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!1,allowAdding:!1,allowDeleting:!1,mode:"Normal"},this.editCommentSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!1,allowDeleting:!1,mode:"Normal"},this.toolbarOptions=["Search"],this.avg=0,this.dataCommentPicked=[],this.dataAtScorePicked=[],this.dataSpeScorePicked=[],this.topPosToStartShowing=0,this.queryCellInfoEvent=t=>{var e;const i=t.data;for(const n of this.halfYearSettingsData)(""+n).includes(t.column.field)&&(t.cell.innerText=(null===(e=i.resultOfMonth.filter(t=>t.month===n)[0])||void 0===e?void 0:e.title)||"N/A")}}onScroll(t){console.log("aa")}ngAfterViewInit(){}ngOnInit(){this.loadData()}scroll(t){t.scrollIntoView()}gotoTop(){console.log("aaa"),window.scrollTo(0,0)}actionBeginKPIComment(t){if("beginEdit"===t.requestType&&(this.Q1CommentDefault=t.rowData.q1,this.Q2CommentDefault=t.rowData.q2),"save"===t.requestType){this.tempQ1Change=t.data.q1,this.tempQ2Change=t.data.q2;let i=this.Q2CommentDefault.length<this.tempQ2Change.length||this.Q2CommentDefault.length>this.tempQ2Change.length;if((this.Q1CommentDefault.length<this.tempQ1Change.length||this.Q1CommentDefault.length>this.tempQ1Change.length)&&t.data.q1ID>0){const i={ID:t.data.q1ID,Content:t.data.q1},n=this.dataCommentPicked.filter(e=>e.ID===t.data.q1ID);if(0===n.length)this.dataCommentPicked.push(i);else for(const c of n)for(var e=0;e<n.length;e++)if(c.ID===t.data.q1ID){c.Content=t.data.q1;break}}if(i&&t.data.q2ID>0){const i={ID:t.data.q2ID,Content:t.data.q2},n=this.dataCommentPicked.filter(e=>e.ID===t.data.q2ID);if(0===n.length)this.dataCommentPicked.push(i);else for(const c of n)for(e=0;e<n.length;e++)if(c.ID===t.data.q2ID){c.Content=t.data.q2;break}}}}onDoubleClickKPIComment(t){}actionCompleteKPIComment(t){}actionBeginAtComment(t){if("beginEdit"===t.requestType&&(this.H1CommentDefault=t.rowData.h1),"save"===t.requestType&&(this.tempH1Change=t.data.h1,(this.H1CommentDefault.length<this.tempH1Change.length||this.H1CommentDefault.length>this.tempH1Change.length)&&t.data.h1ID>0)){const i={ID:t.data.h1ID,Content:t.data.h1},n=this.dataCommentPicked.filter(e=>e.ID===t.data.h1ID);if(0===n.length)this.dataCommentPicked.push(i);else for(const c of n)for(var e=0;e<n.length;e++)if(c.ID===t.data.h1ID){c.Content=t.data.h1;break}}}actionCompleteAtComment(t){}actionBeginAtScore(t){if("beginEdit"===t.requestType&&(this.L1AtDefault=t.rowData.l1,this.L2AtDefault=t.rowData.l2,this.FLAtDefault=t.rowData.fl),"save"===t.requestType){this.tempL1AtChange=parseInt(t.data.l1),this.tempL2AtChange=parseInt(t.data.l2),this.tempFLAtChange=parseInt(t.data.fl);let i=this.L2AtDefault!==this.tempL2AtChange,n=this.FLAtDefault!==this.tempFLAtChange;if(this.L1AtDefault!==this.tempL1AtChange&&t.data.l1ID>0){const i={ID:t.data.l1ID,Point:t.data.l1},n=this.dataAtScorePicked.filter(e=>e.ID===t.data.l1ID);if(0===n.length)this.dataAtScorePicked.push(i);else for(const c of n)for(var e=0;e<n.length;e++)if(c.ID===t.data.l1ID){c.Point=t.data.l1;break}}if(i&&t.data.l2ID>0){const i={ID:t.data.l2ID,Point:t.data.l2},n=this.dataAtScorePicked.filter(e=>e.ID===t.data.l2ID);if(0===n.length)this.dataAtScorePicked.push(i);else for(const c of n)for(e=0;e<n.length;e++)if(c.ID===t.data.l2ID){c.Point=t.data.l2;break}}if(n&&t.data.flid>0){const i={ID:t.data.flid,Point:t.data.fl},n=this.dataAtScorePicked.filter(e=>e.ID===t.data.flid);if(0===n.length)this.dataAtScorePicked.push(i);else for(const c of n)for(e=0;e<n.length;e++)if(c.ID===t.data.flid){c.Point=t.data.fl;break}}}}actionCompleteAtScore(t){}actionBeginSpeScore(t){if("beginEdit"===t.requestType&&(this.SpeCommentDefault=t.rowData.comment),"save"===t.requestType&&(this.tempSpeChange=t.data.comment,(this.SpeCommentDefault.length<this.tempSpeChange.length||this.SpeCommentDefault.length>this.tempSpeChange.length)&&t.data.id>0)){const i={ID:t.data.id,Content:t.data.comment},n=this.dataSpeScorePicked.filter(e=>e.ID===t.data.id);if(0===n.length)this.dataSpeScorePicked.push(i);else for(const c of n)for(var e=0;e<n.length;e++)if(c.ID===t.data.id){c.Content=t.data.comment;break}}}actionCompleteSpeScore(t){}loadData(){this.service.getGHRData().subscribe(t=>{console.log(t),this.data=t})}openModal(t,e,i){this.userid=t.id,"H1"===i?this.getGHRReportH1Info(t.id):this.getGHRReportH2Info(t.id),this.modalRef=this.modalService.open(e,{size:"xl",backdrop:"static"}),this.modalRef.result.then(t=>{this.dataCommentPicked=[],this.dataAtScorePicked=[],this.dataSpeScorePicked=[]},t=>{this.dataCommentPicked=[],this.dataAtScorePicked=[],this.dataSpeScorePicked=[]})}getHalfYearSetting(){this.columns=[];for(const t of this.halfYearSettingsData)this.columns.push({field:`${t}`,headerText:this.getMonthListInCurrentQuarter(t),month:t})}getResultOfMonthData(){var t;this.Resultcolumns=[];for(const e of this.halfYearSettingsData)this.Resultcolumns.push({field:`${e}`,headerText:(null===(t=this.ResultOfMonthData.filter(t=>t.month===e)[0])||void 0===t?void 0:t.title)||"N/A",month:e})}getMonthListInCurrentQuarter(t){return["Jan.","Feb.","Mar.","Apr.","May.","Jun.","Jul.","Aug.","Sep.","Oct.","Nov.","Dec."][t-1]}save(){this.updateAtScore(),this.updateComment(),this.updateSpe(),this.alertify.success(v.a.CREATED_OK_MSG),this.clearData(),this.modalRef.close()}clearData(){this.dataCommentPicked=[],this.dataAtScorePicked=[],this.dataSpeScorePicked=[]}updateComment(){this.service.ReportUpdateComment(this.dataCommentPicked).subscribe(t=>{})}updateAtScore(){this.service.ReportUpdateAtScore(this.dataAtScorePicked).subscribe(t=>{})}updateSpe(){this.service.ReportUpdateSpe(this.dataSpeScorePicked).subscribe(t=>{})}getGHRReportH1Info(t){this.service.getGHRReportH1Info(t).subscribe(t=>{this.detailH1=t.h1,this.title="H1\uff1aQ1-Q2",this.titles="H1",this.detailH2=t.h2,this.kpicommentH1=t.kpicommentH1,this.attitudecommentData=t.attitudecomment,this.atScoreData=t.attitudeScore,this.kpiScoreData=t.kpiScore,this.specialScoreData=t.specialScore,this.halfYearSettingsData=t.dataObjectH1[0].settings||[],this.ResultOfMonthData=t.dataObjectH1[0].resultOfMonth||[],this.gridDataH1=t.dataObjectH1,this.avg=t.avg,this.h1Score=t.h1Score,this.dept=t.dept,this.name=t.name,this.getHalfYearSetting(),this.getResultOfMonthData()})}getGHRReportH2Info(t){this.service.getGHRReportH2Info(t).subscribe(t=>{this.detailH1=t.h1,this.title="H2\uff1aQ3-Q4",this.titles="H2",this.detailH2=t.h2,this.kpicommentH1=t.kpicommentH1,this.attitudecommentData=t.attitudecomment,this.atScoreData=t.attitudeScore,this.kpiScoreData=t.kpiScore,this.specialScoreData=t.specialScore,this.halfYearSettingsData=t.dataObjectH1[0].settings||[],this.ResultOfMonthData=t.dataObjectH1[0].resultOfMonth||[],this.gridDataH1=t.dataObjectH1,this.avg=t.avg,this.h1Score=t.h1Score,this.dept=t.dept,this.name=t.name,this.getHalfYearSetting(),this.getResultOfMonthData()})}exportExcel(){this.service.H1H2ExportExcel(this.userid).subscribe(t=>{new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});const e=window.URL.createObjectURL(t),i=document.createElement("a");i.href=e,i.download="H1,H2 Report \u5b63\u5831\u8868.xlsx",i.click()})}NO(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}return t.\u0275fac=function(e){return new(e||t)(f.Pb(I.b),f.Pb(V.a),f.Pb(S.c),f.Pb(U),f.Pb(H.a))},t.\u0275cmp=f.Jb({type:t,selectors:[["app-ghr-report"]],viewQuery:function(t,e){if(1&t&&(f.Mc(D,1),f.Mc(y,1)),2&t){let t;f.wc(t=f.gc())&&(e.grid=t.first),f.wc(t=f.gc())&&(e.detailModal=t.first)}},hostBindings:function(t,e){1&t&&f.fc("scroll",function(t){return e.onScroll(t)})},features:[f.zb],decls:25,vars:9,consts:[[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body","table-responsive","p-0"],["id","grid","gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","locale","toolbar","pageSettings","allowExcelExport","editSettings"],["grid",""],["field","ID","textAlign","Center","width","80","isPrimaryKey","true","headerText","#"],["template",""],["editTemplate",""],["field","oc","textAlign","Center","headerText","Dept."],["field","fullName","textAlign","Center","headerText","Name"],["field","score","textAlign","Center","headerText","Score"],["field","#","textAlign","Center","headerText","Option"],["detailH1Modal",""],["detailH2Modal",""],[1,"btn","btn-sm","btn-success",3,"click"],["top",""],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body",2,"font-size","15px"],[1,"col"],[1,"d-flex","justify-content-start"],["height","300px","allowTextWrap","true","gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","toolbar","pageSettings","allowExcelExport","queryCellInfo"],["field","#","headerText","#","textAlign","Center","width","30","type","number"],["field","objective","headerText","KPI Objective","type","string"],["field","l0TargetList","headerText","L0 Target","type","string"],["field","l0ActionList","headerText","L0 Action","type","string"],["field","l0ActionList","headerText","H1","textAlign","Center","width","100"],["field","l0ActionList","headerText","Result Of Month.","type","string"],["id","grid","allowTextWrap","true","gridLines","Both",3,"dataSource","allowResizing","showColumnMenu","editSettings","actionComplete","actionBegin","recordDoubleClick"],["gridKpicomment",""],["field","kpiComment","isPrimaryKey","true","headerText","KPI Comments","type","string"],["field","q1","headerText","Q1","type","string"],["field","q2","headerText","Q2","type","string"],["allowTextWrap","true","gridLines","Both",3,"allowResizing","editSettings","dataSource","showColumnMenu","actionComplete","actionBegin"],["field","attitudeComment","isPrimaryKey","true","headerText","Attitude Comments","type","string"],["field","h1","headerText","H1","type","string"],["allowTextWrap","true","gridLines","Both",3,"dataSource","editSettings","allowResizing","showColumnMenu","actionComplete","actionBegin"],["field","l1","textAlign","Center","headerText","L1","type","string"],["field","l2","textAlign","Center","headerText","L2","type","string"],["field","fl","textAlign","Center","headerText","Functional leader","type","string"],["allowTextWrap","true","gridLines","Both",3,"dataSource","allowResizing","showColumnMenu"],["field","self","textAlign","Center","headerText","Self","type","string"],["field","ghrSmartScore","headerText","GHR SMART Score","textAlign","Center","width","100"],["allowTextWrap","true","gridLines","Both",3,"allowResizing","dataSource","editSettings","showColumnMenu","actionComplete","actionBegin"],["field","score","headerText","Special score","type","string"],["field","comment","headerText","Special Contribution or Mistake (If any) \u91cd\u5927\u8ca2\u737b\u6216\u932f\u8aa4(\u5982\u6709)","type","string"],[1,"d-flex","justify-content-end"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],[2,"color","transparent"],[1,"btn","btn-outline-warning",3,"click"],[1,"fas","fa-chevron-up"],[2,"padding","0 0 0 8px"],[4,"ngFor","ngForOf"],["class","e-row",4,"ngFor","ngForOf"],[1,"e-row"],[1,"e-rowcell",2,"text-align","center"],[3,"ngClass"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["disabled","disabled","type","text","name","q1",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["type","text","name","q1",1,"e-field","e-input","e-defaultcell",3,"value"],["disabled","disabled","type","text","name","q2",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["type","text","name","q2",1,"e-field","e-input","e-defaultcell",3,"value"],["disabled","disabled","type","text","name","h1",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["type","text","name","h1",1,"e-field","e-input","e-defaultcell",3,"value"],["disabled","disabled","type","text","name","l1",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["type","text","name","l1",1,"e-field","e-input","e-defaultcell",3,"value"],["disabled","disabled","type","text","name","l2",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["type","text","name","l2",1,"e-field","e-input","e-defaultcell",3,"value"],["disabled","disabled","type","text","name","fl",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["type","text","name","fl",1,"e-field","e-input","e-defaultcell",3,"value"],["disabled","disabled","type","text","name","comment",1,"e-field","e-input","e-defaultcell",2,"text-align","Center",3,"value"],["type","text","name","comment",1,"e-field","e-input","e-defaultcell",3,"value"],["field","l0ActionList","headerText","H2","textAlign","Center","width","100"],["field","q1","headerText","Q3","type","string"],["field","q2","headerText","Q4","type","string"],["field","h1","headerText","H2","type","string"]],template:function(t,e){1&t&&(f.Vb(0,"div",0),f.Vb(1,"div",1),f.Vb(2,"div",2),f.Vb(3,"div",3),f.Vb(4,"h3",4),f.Ic(5,"GHR Report "),f.Ub(),f.Ub(),f.Vb(6,"div",5),f.Vb(7,"ejs-grid",6,7),f.Vb(9,"e-columns"),f.Vb(10,"e-column",8),f.Gc(11,Q,1,1,"ng-template",null,9,f.Hc),f.Gc(13,k,1,0,"ng-template",null,10,f.Hc),f.Ub(),f.Qb(15,"e-column",11),f.Qb(16,"e-column",12),f.Qb(17,"e-column",13),f.Vb(18,"e-column",14),f.Gc(19,A,5,0,"ng-template",null,9,f.Hc),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Gc(21,bt,121,34,"ng-template",null,15,f.Hc),f.Gc(23,Kt,121,34,"ng-template",null,16,f.Hc)),2&t&&(f.Cb(7),f.oc("dataSource",e.data)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("locale",e.locale)("toolbar",e.toolbarOptions)("pageSettings",e.pageSettings)("allowExcelExport",!0)("editSettings",e.editSettings))},directives:[s.g,s.d,s.b,x.d,x.b,w.d,s.c,s.a,x.c,x.a,w.c,c.l,c.k,c.m],styles:[".small-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{width:16%;text-align:center}.tooltip-kpi-table[_ngcontent-%COMP%]{display:none;transition:all .5s ease;position:absolute;left:0}.hover-box[_ngcontent-%COMP%]{position:relative}.hover-box[_ngcontent-%COMP%]:hover   .tooltip-kpi-table[_ngcontent-%COMP%]{display:block;background:#84c1ff;position:absolute;z-index:999}.tooltip-attitude-table[_ngcontent-%COMP%]{display:none;background:#84c1ff;position:absolute;left:0;z-index:999}.hover-box[_ngcontent-%COMP%]:hover   .tooltip-attitude-table[_ngcontent-%COMP%]{display:block;background:#84c1ff;position:absolute;z-index:999}"]}),t})();const qt=["grid"];function Jt(t,e){if(1&t&&f.Ic(0),2&t){const t=e.$implicit,i=f.ic();f.Kc(" ",i.NO(t.index)," ")}}function zt(t,e){1&t&&f.Ic(0," # ")}function Bt(t,e){1&t&&(f.Vb(0,"button",13),f.Ic(1,"Export"),f.Ub())}let Nt=(()=>{class t extends C.a{constructor(t,e,i,n){super(),this.modalService=t,this.alertify=e,this.service=i,this.route=n,this.data=[],this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.locale=localStorage.getItem("lang"),this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!1,allowAdding:!1,allowDeleting:!1,mode:"Normal"},this.toolbarOptions=["Search"]}ngOnInit(){this.loadData()}onDoubleClick(t){}actionBegin(t){}toolbarClick(t){switch(t.item.id){case"grid_excelexport":this.grid.excelExport({hierarchyExportMode:"All"})}}actionComplete(t){}loadData(){this.service.geH1H2Data().subscribe(t=>{this.data=t})}NO(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}return t.\u0275fac=function(e){return new(e||t)(f.Pb(I.b),f.Pb(V.a),f.Pb(U),f.Pb(H.a))},t.\u0275cmp=f.Jb({type:t,selectors:[["app-hq-hr-report"]],viewQuery:function(t,e){if(1&t&&f.Mc(qt,1),2&t){let t;f.wc(t=f.gc())&&(e.grid=t.first)}},features:[f.zb],decls:19,vars:9,consts:[[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body","table-responsive","p-0"],["id","grid","gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","locale","toolbar","pageSettings","allowExcelExport","editSettings"],["grid",""],["field","ID","textAlign","Center","width","80","isPrimaryKey","true","headerText","ID"],["template",""],["editTemplate",""],["field","fullName","textAlign","Center","headerText","Name"],["field","#","textAlign","Center","headerText","Option"],[1,"btn","btn-sm","btn-success"]],template:function(t,e){1&t&&(f.Vb(0,"div",0),f.Vb(1,"div",1),f.Vb(2,"div",2),f.Vb(3,"div",3),f.Vb(4,"h3",4),f.Ic(5," HQ HR Report \u5e74\u4e2d\u8003\u6838\u540d\u55ae "),f.Ub(),f.Ub(),f.Vb(6,"div",5),f.Vb(7,"ejs-grid",6,7),f.Vb(9,"e-columns"),f.Vb(10,"e-column",8),f.Gc(11,Jt,1,1,"ng-template",null,9,f.Hc),f.Gc(13,zt,1,0,"ng-template",null,10,f.Hc),f.Ub(),f.Qb(15,"e-column",11),f.Vb(16,"e-column",12),f.Gc(17,Bt,2,0,"ng-template",null,9,f.Hc),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub()),2&t&&(f.Cb(7),f.oc("dataSource",e.data)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("locale",e.locale)("toolbar",e.toolbarOptions)("pageSettings",e.pageSettings)("allowExcelExport",!0)("editSettings",e.editSettings))},directives:[s.g,s.d,s.b,x.d,x.b,w.d,s.c,s.a,x.c,x.a,w.c],styles:[""]}),t})();const jt=["grid"],Ft=["detailModal"];function Wt(t,e){if(1&t&&f.Ic(0),2&t){const t=e.$implicit,i=f.ic();f.Kc(" ",i.NO(t.index)," ")}}function Yt(t,e){1&t&&f.Ic(0," # ")}function Xt(t,e){if(1&t){const t=f.Wb();f.Vb(0,"button",14),f.fc("click",function(){f.Ac(t);const i=e.$implicit,n=f.ic(),c=f.xc(20);return n.openModal(i,c)}),f.Ic(1,"Detail"),f.Ub()}}function Zt(t,e){if(1&t){const t=f.Wb();f.Vb(0,"div",15),f.Vb(1,"h4",16),f.Qb(2,"i",17),f.Ic(3," H1 & H2 Report "),f.Ub(),f.Vb(4,"button",18),f.fc("click",function(){return e.$implicit.dismiss("Cross click")}),f.Vb(5,"span",19),f.Ic(6,"\xd7"),f.Ub(),f.Ub(),f.Ub(),f.Vb(7,"div",20),f.Vb(8,"div",21),f.Vb(9,"div",22),f.Vb(10,"div",0),f.Vb(11,"div",23),f.Ic(12,"\u7fd4\u946b\u5821\u5de5\u696d\u80a1\u4efd\u6709\u9650\u516c\u53f8\u7b2c\u4e8c\u4e8b\u696d\u90e8"),f.Ub(),f.Vb(13,"div",24),f.Ic(14,"\u5de5\u4f5c\u8003\u6838\u8868"),f.Ub(),f.Ub(),f.Ub(),f.Vb(15,"div",22),f.Vb(16,"div",0),f.Vb(17,"div",25),f.Ic(18),f.Ub(),f.Vb(19,"div",25),f.Ic(20),f.Ub(),f.Vb(21,"div",25),f.Ic(22,"Position:"),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Vb(23,"div",21),f.Vb(24,"div",22),f.Vb(25,"div",26),f.Vb(26,"span"),f.Ic(27,"H1\uff1aQ1-Q2"),f.Ub(),f.Ub(),f.Vb(28,"table",27),f.Vb(29,"tbody"),f.Vb(30,"tr"),f.Qb(31,"th",28),f.Qb(32,"th",28),f.Vb(33,"td"),f.Ic(34,"L1"),f.Ub(),f.Vb(35,"td"),f.Ic(36,"L2"),f.Ub(),f.Vb(37,"td"),f.Ic(38,"FL"),f.Ub(),f.Ub(),f.Vb(39,"tr"),f.Vb(40,"th",29),f.Ic(41," Attitude: 20 "),f.Vb(42,"table",30),f.Vb(43,"thead"),f.Vb(44,"tr"),f.Vb(45,"th",31),f.Ic(46,"\u5de5\u4f5c\u614b\u5ea6 = \u4e3b\u52d5\u7a4d\u6975 + \u6e9d\u901a\u53caEQ + \u914d\u5408\u5ea6"),f.Ub(),f.Vb(47,"th",31),f.Ic(48,"\u975e\u5e38\u597d 10 \u5206"),f.Ub(),f.Vb(49,"th",31),f.Ic(50,"\u8f03\u597d 8-9 \u5206"),f.Ub(),f.Vb(51,"th",31),f.Ic(52,"\u4e00\u822c 6-7 \u5206"),f.Ub(),f.Vb(53,"th",31),f.Ic(54,"\u8f03\u5dee 4-5 \u5206"),f.Ub(),f.Vb(55,"th",31),f.Ic(56,"\u6975\u5dee 3 \u5206\u4ee5\u4e0b"),f.Ub(),f.Ub(),f.Ub(),f.Vb(57,"tbody"),f.Vb(58,"tr"),f.Vb(59,"td"),f.Ic(60,"Attitude = Proactiveness + Communication & EQ + Cooperation"),f.Ub(),f.Vb(61,"td"),f.Ic(62,"Excellent 10 points"),f.Ub(),f.Vb(63,"td"),f.Ic(64,"Good 8-9 points"),f.Ub(),f.Vb(65,"td"),f.Ic(66,"Normal 6-7 points"),f.Ub(),f.Vb(67,"td"),f.Ic(68,"Not goo 4-5 points"),f.Ub(),f.Vb(69,"td"),f.Ic(70,"Poor 3 points or below"),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Vb(71,"th",28),f.Ic(72),f.Ub(),f.Vb(73,"td"),f.Ic(74),f.Ub(),f.Vb(75,"td"),f.Ic(76),f.Ub(),f.Vb(77,"td"),f.Ic(78),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Vb(79,"div",22),f.Vb(80,"div",26),f.Vb(81,"span"),f.Ic(82,"H2\uff1aQ3-Q4"),f.Ub(),f.Ub(),f.Vb(83,"table",27),f.Vb(84,"tbody"),f.Vb(85,"tr"),f.Qb(86,"th",28),f.Qb(87,"th",28),f.Vb(88,"td"),f.Ic(89,"L1 "),f.Ub(),f.Vb(90,"td"),f.Ic(91,"L2 "),f.Ub(),f.Vb(92,"td"),f.Ic(93,"FL "),f.Ub(),f.Ub(),f.Vb(94,"tr"),f.Vb(95,"th",28),f.Ic(96,"Attitude: 20"),f.Ub(),f.Vb(97,"th",28),f.Ic(98),f.Ub(),f.Vb(99,"td"),f.Ic(100),f.Ub(),f.Vb(101,"td"),f.Ic(102),f.Ub(),f.Vb(103,"td"),f.Ic(104),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Vb(105,"div",21),f.Vb(106,"div",1),f.Vb(107,"table",32),f.Vb(108,"thead"),f.Vb(109,"tr"),f.Vb(110,"th",33),f.Ic(111,"L0 Self-Evaluation"),f.Ub(),f.Vb(112,"th",34),f.Ic(113),f.Ub(),f.Vb(114,"th",33),f.Ic(115,"L0 Self-Evaluation"),f.Ub(),f.Vb(116,"th",34),f.Ic(117),f.Ub(),f.Ub(),f.Ub(),f.Vb(118,"tbody"),f.Vb(119,"tr"),f.Vb(120,"td",35),f.Ic(121,"L1 Comment"),f.Ub(),f.Vb(122,"td"),f.Ic(123),f.Ub(),f.Vb(124,"td",35),f.Ic(125,"L1 Comment"),f.Ub(),f.Vb(126,"td"),f.Ic(127),f.Ub(),f.Ub(),f.Vb(128,"tr"),f.Vb(129,"td"),f.Ic(130),f.Ub(),f.Vb(131,"td"),f.Ic(132),f.Ub(),f.Ub(),f.Vb(133,"tr"),f.Vb(134,"td"),f.Ic(135),f.Ub(),f.Vb(136,"td"),f.Ic(137),f.Ub(),f.Ub(),f.Vb(138,"tr"),f.Vb(139,"td",35),f.Ic(140,"L2 Comment"),f.Ub(),f.Vb(141,"td"),f.Ic(142),f.Ub(),f.Vb(143,"td",35),f.Ic(144,"L2 Comment"),f.Ub(),f.Vb(145,"td"),f.Ic(146),f.Ub(),f.Ub(),f.Vb(147,"tr"),f.Vb(148,"td"),f.Ic(149),f.Ub(),f.Vb(150,"td"),f.Ic(151),f.Ub(),f.Ub(),f.Vb(152,"tr"),f.Vb(153,"td"),f.Ic(154),f.Ub(),f.Vb(155,"td"),f.Ic(156),f.Ub(),f.Ub(),f.Vb(157,"tr"),f.Vb(158,"td"),f.Ic(159,"FL Comment"),f.Ub(),f.Vb(160,"td"),f.Ic(161),f.Ub(),f.Vb(162,"td"),f.Ic(163),f.Ub(),f.Vb(164,"td"),f.Ic(165),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Vb(166,"div",21),f.Vb(167,"div",22),f.Vb(168,"table",27),f.Vb(169,"tbody"),f.Vb(170,"tr"),f.Qb(171,"th",36),f.Qb(172,"th",36),f.Vb(173,"td"),f.Ic(174,"Self-Score (10)"),f.Ub(),f.Vb(175,"td"),f.Ic(176,"L1 (30)"),f.Ub(),f.Vb(177,"td"),f.Ic(178,"L2 (20)"),f.Ub(),f.Vb(179,"td"),f.Ic(180,"SMART (20)"),f.Ub(),f.Ub(),f.Vb(181,"tr"),f.Vb(182,"th",37),f.Ic(183,"KPI: 80 "),f.Vb(184,"table",38),f.Vb(185,"thead"),f.Vb(186,"tr"),f.Vb(187,"th",31),f.Ic(188,"5>= X >=4.5 \u8d85\u51fa\u9810\u671f"),f.Ub(),f.Vb(189,"th",31),f.Ic(190,"4.5> X >=4 \u7b26\u5408\u9810\u671f"),f.Ub(),f.Vb(191,"th",31),f.Ic(192,"4 > X >=3 \u5927\u90e8\u5206\u7b26\u5408\u9810\u671f"),f.Ub(),f.Vb(193,"th",31),f.Ic(194,"3> X >=2 \u90e8\u5206\u7b26\u5408\u9810\u671f"),f.Ub(),f.Vb(195,"th",31),f.Ic(196,"2> X >= 0 \u4e0d\u4f73\u4e0d\u7b26\u5408\u9810\u671f"),f.Ub(),f.Ub(),f.Ub(),f.Vb(197,"tbody"),f.Vb(198,"tr"),f.Vb(199,"td"),f.Ic(200,"Exceed expectation"),f.Ub(),f.Vb(201,"td"),f.Ic(202,"Meet expectation"),f.Ub(),f.Vb(203,"td"),f.Ic(204,"Mostly meet expectation"),f.Ub(),f.Vb(205,"td"),f.Ic(206,"Partly meet expectation"),f.Ub(),f.Vb(207,"td"),f.Ic(208,"Poorly or not meet expectation"),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Vb(209,"th",36),f.Ic(210),f.Ub(),f.Vb(211,"td"),f.Ic(212),f.Ub(),f.Vb(213,"td"),f.Ic(214),f.Ub(),f.Vb(215,"td"),f.Ic(216),f.Ub(),f.Vb(217,"td"),f.Ic(218),f.Ub(),f.Ub(),f.Vb(219,"tr"),f.Qb(220,"th",36),f.Qb(221,"th",36),f.Vb(222,"td"),f.Ic(223),f.Ub(),f.Vb(224,"td"),f.Ic(225),f.Ub(),f.Vb(226,"td"),f.Ic(227),f.Ub(),f.Vb(228,"td"),f.Ic(229),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Vb(230,"div",22),f.Vb(231,"table",27),f.Vb(232,"tbody"),f.Vb(233,"tr"),f.Qb(234,"th",36),f.Vb(235,"td"),f.Ic(236,"Self-Score (10)"),f.Ub(),f.Vb(237,"td"),f.Ic(238,"L1 (30)"),f.Ub(),f.Vb(239,"td"),f.Ic(240,"L2 (20)"),f.Ub(),f.Vb(241,"td"),f.Ic(242,"SMART (20)"),f.Ub(),f.Ub(),f.Vb(243,"tr"),f.Vb(244,"th",36),f.Ic(245),f.Ub(),f.Vb(246,"td"),f.Ic(247),f.Ub(),f.Vb(248,"td"),f.Ic(249),f.Ub(),f.Vb(250,"td"),f.Ic(251),f.Ub(),f.Vb(252,"td"),f.Ic(253),f.Ub(),f.Ub(),f.Vb(254,"tr"),f.Qb(255,"th",36),f.Vb(256,"td"),f.Ic(257),f.Ub(),f.Vb(258,"td"),f.Ic(259),f.Ub(),f.Vb(260,"td"),f.Ic(261),f.Ub(),f.Vb(262,"td"),f.Ic(263),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Vb(264,"div",21),f.Vb(265,"div",1),f.Vb(266,"table",32),f.Vb(267,"thead"),f.Vb(268,"tr"),f.Vb(269,"th",33),f.Ic(270,"Special contribution or mistake"),f.Ub(),f.Vb(271,"th",34),f.Vb(272,"tr"),f.Vb(273,"td"),f.Ic(274),f.Ub(),f.Vb(275,"td"),f.Ic(276),f.Ub(),f.Ub(),f.Ub(),f.Vb(277,"th",33),f.Ic(278,"Special contribution or mistake"),f.Ub(),f.Vb(279,"th",34),f.Vb(280,"tr"),f.Vb(281,"td"),f.Ic(282),f.Ub(),f.Vb(283,"td"),f.Ic(284),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Vb(285,"tr"),f.Vb(286,"th",33),f.Ic(287,"Special contribution or mistake comment"),f.Ub(),f.Vb(288,"span",39),f.Ic(289),f.Ub(),f.Vb(290,"th",33),f.Ic(291,"Special contribution or mistake comment"),f.Ub(),f.Vb(292,"span",39),f.Ic(293),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Vb(294,"div",21),f.Vb(295,"div",40),f.Vb(296,"p"),f.Ic(297),f.Ub(),f.Vb(298,"p"),f.Ic(299),f.Ub(),f.Ub(),f.Vb(300,"div",40),f.Vb(301,"span"),f.Ic(302),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Vb(303,"div",41),f.Vb(304,"button",42),f.fc("click",function(){return f.Ac(t),f.ic().exportExcel()}),f.Ic(305,"Export Excel"),f.Ub(),f.Vb(306,"button",43),f.fc("click",function(){return e.$implicit.close("Close click")}),f.Ic(307,"Close"),f.Ub(),f.Ub()}if(2&t){const t=f.ic();f.Cb(18),f.Kc("Dept. ",void 0!==t.detailH1?t.detailH1.oc:"",""),f.Cb(2),f.Kc("Name: ",void 0!==t.detailH1?t.detailH1.fullName:"",""),f.Cb(52),f.Kc("H1\u5f97\u5206: ",void 0!==t.detailH1?t.detailH1.a_total:"N/A",""),f.Cb(2),f.Jc(void 0!==t.detailH1?t.detailH1.l1Score:"N/A"),f.Cb(2),f.Jc(void 0!==t.detailH1?t.detailH1.l2Score:"N/A"),f.Cb(2),f.Jc(void 0!==t.detailH1?t.detailH1.flScore:"N/A"),f.Cb(20),f.Kc("H2\u5f97\u5206: ",void 0!==t.detailH2?t.detailH2.a_total:"N/A",""),f.Cb(2),f.Jc(void 0!==t.detailH2?t.detailH2.l1Score:"N/A"),f.Cb(2),f.Jc(void 0!==t.detailH2?t.detailH2.l2Score:"N/A"),f.Cb(2),f.Jc(void 0!==t.detailH2?t.detailH2.flScore:"N/A"),f.Cb(9),f.Kc("H1: ",void 0!==t.detailH1?t.detailH1.l0SelfScoreComment:"",""),f.Cb(4),f.Kc("H2: ",void 0!==t.detailH2?t.detailH2.l0SelfScoreComment:"",""),f.Cb(6),f.Kc("Q1 KPI: ",void 0!==t.detailH1?t.detailH1.l1Q1Comment:"",""),f.Cb(4),f.Kc("Q3 KPI: ",void 0!==t.detailH2?t.detailH2.l1Q1Comment:"",""),f.Cb(3),f.Kc("Q2 KPI: ",void 0!==t.detailH1?t.detailH1.l1Q2Comment:"",""),f.Cb(2),f.Kc("Q4 KPI: ",void 0!==t.detailH2?t.detailH2.l1Q2Comment:"",""),f.Cb(3),f.Kc("H1 Attitude: ",void 0!==t.detailH1?t.detailH1.l1HComment:"",""),f.Cb(2),f.Kc("H2 Attitude: ",void 0!==t.detailH2?t.detailH2.l1HComment:"",""),f.Cb(5),f.Kc("Q1 KPI: ",void 0!==t.detailH1?t.detailH1.l2Q1Comment:"",""),f.Cb(4),f.Kc("Q3 KPI: ",void 0!==t.detailH2?t.detailH2.l2Q1Comment:"",""),f.Cb(3),f.Kc("Q2 KPI: ",void 0!==t.detailH1?t.detailH1.l2Q2Comment:"",""),f.Cb(2),f.Kc("Q4 KPI: ",void 0!==t.detailH2?t.detailH2.l2Q2Comment:"",""),f.Cb(3),f.Kc("H1 Attitude: ",void 0!==t.detailH1?t.detailH1.l2HComment:"",""),f.Cb(2),f.Kc("H2 Attitude: ",void 0!==t.detailH2?t.detailH2.l2HComment:"",""),f.Cb(5),f.Kc("H1 Attitude: ",void 0!==t.detailH1?t.detailH1.flhComment:"",""),f.Cb(2),f.Kc("FL Comment: ","",""),f.Cb(2),f.Kc("H2 Attitude: ",void 0!==t.detailH2?t.detailH2.flhComment:"",""),f.Cb(45),f.Kc("H1\u5f97\u5206: ",void 0!==t.detailH1?t.detailH1.b_total:0,""),f.Cb(2),f.Jc(void 0!==t.detailH1?t.detailH1.selfScore:0),f.Cb(2),f.Jc(void 0!==t.detailH1?t.detailH1.l1:0),f.Cb(2),f.Jc(void 0!==t.detailH1?t.detailH1.l2:0),f.Cb(2),f.Jc(void 0!==t.detailH1?t.detailH1.smart:0),f.Cb(5),f.Jc(void 0!==t.detailH1?t.detailH1.b_selfScore:0),f.Cb(2),f.Jc(void 0!==t.detailH1?t.detailH1.b_L1:0),f.Cb(2),f.Jc(void 0!==t.detailH1?t.detailH1.b_L2:0),f.Cb(2),f.Jc(void 0!==t.detailH1?t.detailH1.b_Smart:0),f.Cb(16),f.Kc("H2\u5f97\u5206: ",void 0!==t.detailH2?t.detailH2.b_total:0,""),f.Cb(2),f.Jc(void 0!==t.detailH2?t.detailH2.selfScore:0),f.Cb(2),f.Jc(void 0!==t.detailH2?t.detailH2.l1:0),f.Cb(2),f.Jc(void 0!==t.detailH2?t.detailH2.l2:0),f.Cb(2),f.Jc(void 0!==t.detailH2?t.detailH2.smart:0),f.Cb(4),f.Jc(void 0!==t.detailH2?t.detailH2.b_selfScore:0),f.Cb(2),f.Jc(void 0!==t.detailH2?t.detailH2.b_L1:0),f.Cb(2),f.Jc(void 0!==t.detailH2?t.detailH2.b_L2:0),f.Cb(2),f.Jc(void 0!==t.detailH2?t.detailH2.b_Smart:0),f.Cb(11),f.Kc("H1: ",void 0!==t.detailH1?t.detailH1.c_total:0,""),f.Cb(2),f.Jc(void 0!==t.detailH1?t.detailH1.specialScore:0),f.Cb(6),f.Kc("H2: ",void 0!==t.detailH2?t.detailH2.c_total:0,""),f.Cb(2),f.Jc(void 0!==t.detailH2?t.detailH2.specialScore:0),f.Cb(5),f.Kc(" ",void 0!==t.detailH1?t.detailH1.specialComment:""," "),f.Cb(4),f.Kc(" ",void 0!==t.detailH2?t.detailH2.specialComment:""," "),f.Cb(4),f.Kc("H1\u5f97\u5206: ",void 0!==t.detailH1?t.detailH1.d_total:0,""),f.Cb(2),f.Kc("\u5e74\u5ea6\u5f97\u5206: ",t.avg,""),f.Cb(3),f.Kc("H2\u5f97\u5206: ",void 0!==t.detailH2?t.detailH2.d_total:0,"")}}let te=(()=>{class t extends C.a{constructor(t,e,i,n,c){super(),this.modalService=t,this.alertify=e,this.spinner=i,this.service=n,this.route=c,this.data=[],this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.locale=localStorage.getItem("lang"),this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!1,allowAdding:!1,allowDeleting:!1,mode:"Normal"},this.toolbarOptions=["Search"],this.avg=0}ngAfterViewInit(){}ngOnInit(){this.loadData()}loadData(){this.service.getQ1Q3Data().subscribe(t=>{this.data=t})}openModal(t,e){this.userid=t.id,this.getH1H2ReportInfo(t.id),this.modalRef=this.modalService.open(e,{size:"xl",backdrop:"static"})}getH1H2ReportInfo(t){this.service.getH1H2ReportInfo(t).subscribe(t=>{this.detailH1=t.h1,this.detailH2=t.h2,this.avg=t.avg})}exportExcel(){this.service.H1H2ExportExcel(this.userid).subscribe(t=>{new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});const e=window.URL.createObjectURL(t),i=document.createElement("a");i.href=e,i.download="H1,H2 Report \u5b63\u5831\u8868.xlsx",i.click()})}NO(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}return t.\u0275fac=function(e){return new(e||t)(f.Pb(I.b),f.Pb(V.a),f.Pb(S.c),f.Pb(U),f.Pb(H.a))},t.\u0275cmp=f.Jb({type:t,selectors:[["app-h1-h2-report"]],viewQuery:function(t,e){if(1&t&&(f.Mc(jt,1),f.Mc(Ft,1)),2&t){let t;f.wc(t=f.gc())&&(e.grid=t.first),f.wc(t=f.gc())&&(e.detailModal=t.first)}},features:[f.zb],decls:21,vars:9,consts:[[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body","table-responsive","p-0"],["id","grid","gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","locale","toolbar","pageSettings","allowExcelExport","editSettings"],["grid",""],["field","ID","textAlign","Center","width","80","isPrimaryKey","true","headerText","ID"],["template",""],["editTemplate",""],["field","fullName","textAlign","Center","headerText","Name"],["field","#","textAlign","Center","headerText","Option"],["detailModal",""],[1,"btn","btn-sm","btn-success",3,"click"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"row","mb-2"],[1,"col-md-6"],[1,"col-md-7"],[1,"col-md-5"],[1,"col"],[1,"d-flex","justify-content-end"],[1,"table","table-bordered","small-table"],["scope","row","colspan","2"],["scope","row","colspan","2",1,"hover-box"],[1,"table","table-bordered","tooltip-attitude-table",2,"width","800px"],["scope","col"],[1,"table","table-bordered"],["scope","col",2,"width","10%"],["scope","col",2,"width","40%"],["rowspan","3"],["scope","row","colspan","3"],["scope","row","colspan","3",1,"hover-box"],[1,"table","table-bordered","tooltip-kpi-table",2,"width","800px"],[2,"vertical-align","top"],[1,"col-md-6","text-center"],[1,"modal-footer"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(t,e){1&t&&(f.Vb(0,"div",0),f.Vb(1,"div",1),f.Vb(2,"div",2),f.Vb(3,"div",3),f.Vb(4,"h3",4),f.Ic(5,"H1 & H2 Report "),f.Ub(),f.Ub(),f.Vb(6,"div",5),f.Vb(7,"ejs-grid",6,7),f.Vb(9,"e-columns"),f.Vb(10,"e-column",8),f.Gc(11,Wt,1,1,"ng-template",null,9,f.Hc),f.Gc(13,Yt,1,0,"ng-template",null,10,f.Hc),f.Ub(),f.Qb(15,"e-column",11),f.Vb(16,"e-column",12),f.Gc(17,Xt,2,0,"ng-template",null,9,f.Hc),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Gc(19,Zt,308,54,"ng-template",null,13,f.Hc)),2&t&&(f.Cb(7),f.oc("dataSource",e.data)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("locale",e.locale)("toolbar",e.toolbarOptions)("pageSettings",e.pageSettings)("allowExcelExport",!0)("editSettings",e.editSettings))},directives:[s.g,s.d,s.b,x.d,x.b,w.d,s.c,s.a,x.c,x.a,w.c],styles:[".small-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{width:16%;text-align:center}.tooltip-kpi-table[_ngcontent-%COMP%]{display:none;transition:all .5s ease;position:absolute;left:0}.hover-box[_ngcontent-%COMP%]{position:relative}.hover-box[_ngcontent-%COMP%]:hover   .tooltip-kpi-table[_ngcontent-%COMP%]{display:block;background:#84c1ff;position:absolute;z-index:999}.tooltip-attitude-table[_ngcontent-%COMP%]{display:none;background:#84c1ff;position:absolute;left:0;z-index:999}.hover-box[_ngcontent-%COMP%]:hover   .tooltip-attitude-table[_ngcontent-%COMP%]{display:block;background:#84c1ff;position:absolute;z-index:999}"]}),t})();const ee=["will-change",""],ie=[[["","pIcon",""],["","p-icon",""],["","pSvg",""],["","p-svg",""],["","pImage",""],["","p-image",""]],"*"],ne=["[pIcon], [p-icon], [pSvg], [p-svg], [pImage], [p-image]","*"],ce=["inputElem"],oe=["stateElem"];function le(t,e){1&t&&(f.Vb(0,"div",3,4),f.mc(2,1),f.Vb(3,"label"),f.mc(4,2),f.Ub(),f.Ub())}const ae=[[["ngx-p-indeterminate"],["p-indeterminate"],["ngx-p-hover"],["p-hover"],["ngx-p-toggle"],["p-toggle"]],[["","pIcon",""],["","p-icon",""],["","pSvg",""],["","p-svg",""],["","pImage",""],["","p-image",""]],"*"],re=["ngx-p-indeterminate, p-indeterminate, ngx-p-hover, p-hover, ngx-p-toggle, p-toggle","[pIcon], [p-icon], [pSvg], [p-svg], [pImage], [p-image]","*"];let be=(()=>{class t{constructor(t){this.elemRef=t,this.elemRef.nativeElement.classList.add("icon")}}return t.\u0275fac=function(e){return new(e||t)(f.Pb(f.l))},t.\u0275dir=f.Kb({type:t,selectors:[["","pIcon",""],["","p-icon",""]]}),t})(),se=(()=>{class t{constructor(t){this.elemRef=t,this.elemRef.nativeElement.classList.add("image")}}return t.\u0275fac=function(e){return new(e||t)(f.Pb(f.l))},t.\u0275dir=f.Kb({type:t,selectors:[["","pImage",""],["","p-image",""]]}),t})(),de=(()=>{class t{constructor(t){this.elemRef=t}ngAfterViewInit(){this.elemRef.nativeElement.classList.add("svg")}}return t.\u0275fac=function(e){return new(e||t)(f.Pb(f.l))},t.\u0275dir=f.Kb({type:t,selectors:[["","pSvg",""],["","p-svg",""]]}),t})();var ue=function(t){return t.On="on",t.Off="off",t}({});function pe(t,e){return t?"p-"+t+(e?"-o":""):null}function he(t){return"boolean"==typeof t?t:/^\s*(true|1|on|enable)\s*$/i.test(t)}let ge=(()=>{class t{constructor(t,e){this.el=t,this.renderer=e,this.outline=!1}ngOnChanges(t){if(t.color||t.outline){const e=pe(t.color?t.color.previousValue:this.color,t.outline?t.outline.previousValue:null),i=pe(t.color?t.color.currentValue:this.color,t.outline?t.outline.currentValue:null);this.renderer.removeClass(this.el.nativeElement,e),this.renderer.addClass(this.el.nativeElement,i)}}}return t.\u0275fac=function(e){return new(e||t)(f.Pb(f.l),f.Pb(f.E))},t.\u0275cmp=f.Jb({type:t,selectors:[["ngx-p-hover","will-change",""],["p-hover","will-change",""]],hostAttrs:[1,"state","p-is-hover"],inputs:{outline:"outline",color:"color"},features:[f.Ab],attrs:ee,ngContentSelectors:ne,decls:3,vars:0,template:function(t,e){1&t&&(f.nc(ie),f.mc(0),f.Vb(1,"label"),f.mc(2,1),f.Ub())},encapsulation:2,changeDetection:0}),t})(),me=(()=>{class t{constructor(t,e,i=!1,n){this.el=t,this.renderer=e,this._outline=i,this._color=n}ngAfterViewInit(){this._color&&this.renderer.addClass(this.el.nativeElement,`p-${this._color}${this._outline?"-o":""}`)}}return t.\u0275fac=function(e){return new(e||t)(f.Pb(f.l),f.Pb(f.E),f.dc("outline"),f.dc("color"))},t.\u0275cmp=f.Jb({type:t,selectors:[["ngx-p-hover",3,"will-change",""],["p-hover",3,"will-change",""]],hostAttrs:[1,"state","p-is-hover"],ngContentSelectors:ne,decls:3,vars:0,template:function(t,e){1&t&&(f.nc(ie),f.mc(0),f.Vb(1,"label"),f.mc(2,1),f.Ub())},encapsulation:2,changeDetection:0}),t})(),fe=(()=>{class t{constructor(t,e){this.el=t,this.renderer=e,this.outline=!1}ngOnChanges(t){if(t.color||t.outline){const e=pe(t.color?t.color.previousValue:this.color,t.outline?t.outline.previousValue:null),i=pe(t.color?t.color.currentValue:this.color,t.outline?t.outline.currentValue:null);this.renderer.removeClass(this.el.nativeElement,e),this.renderer.addClass(this.el.nativeElement,i)}}}return t.\u0275fac=function(e){return new(e||t)(f.Pb(f.l),f.Pb(f.E))},t.\u0275cmp=f.Jb({type:t,selectors:[["ngx-p-indeterminate","will-change",""],["p-indeterminate","will-change",""]],hostAttrs:[1,"state","p-is-indeterminate"],inputs:{outline:"outline",color:"color"},features:[f.Ab],attrs:ee,ngContentSelectors:ne,decls:3,vars:0,template:function(t,e){1&t&&(f.nc(ie),f.mc(0),f.Vb(1,"label"),f.mc(2,1),f.Ub())},encapsulation:2,changeDetection:0}),t})(),Ue=(()=>{class t{constructor(t,e,i=!1,n){this.el=t,this.renderer=e,this._outline=i,this._color=n}ngAfterViewInit(){this._color&&this.renderer.addClass(this.el.nativeElement,`p-${this._color}${this._outline?"-o":""}`)}}return t.\u0275fac=function(e){return new(e||t)(f.Pb(f.l),f.Pb(f.E),f.dc("outline"),f.dc("color"))},t.\u0275cmp=f.Jb({type:t,selectors:[["ngx-p-indeterminate",3,"will-change",""],["p-indeterminate",3,"will-change",""]],hostAttrs:[1,"state","p-is-indeterminate"],ngContentSelectors:ne,decls:3,vars:0,template:function(t,e){1&t&&(f.nc(ie),f.mc(0),f.Vb(1,"label"),f.mc(2,1),f.Ub())},encapsulation:2,changeDetection:0}),t})(),Ce=(()=>{class t{constructor(t,e){this.el=t,this.renderer=e,this.outline=!1}get isToggleOn(){return this.type===ue.On}get isToggleOff(){return this.type===ue.Off}ngOnChanges(t){if(t.color||t.outline){const e=pe(t.color?t.color.previousValue:this.color,t.outline?t.outline.previousValue:null),i=pe(t.color?t.color.currentValue:this.color,t.outline?t.outline.currentValue:null);this.renderer.removeClass(this.el.nativeElement,e),this.renderer.addClass(this.el.nativeElement,i)}}}return t.\u0275fac=function(e){return new(e||t)(f.Pb(f.l),f.Pb(f.E))},t.\u0275cmp=f.Jb({type:t,selectors:[["ngx-p-toggle","will-change",""],["p-toggle","will-change",""]],hostAttrs:[1,"state"],hostVars:4,hostBindings:function(t,e){2&t&&f.Hb("p-on",e.isToggleOn)("p-off",e.isToggleOff)},inputs:{outline:"outline",type:"type",color:"color"},features:[f.Ab],attrs:ee,ngContentSelectors:ne,decls:3,vars:0,template:function(t,e){1&t&&(f.nc(ie),f.mc(0),f.Vb(1,"label"),f.mc(2,1),f.Ub())},encapsulation:2,changeDetection:0}),t})(),Ve=(()=>{class t{constructor(t,e,i=!1,n,c){this.el=t,this.renderer=e,this._outline=i,this._color=n,this._type=c}ngAfterViewInit(){this._color&&this.renderer.addClass(this.el.nativeElement,`p-${this._color}${this._outline?"-o":""}`),this.renderer.addClass(this.el.nativeElement,`p-${this._type}`)}}return t.\u0275fac=function(e){return new(e||t)(f.Pb(f.l),f.Pb(f.E),f.dc("outline"),f.dc("color"),f.dc("type"))},t.\u0275cmp=f.Jb({type:t,selectors:[["ngx-p-toggle",3,"will-change",""],["p-toggle",3,"will-change",""]],hostAttrs:[1,"state"],ngContentSelectors:ne,decls:3,vars:0,template:function(t,e){1&t&&(f.nc(ie),f.mc(0),f.Vb(1,"label"),f.mc(2,1),f.Ub())},encapsulation:2,changeDetection:0}),t})(),ve=(()=>{class t{constructor(t,e,i,n,c,o,l=!1,a=!1,r=!1,b=!1,s=!1,d){this.renderer=t,this.el=e,this.cd=i,this._stroke=n,this._shape=c,this._animation=o,this._isSwitch=l,this._bigger=a,this._enableFocus=r,this._plain=b,this._outline=s,this._color=d,this.checked=!1,this.disabled=!1,this.lock=!1,this.change=new f.n,this._isSwitch=he(this._isSwitch),this._bigger=he(this._bigger),this._enableFocus=he(this._enableFocus),this._plain=he(this._plain),this._outline=he(this._outline)}ngAfterViewInit(){const t=this.el.nativeElement;this._isSwitch&&this.renderer.addClass(t,"p-switch"),this._bigger&&this.renderer.addClass(t,"p-bigger"),this._enableFocus&&this.renderer.addClass(t,"p-has-focus"),this._plain&&this.renderer.addClass(t,"p-plain"),this._stroke&&this.renderer.addClass(t,`p-${this._stroke}`),this._shape&&this.renderer.addClass(t,`p-${this._shape}`),this._animation&&this.renderer.addClass(t,`p-${this._animation}`),this._iconDir&&this.renderer.addClass(t,"p-icon"),this._svgDir&&this.renderer.addClass(t,"p-svg"),this._imgDir&&this.renderer.addClass(t,"p-image"),(this._hoverDir||this._hoverWillChangeDir)&&this.renderer.addClass(t,"p-has-hover"),(this._indeterminateDir||this._indeterminateWillChangeDir)&&this.renderer.addClass(t,"p-has-indeterminate"),this._isToggle&&this.renderer.addClass(t,"p-toggle"),this._isSwitch||this._iconDir||this._svgDir||this._imgDir||this.renderer.addClass(t,"p-default"),this._color&&!this._isToggle&&this.renderer.addClass(this._stateElem.nativeElement,`p-${this._color}${this._outline?"-o":""}`)}_onChange(t,e,i){t.stopPropagation(),this.checked=e,this.change.emit({value:i,checked:e,event:t})}get _isToggle(){return 2===this._toggleComps.length||2===this._toggleWillChangeComps.length}setIndeterminate(t=!0){this._inputElem.nativeElement.indeterminate=t}forceCheck(t){this.checked=t,this.cd.markForCheck()}}return t.\u0275fac=function(e){return new(e||t)(f.Pb(f.E),f.Pb(f.l),f.Pb(f.h),f.dc("stroke"),f.dc("shape"),f.dc("animation"),f.dc("isSwitch"),f.dc("bigger"),f.dc("enableFocus"),f.dc("plain"),f.dc("outline"),f.dc("color"))},t.\u0275cmp=f.Jb({type:t,selectors:[["ngx-pretty-checkbox",3,"will-change",""],["p-checkbox",3,"will-change",""]],contentQueries:function(t,e,i){if(1&t&&(f.Ib(i,be,1),f.Ib(i,de,1),f.Ib(i,se,1),f.Ib(i,me,1),f.Ib(i,ge,1),f.Ib(i,Ue,1),f.Ib(i,fe,1),f.Ib(i,Ve,0),f.Ib(i,Ce,0)),2&t){let t;f.wc(t=f.gc())&&(e._iconDir=t.first),f.wc(t=f.gc())&&(e._svgDir=t.first),f.wc(t=f.gc())&&(e._imgDir=t.first),f.wc(t=f.gc())&&(e._hoverDir=t.first),f.wc(t=f.gc())&&(e._hoverWillChangeDir=t.first),f.wc(t=f.gc())&&(e._indeterminateDir=t.first),f.wc(t=f.gc())&&(e._indeterminateWillChangeDir=t.first),f.wc(t=f.gc())&&(e._toggleComps=t),f.wc(t=f.gc())&&(e._toggleWillChangeComps=t)}},viewQuery:function(t,e){if(1&t&&(f.Mc(ce,3),f.Mc(oe,1)),2&t){let t;f.wc(t=f.gc())&&(e._inputElem=t.first),f.wc(t=f.gc())&&(e._stateElem=t.first)}},hostAttrs:[1,"pretty"],hostVars:2,hostBindings:function(t,e){2&t&&f.Hb("p-locked",e.lock)},inputs:{checked:"checked",disabled:"disabled",lock:"lock",value:"value"},outputs:{change:"change"},exportAs:["ngxPrettyCheckbox"],ngContentSelectors:re,decls:4,vars:4,consts:[["type","checkbox",3,"value","checked","disabled","change"],["inputElem",""],["class","state",4,"ngIf"],[1,"state"],["stateElem",""]],template:function(t,e){if(1&t){const t=f.Wb();f.nc(ae),f.Vb(0,"input",0,1),f.fc("change",function(i){f.Ac(t);const n=f.xc(1);return e._onChange(i,n.checked,n.value)}),f.Ub(),f.Gc(2,le,5,0,"div",2),f.mc(3)}2&t&&(f.oc("value",e.value)("checked",e.checked)("disabled",e.disabled),f.Cb(2),f.oc("ngIf",!e._isToggle))},directives:[c.m],encapsulation:2}),t})(),Ie=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=f.Nb({type:t}),t.\u0275inj=f.Mb({imports:[[c.c,o.b]]}),t})();const Se=["grid"],He=["detailModal"];function xe(t,e){if(1&t){const t=f.Wb();f.Vb(0,"span",13),f.Vb(1,"button",23),f.fc("click",function(){return f.Ac(t),f.ic().exportExcel()}),f.Ic(2,"Export Excel"),f.Ub(),f.Ub()}}function we(t,e){if(1&t&&(f.Vb(0,"tr"),f.Vb(1,"td"),f.Ic(2),f.Ub(),f.Vb(3,"td"),f.Ic(4),f.Ub(),f.Vb(5,"td",25),f.Ic(6),f.Ub(),f.Vb(7,"td"),f.Ic(8),f.Ub(),f.Vb(9,"td",25),f.Ic(10),f.Ub(),f.Vb(11,"td"),f.Ic(12),f.Ub(),f.Vb(13,"td",25),f.Ic(14),f.Ub(),f.Ub()),2&t){const t=e.$implicit;f.Cb(2),f.Jc(null==t?null:t.oc),f.Cb(2),f.Jc(null==t?null:t.fullName),f.Cb(2),f.Jc(null==t?null:t.l1Score),f.Cb(2),f.Jc(null==t?null:t.l1Comment),f.Cb(2),f.Jc(null==t?null:t.l2Score),f.Cb(2),f.Jc(null==t?null:t.l2Comment),f.Cb(2),f.Jc(null==t?null:t.smartScore)}}function De(t,e){if(1&t&&(f.Tb(0),f.Gc(1,we,15,7,"tr",24),f.Sb()),2&t){const t=f.ic();f.Cb(1),f.oc("ngForOf",t.detail)}}function ye(t,e){1&t&&(f.Vb(0,"tr"),f.Ic(1," No records "),f.Ub())}function Qe(t,e){if(1&t){const t=f.Wb();f.Vb(0,"div",26),f.Vb(1,"h4",27),f.Qb(2,"i",28),f.Ic(3," Q1, Q3 report "),f.Ub(),f.Vb(4,"button",29),f.fc("click",function(){return e.$implicit.dismiss("Cross click")}),f.Vb(5,"span",30),f.Ic(6,"\xd7"),f.Ub(),f.Ub(),f.Ub(),f.Vb(7,"div",5),f.Vb(8,"div",0),f.Vb(9,"div",10),f.Vb(10,"span",11),f.Ic(11," \u4eba\u4e8b\u5b63\u5831\u8868 "),f.Ub(),f.Ub(),f.Vb(12,"div",12),f.Vb(13,"span",11),f.Ic(14),f.Ub(),f.Vb(15,"span",13),f.Ic(16," \u5ee0\u5340 SHC "),f.Ub(),f.Vb(17,"span",13),f.Ic(18),f.Ub(),f.Ub(),f.Vb(19,"div",1),f.Vb(20,"table",17),f.Vb(21,"thead"),f.Vb(22,"tr"),f.Vb(23,"th",18),f.Ic(24,"\u90e8\u9580\u55ae\u4f4d Dept."),f.Ub(),f.Vb(25,"th",18),f.Ic(26,"\u59d3\u540d Full Name"),f.Ub(),f.Vb(27,"th",19),f.Ic(28,"\u76f4\u5c6c\u4e3b\u7ba1\u8a55\u5206 L1 score"),f.Ub(),f.Vb(29,"th",18),f.Ic(30,"\u76f4\u5c6c\u4e3b\u7ba1\u8a55\u8a9e L1 comment"),f.Ub(),f.Vb(31,"th",19),f.Ic(32,"\u4e8c\u968e\u4e3b\u7ba1\u8a55\u5206 L2 score"),f.Ub(),f.Vb(33,"th",18),f.Ic(34,"\u4e8c\u968e\u4e3b\u7ba1\u8a55\u8a9e L2 comment"),f.Ub(),f.Vb(35,"th",19),f.Ic(36,"SMART \u5206\u6578"),f.Ub(),f.Ub(),f.Ub(),f.Vb(37,"tbody"),f.Vb(38,"tr"),f.Vb(39,"td"),f.Ic(40),f.Ub(),f.Vb(41,"td"),f.Ic(42),f.Ub(),f.Vb(43,"td",25),f.Ic(44),f.Ub(),f.Vb(45,"td"),f.Ic(46),f.Ub(),f.Vb(47,"td",25),f.Ic(48),f.Ub(),f.Vb(49,"td"),f.Ic(50),f.Ub(),f.Vb(51,"td",25),f.Ic(52),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Vb(53,"div",31),f.Vb(54,"button",23),f.fc("click",function(){return f.Ac(t),f.ic().exportExcel()}),f.Ic(55,"Export Excel"),f.Ub(),f.Vb(56,"button",32),f.fc("click",function(){return e.$implicit.close("Close click")}),f.Ic(57,"Close"),f.Ub(),f.Ub()}if(2&t){const t=f.ic();f.Cb(14),f.Kc(" \u5e74\u5ea6 ",(null==t.detail?null:t.detail.year)||2021," "),f.Cb(4),f.Kc(" \u5b63\u5ea6 Quarter Q",(null==t.detail?null:t.detail.quarter)||0," "),f.Cb(22),f.Jc(null==t.detail?null:t.detail.oc),f.Cb(2),f.Jc(null==t.detail?null:t.detail.fullName),f.Cb(2),f.Jc(null==t.detail?null:t.detail.l1Score),f.Cb(2),f.Jc(null==t.detail?null:t.detail.l1Comment),f.Cb(2),f.Jc(null==t.detail?null:t.detail.l2Score),f.Cb(2),f.Jc(null==t.detail?null:t.detail.l2Comment),f.Cb(2),f.Jc(null==t.detail?null:t.detail.smartScore)}}const ke=[{path:"",data:{title:"",breadcrumb:"System"},children:[{path:"q1-q3-report",component:(()=>{class t extends C.a{constructor(t,e,i,n,c){super(),this.modalService=t,this.alertify=e,this.service=i,this.datePipe=n,this.route=c,this.data=[],this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.locale=localStorage.getItem("lang"),this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!1,allowAdding:!1,allowDeleting:!1,mode:"Normal"},this.toolbarOptions=["Search"]}ngOnInit(){this.currentTime=new Date,this.loadData()}onChangeReportTime(t){this.loadData()}openModal(t){this.itemData=t,this.getQ1Q3ReportInfo(t.id),this.modalService.open(this.detailModal,{size:"xl",backdrop:"static"}).result.then(t=>{},t=>{})}toolbarClick(t){switch(t.item.id){case"grid_excelexport":this.grid.excelExport({hierarchyExportMode:"All"})}}exportExcel(){this.service.q1q3ExportExcelByLeo(this.currentTimeRequest).subscribe(t=>{new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});const e=window.URL.createObjectURL(t),i=document.createElement("a");i.href=e,i.download="Q1,Q3 Report \u5b63\u5831\u8868.xlsx",i.click()})}loadData(){this.currentTimeRequest=this.datePipe.transform(this.currentTime,"YYYY-MM-dd HH:mm"),this.service.getQ1Q3DataByLeo(this.currentTimeRequest).subscribe(t=>{this.detail=t.data,console.log(this.detail),this.currentquater=t.currentQuarter})}getQ1Q3ReportInfo(t){this.service.getQ1Q3ReportInfo(t).subscribe(t=>{this.detail=t})}NO(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}return t.\u0275fac=function(e){return new(e||t)(f.Pb(I.b),f.Pb(V.a),f.Pb(U),f.Pb(c.e),f.Pb(H.a))},t.\u0275cmp=f.Jb({type:t,selectors:[["app-q1-q3-report"]],viewQuery:function(t,e){if(1&t&&(f.Mc(Se,1),f.Mc(He,1)),2&t){let t;f.wc(t=f.gc())&&(e.grid=t.first),f.wc(t=f.gc())&&(e.detailModal=t.first)}},features:[f.Bb([c.e]),f.zb],decls:58,vars:7,consts:[[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"modal-body"],[1,"col-md-3","d-flex","justify-content-center"],[1,"form-group"],["for","exampleInputEmail1"],[2,"width","100%",3,"ngModel","ngModelChange","valueChange"],[1,"col-md-12","text-center","py-2"],[2,"font-size","x-large"],[1,"col-md-12","d-flex","justify-content-start","py-2"],[2,"font-size","x-large","margin-left","20px"],["shape","round","color","success","lock","true",3,"checked"],["p-icon","",1,"material-icons"],["style","font-size: x-large;margin-left: 20px",4,"ngIf"],[1,"table","table-bordered"],["scope","col"],["scope","col",2,"width","10%"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["detailModal",""],["type","button",1,"btn","btn-primary",3,"click"],[4,"ngFor","ngForOf"],[2,"text-align","center"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-footer"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(t,e){if(1&t&&(f.Vb(0,"div",0),f.Vb(1,"div",1),f.Vb(2,"div",2),f.Vb(3,"div",3),f.Vb(4,"h3",4),f.Ic(5," Q1,Q3 Report \u5b63\u5831\u8868 "),f.Ub(),f.Ub(),f.Vb(6,"div",5),f.Vb(7,"div",0),f.Vb(8,"div",6),f.Vb(9,"div",7),f.Vb(10,"label",8),f.Ic(11,"Change System Date"),f.Ub(),f.Vb(12,"kendo-datepicker",9),f.fc("ngModelChange",function(t){return e.currentTime=t})("valueChange",function(t){return e.onChangeReportTime(t)}),f.Ub(),f.Ub(),f.Ub(),f.Vb(13,"div",10),f.Vb(14,"span",11),f.Ic(15," \u4eba\u4e8b\u5b63\u5831\u8868 "),f.Ub(),f.Ub(),f.Vb(16,"div",12),f.Vb(17,"span",11),f.Ic(18),f.Ub(),f.Vb(19,"span",13),f.Ic(20," \u5ee0\u5340 SHC "),f.Ub(),f.Vb(21,"span",13),f.Ic(22," \u5b63\u5ea6 Quarter "),f.Ub(),f.Vb(23,"span",13),f.Vb(24,"p-checkbox",14),f.Vb(25,"i",15),f.Ic(26,"done"),f.Ub(),f.Ic(27," Q1 "),f.Ub(),f.Ub(),f.Vb(28,"span",13),f.Vb(29,"p-checkbox",14),f.Vb(30,"i",15),f.Ic(31,"done"),f.Ub(),f.Ic(32," Q3 "),f.Ub(),f.Ub(),f.Gc(33,xe,3,0,"span",16),f.Ub(),f.Vb(34,"div",1),f.Vb(35,"table",17),f.Vb(36,"thead"),f.Vb(37,"tr"),f.Vb(38,"th",18),f.Ic(39,"\u90e8\u9580\u55ae\u4f4d Dept."),f.Ub(),f.Vb(40,"th",18),f.Ic(41,"\u59d3\u540d Full Name"),f.Ub(),f.Vb(42,"th",19),f.Ic(43,"\u76f4\u5c6c\u4e3b\u7ba1\u8a55\u5206 L1 score"),f.Ub(),f.Vb(44,"th",18),f.Ic(45,"\u76f4\u5c6c\u4e3b\u7ba1\u8a55\u8a9e L1 comment"),f.Ub(),f.Vb(46,"th",19),f.Ic(47,"\u4e8c\u968e\u4e3b\u7ba1\u8a55\u5206 L2 score"),f.Ub(),f.Vb(48,"th",18),f.Ic(49,"\u4e8c\u968e\u4e3b\u7ba1\u8a55\u8a9e L2 comment"),f.Ub(),f.Vb(50,"th",19),f.Ic(51,"SMART \u5206\u6578"),f.Ub(),f.Ub(),f.Ub(),f.Vb(52,"tbody"),f.Gc(53,De,2,1,"ng-container",20),f.Gc(54,ye,2,0,"ng-template",null,21,f.Hc),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Gc(56,Qe,58,9,"ng-template",null,22,f.Hc)),2&t){const t=f.xc(55);f.Cb(12),f.oc("ngModel",e.currentTime),f.Cb(6),f.Kc(" \u5e74\u5ea6 ",(null==e.detail?null:e.detail.year)||2021," "),f.Cb(6),f.oc("checked",1===e.currentquater),f.Cb(5),f.oc("checked",3===e.currentquater),f.Cb(4),f.oc("ngIf",1===e.currentquater||3===e.currentquater),f.Cb(20),f.oc("ngIf",void 0!==e.detail)("ngIfElse",t)}},directives:[a.b,o.f,o.i,ve,be,c.m,c.l],styles:[""]}),t})(),data:{title:"Q1,Q3 Report \u5b63\u5831\u8868",breadcrumb:"Q1,Q3 Report \u5b63\u5831\u8868",functionCode:"q1-q3-report"}},{path:"h1-h2-report",component:te,data:{title:"H1 & H2 Report",breadcrumb:"H1 & H2 Report",functionCode:"h1-h2-report"}},{path:"hq-hr-report",component:Nt,data:{title:"HQ HR Report \u5e74\u4e2d\u8003\u6838\u540d\u55ae",breadcrumb:"HQ HR Report \u5e74\u4e2d\u8003\u6838\u540d\u55ae",functionCode:"q1-q3-report"}},{path:"ghr-report",component:Lt,data:{title:"GHR Report",breadcrumb:"GHR Report",functionCode:"ghr-report"}}]}];let Ae=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=f.Nb({type:t}),t.\u0275inj=f.Mb({imports:[[H.g.forChild(ke)],H.g]}),t})();var Re=i("BrIm"),Pe=i("e7Im");function Ee(t){return new d.a(t,"./assets/i18n/",".json")}let _e;const Ge=localStorage.getItem("lang");Object(u.eb)(i("2PVe"),i("GFvd"),i("GFWS"),i("0zpJ"),i("LRxf")),Object(u.eb)(i("2PVe"),i("oP7I"),i("Joj5"),i("3JeS"),i("LRxf")),Object(u.eb)(i("2PVe"),i("1OsK"),i("pm0Y"),i("K8f6"),i("LRxf")),_e="vi"===Ge?Ge:"en"===Ge?"en":"zh";let Te=(()=>{class t{constructor(){"vi"===Ge?(_e="vi",setTimeout(()=>{u.q.load(i("+7Wi")),Object(u.qb)("vi")})):"en"===Ge?(_e="en",setTimeout(()=>{u.q.load(i("7j5C")),Object(u.qb)("en")})):(_e="zh",setTimeout(()=>{u.q.load(i("7e+1")),Object(u.qb)("zh")}))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=f.Nb({type:t}),t.\u0275inj=f.Mb({imports:[[Ie,c.c,o.b,o.k,b.c,s.f,x.e,r.a,r.b,Ae,a.a,Re.e,Pe.a,b.d,n.b,Re.d,w.k,l.b.forChild({loader:{provide:l.a,useFactory:Ee,deps:[g.b]},defaultLanguage:_e})]]}),t})()}}]);