(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{WUsH:function(t,e,i){"use strict";i.r(e),i.d(e,"HttpLoaderFactory",function(){return uc}),i.d(e,"TransactionModule",function(){return pc});var o=i("10VE"),n=i("SVse"),c=i("s7LF"),a=i("TSSN"),r=i("OoJn"),s=i("sWsm"),l=i("PDtH"),d=i("emFE"),b=i("k5Gf"),u=i("4SUy"),h=i("IheW"),p=i("uHT2"),g=i("dQqK"),f=i("HJFG"),m=i("8DlW"),y=i("L6UN"),v=i("v/ic"),I=i("SM1S"),S=i("1H6I"),U=i("2Vo4"),C=i("AytR"),V=i("8Y7J");let T=(()=>{class t{constructor(t,e){this.http=t,this.env=e,this.baseUrl=C.a.apiUrl,this.messageSource=new U.a(0),this.currentMessage=this.messageSource.asObservable()}changeMessage(t){this.messageSource.next(t)}getOCs(){return this.http.get(`${this.env.apiUrl}Ocs/GetListTree`)}getAllKpi(){return this.http.get(`${this.env.apiUrl}Meeting/GetAllKPI`)}getChart(t){return this.http.get(`${this.env.apiUrl}Meeting/GetChart/${t}`)}getChartWithTime(t,e){return this.http.get(`${this.env.apiUrl}Meeting/GetChartWithDateTime/${t}/${e}`)}addPolicy(t){return this.http.post(`${this.env.apiUrl}Ocpolicy/MappingPolicyOc`,t)}updatePolicy(t){return this.http.post(`${this.env.apiUrl}Ocpolicy/RemovePolicyOC`,t)}deletePolicy(t){return this.http.delete(`${this.env.apiUrl}Ocpolicy/DeletePolicy/${t}`)}getAllPolicy(){return this.http.get(`${this.env.apiUrl}Ocpolicy/GetAllPolicy`)}}return t.\u0275fac=function(e){return new(e||t)(V.cc(h.b),V.cc(S.a))},t.\u0275prov=V.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var x=i("qb46"),w=i("MO+k"),M=i("s0DI"),D=i("z6cu"),A=i("JIr8");let O=(()=>{class t{constructor(t,e,i){this.http=t,this.env=e,this.messageSource=new U.a(null),this.messageUploadSource=new U.a(null),this.currentMessage=this.messageSource.asObservable(),this.currentUploadMessage=this.messageUploadSource.asObservable(),this.entity="Todolist2",this.base=C.a.apiUrl}changeMessage(t){this.messageSource.next(t)}changeUploadMessage(t){this.messageUploadSource.next(t)}l0(t){return this.http.get(`${this.env.apiUrl}${this.entity}/L0?currentTime=${t}`,{}).pipe(Object(A.a)(this.handleError))}submitUpdatePDCA(t){return this.http.post(`${this.env.apiUrl}${this.entity}/SubmitUpdatePDCA`,t)}submitAction(t){return this.http.post(`${this.env.apiUrl}${this.entity}/submitAction`,t)}submitKPINew(t){return this.http.post(`${this.env.apiUrl}${this.entity}/SubmitKPINew?kpiId=${t}`,{})}addOrUpdateStatus(t){return this.http.post(`${this.env.apiUrl}${this.entity}/AddOrUpdateStatus`,t)}getStatus(){return this.http.get(`${this.env.apiUrl}${this.entity}/getStatus`,{}).pipe(Object(A.a)(this.handleError))}getActionsForL0(t){return this.http.get(`${this.env.apiUrl}${this.entity}/GetActionsForL0?kpiNewId=${t}`,{}).pipe(Object(A.a)(this.handleError))}getPDCAForL0(t,e){return this.http.get(`${this.env.apiUrl}${this.entity}/GetPDCAForL0?kpiNewId=${t}&currentTime=${e}`,{}).pipe(Object(A.a)(this.handleError))}getKPIForUpdatePDC(t,e){return this.http.get(`${this.env.apiUrl}${this.entity}/GetKPIForUpdatePDC?kpiNewId=${t}&currentTime=${e}`,{}).pipe(Object(A.a)(this.handleError))}getTargetForUpdatePDCA(t,e){return this.http.get(`${this.env.apiUrl}${this.entity}/GetTargetForUpdatePDCA?kpiNewId=${t}&currentTime=${e}`,{}).pipe(Object(A.a)(this.handleError))}getActionsForUpdatePDCA(t,e){return this.http.get(`${this.env.apiUrl}${this.entity}/GetActionsForUpdatePDCA?kpiNewId=${t}&currentTime=${e}`,{}).pipe(Object(A.a)(this.handleError))}download(t,e){return this.http.get(`${this.env.apiUrl}UploadFile/download?kpiId=${t}&uploadTime=${e}`,{responseType:"blob"}).pipe(Object(A.a)(this.handleError))}getAttackFiles(t,e){return this.http.get(`${this.env.apiUrl}UploadFile/GetAttackFiles?kpiId=${t}&uploadTime=${e}`).pipe(Object(A.a)(this.handleError))}getDownloadFiles(t,e){return this.http.get(`${this.env.apiUrl}UploadFile/GetDownloadFiles?kpiId=${t}&uploadTime=${e}`).pipe(Object(A.a)(this.handleError))}getDownloadFilesMeeting(t,e){return this.http.get(`${this.env.apiUrl}UploadFile/GetDownloadFilesMeeting?kpiId=${t}&uploadTime=${e}`).pipe(Object(A.a)(this.handleError))}handleError(t){var e,i,o,n;if(null===(e=null==t?void 0:t.error)||void 0===e?void 0:e.message)return Object(D.a)((null===(i=null==t?void 0:t.error)||void 0===i?void 0:i.message)||"Server error");if(null===(o=null==t?void 0:t.error)||void 0===o?void 0:o.errors){let e="";for(const i of null===(n=null==t?void 0:t.error)||void 0===n?void 0:n.errors)e+=i+"<br/>";return Object(D.a)(e||"Server error")}return Object(D.a)("Server error")}}return t.\u0275fac=function(e){return new(e||t)(V.cc(h.b),V.cc(S.a),V.cc(M.a))},t.\u0275prov=V.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var P=i("Naoh"),k=i("G0yt"),L=i("iInd"),G=i("4DqM"),j=i("7YrF"),R=i("e7Im");const F=["grid"],E=["detailModal"],B=["fileModal"],_=["gridDataTable"],N=["content"];function K(t,e){1&t&&(V.Ic(0),V.jc(1,"translate")),2&t&&V.Kc(" ",V.kc(1,1,"Level")," ")}function H(t,e){1&t&&(V.Ic(0),V.jc(1,"translate")),2&t&&V.Kc(" ",V.kc(1,1,"KPI Name")," ")}function J(t,e){1&t&&(V.Ic(0),V.jc(1,"translate")),2&t&&V.Kc(" ",V.kc(1,1,"Center")," ")}function z(t,e){1&t&&(V.Ic(0),V.jc(1,"translate")),2&t&&V.Kc(" ",V.kc(1,1,"Dept")," ")}function Q(t,e){1&t&&(V.Ic(0),V.jc(1,"translate")),2&t&&V.Kc(" ",V.kc(1,1,"PIC")," ")}function Y(t,e){if(1&t){const t=V.Wb();V.Vb(0,"div",30),V.Vb(1,"button",31),V.fc("click",function(){V.Ac(t);const i=e.$implicit,o=V.ic(),n=V.xc(53);return o.openModal(i,n)}),V.Qb(2,"i",32),V.Ub(),V.Ub()}}function q(t,e){1&t&&V.Ic(0," N/A ")}function W(t,e){if(1&t&&(V.Vb(0,"th",50),V.Ic(1),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.Kc(" ",t," ")}}function X(t,e){if(1&t&&(V.Tb(0),V.Ic(1),V.Sb()),2&t){const t=V.ic().$implicit;V.Cb(1),V.Kc(" ",t," % ")}}function Z(t,e){if(1&t&&V.Ic(0),2&t){const t=V.ic().$implicit;V.Kc(" ",t," ")}}function tt(t,e){if(1&t&&(V.Vb(0,"td",50),V.Gc(1,X,2,1,"ng-container",51),V.Gc(2,Z,1,1,"ng-template",null,52,V.Hc),V.Ub()),2&t){const t=V.xc(3),e=V.ic(2);V.Cb(1),V.oc("ngIf",1===e.typeId)("ngIfElse",t)}}function et(t,e){if(1&t&&(V.Tb(0),V.Vb(1,"td",50),V.Ic(2),V.Ub(),V.Sb()),2&t){const t=V.ic(2);V.Cb(2),V.Kc("",t.YTD," %")}}function it(t,e){if(1&t&&(V.Vb(0,"td",50),V.Ic(1),V.Ub()),2&t){const t=V.ic(2);V.Cb(1),V.Jc(t.YTD)}}function ot(t,e){if(1&t&&(V.Tb(0),V.Ic(1),V.Sb()),2&t){const t=V.ic().$implicit;V.Cb(1),V.Kc(" ",t," % ")}}function nt(t,e){if(1&t&&V.Ic(0),2&t){const t=V.ic().$implicit;V.Kc(" ",t," ")}}function ct(t,e){if(1&t&&(V.Vb(0,"td",50),V.Gc(1,ot,2,1,"ng-container",51),V.Gc(2,nt,1,1,"ng-template",null,52,V.Hc),V.Ub()),2&t){const t=V.xc(3),e=V.ic(2);V.Cb(1),V.oc("ngIf",1===e.typeId)("ngIfElse",t)}}function at(t,e){if(1&t&&(V.Tb(0),V.Vb(1,"td",50),V.Ic(2),V.Ub(),V.Sb()),2&t){const t=V.ic(2);V.Cb(2),V.Kc("",t.targetYTD," %")}}function rt(t,e){if(1&t&&(V.Vb(0,"td",50),V.Ic(1),V.Ub()),2&t){const t=V.ic(2);V.Cb(1),V.Jc(t.targetYTD)}}function st(t,e){1&t&&(V.Vb(0,"ejs-tooltip",73),V.jc(1,"translate"),V.Vb(2,"span",74),V.Ic(3),V.jc(4,"translate"),V.Ub(),V.Ub()),2&t&&(V.oc("content",V.kc(1,2,"meetingMonth")),V.Cb(3),V.Kc(" ",V.kc(4,4,"meetingMonth")," "))}function lt(t,e){1&t&&(V.Vb(0,"ejs-tooltip",73),V.jc(1,"translate"),V.Vb(2,"span",74),V.Ic(3),V.jc(4,"translate"),V.Ub(),V.Ub()),2&t&&(V.oc("content",V.kc(1,2,"meetingP")),V.Cb(3),V.Kc(" ",V.kc(4,4,"meetingP")," "))}function dt(t,e){1&t&&(V.Vb(0,"ejs-tooltip",73),V.jc(1,"translate"),V.Vb(2,"span",74),V.Ic(3),V.jc(4,"translate"),V.Ub(),V.Ub()),2&t&&(V.oc("content",V.kc(1,2,"meetingTarget")),V.Cb(3),V.Kc(" ",V.kc(4,4,"meetingTarget")," "))}function bt(t,e){1&t&&(V.Vb(0,"ejs-tooltip",73),V.jc(1,"translate"),V.Vb(2,"span",74),V.Ic(3),V.jc(4,"translate"),V.Ub(),V.Ub()),2&t&&(V.oc("content",V.kc(1,2,"meetingDeadline")),V.Cb(3),V.Kc(" ",V.kc(4,4,"meetingDeadline")," "))}function ut(t,e){1&t&&(V.Vb(0,"ejs-tooltip",73),V.jc(1,"translate"),V.Vb(2,"span",74),V.Ic(3),V.jc(4,"translate"),V.Ub(),V.Ub()),2&t&&(V.oc("content",V.kc(1,2,"meetingD")),V.Cb(3),V.Kc(" ",V.kc(4,4,"meetingD")," "))}function ht(t,e){1&t&&(V.Vb(0,"ejs-tooltip",73),V.jc(1,"translate"),V.Vb(2,"span",74),V.Ic(3),V.jc(4,"translate"),V.Ub(),V.Ub()),2&t&&(V.oc("content",V.kc(1,2,"meetingAtri")),V.Cb(3),V.Kc(" ",V.kc(4,4,"meetingAtri")," "))}function pt(t,e){1&t&&(V.Vb(0,"ejs-tooltip",73),V.jc(1,"translate"),V.Vb(2,"span",74),V.Ic(3),V.jc(4,"translate"),V.Ub(),V.Ub()),2&t&&(V.oc("content",V.kc(1,2,"meetingStatus")),V.Cb(3),V.Kc(" ",V.kc(4,4,"meetingStatus")," "))}function gt(t,e){1&t&&(V.Vb(0,"ejs-tooltip",73),V.jc(1,"translate"),V.Vb(2,"span",74),V.Ic(3),V.jc(4,"translate"),V.Ub(),V.Ub()),2&t&&(V.oc("content",V.kc(1,2,"meetingC")),V.Cb(3),V.Kc(" ",V.kc(4,4,"meetingC")," "))}function ft(t,e){1&t&&(V.Vb(0,"ejs-tooltip",73),V.jc(1,"translate"),V.Vb(2,"span",74),V.Ic(3),V.jc(4,"translate"),V.Ub(),V.Ub()),2&t&&(V.oc("content",V.kc(1,2,"meetingA")),V.Cb(3),V.Kc(" ",V.kc(4,4,"meetingA")," "))}function mt(t,e){1&t&&(V.Vb(0,"ejs-tooltip",73),V.jc(1,"translate"),V.Vb(2,"span",74),V.Ic(3),V.jc(4,"translate"),V.Ub(),V.Ub()),2&t&&(V.oc("content",V.kc(1,2,"meetingTarget")),V.Cb(3),V.Kc(" ",V.kc(4,4,"meetingTarget")," "))}function yt(t,e){1&t&&(V.Vb(0,"ejs-tooltip",73),V.jc(1,"translate"),V.Vb(2,"span",74),V.Ic(3),V.jc(4,"translate"),V.Ub(),V.Ub()),2&t&&(V.oc("content",V.kc(1,2,"meetingDeadline")),V.Cb(3),V.Kc(" ",V.kc(4,4,"meetingDeadline")," "))}function vt(t,e){1&t&&(V.Vb(0,"ejs-tooltip",73),V.jc(1,"translate"),V.Vb(2,"span",74),V.Ic(3),V.jc(4,"translate"),V.Ub(),V.Ub()),2&t&&(V.oc("content",V.kc(1,2,"meetingAt")),V.Cb(3),V.Kc(" ",V.kc(4,4,"meetingAt")," "))}function It(t,e){if(1&t&&(V.Vb(0,"th",82),V.Ic(1),V.Ub()),2&t){const t=V.ic(2).$implicit;V.Db("rowspan",t.currentMonthData.length),V.Cb(1),V.Jc(t.month)}}function St(t,e){if(1&t&&(V.Tb(0),V.Vb(1,"p",84),V.Ic(2),V.Ub(),V.Sb()),2&t){const t=V.ic().$implicit;V.Cb(2),V.Jc(t.content)}}function Ut(t,e){if(1&t&&(V.Vb(0,"p",84),V.Ic(1),V.Ub(),V.Qb(2,"hr")),2&t){const t=V.ic().$implicit;V.Cb(1),V.Jc(t.content)}}function Ct(t,e){if(1&t&&(V.Vb(0,"span"),V.Gc(1,St,3,1,"ng-container",51),V.Gc(2,Ut,3,1,"ng-template",null,52,V.Hc),V.Ub()),2&t){const t=e.index,i=V.xc(3),o=V.ic(3).$implicit;V.Cb(1),V.oc("ngIf",o.nextMonthData.lastIndex===t)("ngIfElse",i)}}function Vt(t,e){if(1&t&&(V.Vb(0,"td",83),V.Gc(1,Ct,4,2,"span",75),V.Ub()),2&t){const t=V.ic(2).$implicit;V.Db("rowspan",t.currentMonthData.length),V.Cb(1),V.oc("ngForOf",t.nextMonthData)}}function Tt(t,e){if(1&t&&(V.Tb(0),V.Vb(1,"p",86),V.Ic(2),V.Ub(),V.Sb()),2&t){const t=V.ic().$implicit;V.Cb(2),V.Jc(t.target)}}function xt(t,e){if(1&t&&(V.Vb(0,"p",86),V.Ic(1),V.Ub(),V.Qb(2,"hr")),2&t){const t=V.ic().$implicit;V.Cb(1),V.Jc(t.target)}}function wt(t,e){if(1&t&&(V.Vb(0,"span"),V.Gc(1,Tt,3,1,"ng-container",51),V.Gc(2,xt,3,1,"ng-template",null,52,V.Hc),V.Ub()),2&t){const t=e.index,i=V.xc(3),o=V.ic(3).$implicit;V.Cb(1),V.oc("ngIf",o.nextMonthData.lastIndex===t)("ngIfElse",i)}}function Mt(t,e){if(1&t&&(V.Vb(0,"td",85),V.Gc(1,wt,4,2,"span",75),V.Ub()),2&t){const t=V.ic(2).$implicit;V.Db("rowspan",t.currentMonthData.length),V.Cb(1),V.oc("ngForOf",t.nextMonthData)}}function Dt(t,e){if(1&t&&(V.Tb(0),V.Vb(1,"p",86),V.Ic(2),V.Ub(),V.Sb()),2&t){const t=V.ic().$implicit;V.Cb(2),V.Jc(t.deadline)}}function At(t,e){if(1&t&&(V.Vb(0,"p",86),V.Ic(1),V.Ub(),V.Qb(2,"hr")),2&t){const t=V.ic().$implicit;V.Cb(1),V.Jc(t.deadline)}}function Ot(t,e){if(1&t&&(V.Vb(0,"span"),V.Gc(1,Dt,3,1,"ng-container",51),V.Gc(2,At,3,1,"ng-template",null,52,V.Hc),V.Ub()),2&t){const t=e.index,i=V.xc(3),o=V.ic(3).$implicit;V.Cb(1),V.oc("ngIf",o.nextMonthData.lastIndex===t)("ngIfElse",i)}}function Pt(t,e){if(1&t&&(V.Vb(0,"td",87),V.Gc(1,Ot,4,2,"span",75),V.Ub()),2&t){const t=V.ic(2).$implicit;V.Db("rowspan",t.currentMonthData.length),V.Cb(1),V.oc("ngForOf",t.nextMonthData)}}function kt(t,e){if(1&t){const t=V.Wb();V.Vb(0,"td",82),V.Vb(1,"div",88),V.Vb(2,"button",31),V.fc("click",function(){V.Ac(t);const e=V.ic(2).$implicit,i=V.ic(2),o=V.xc(55);return i.download(e.date,o)}),V.Qb(3,"i",89),V.Ub(),V.Ub(),V.Ub()}if(2&t){const t=V.ic(2).$implicit;V.Db("rowspan",t.currentMonthData.length)}}function Lt(t,e){if(1&t&&(V.Vb(0,"tr"),V.Gc(1,It,2,2,"th",76),V.Vb(2,"td",77),V.Ic(3),V.Ub(),V.Vb(4,"td",78),V.Ic(5),V.Ub(),V.Vb(6,"td",78),V.Ic(7),V.Ub(),V.Vb(8,"td",77),V.Ic(9),V.Ub(),V.Vb(10,"td",78),V.Ic(11),V.Ub(),V.Vb(12,"td",78),V.Ic(13),V.jc(14,"translate"),V.Ub(),V.Vb(15,"td",77),V.Ic(16),V.Ub(),V.Gc(17,Vt,2,2,"td",79),V.Gc(18,Mt,2,2,"td",80),V.Gc(19,Pt,2,2,"td",81),V.Gc(20,kt,4,1,"td",76),V.Ub()),2&t){const t=e.$implicit,i=e.index;V.Cb(1),V.oc("ngIf",0==i),V.Cb(2),V.Jc(t.content),V.Cb(2),V.Jc(t.target),V.Cb(2),V.Jc(t.deadline),V.Cb(2),V.Kc(" ",t.doContent," "),V.Cb(2),V.Kc(" ",t.achievement," "),V.Cb(2),V.Kc(" ",V.kc(14,12,t.statusName)," "),V.Cb(3),V.Kc(" ",t.resultContent," "),V.Cb(1),V.oc("ngIf",0==i),V.Cb(1),V.oc("ngIf",0==i),V.Cb(1),V.oc("ngIf",0==i),V.Cb(1),V.oc("ngIf",0==i)}}function Gt(t,e){1&t&&V.Gc(0,Lt,21,14,"tr",75),2&t&&V.oc("ngForOf",e.$implicit.currentMonthData)}function jt(t,e){if(1&t){const t=V.Wb();V.Qb(0,"a",null,33),V.Vb(2,"div",34),V.Vb(3,"h4",35),V.Qb(4,"i",36),V.Ic(5," Monthly Review Meeting "),V.Ub(),V.Vb(6,"button",37),V.fc("click",function(){return e.$implicit.dismiss("Cross click")}),V.Vb(7,"span",38),V.Ic(8,"\xd7"),V.Ub(),V.Ub(),V.Ub(),V.Vb(9,"div",39),V.Vb(10,"div",5),V.Vb(11,"div",40),V.Vb(12,"div",0),V.Vb(13,"div",41),V.Ic(14),V.Ub(),V.Vb(15,"div",42),V.Ic(16),V.Ub(),V.Ub(),V.Qb(17,"hr"),V.Vb(18,"div",0),V.Vb(19,"div",41),V.Ic(20),V.Ub(),V.Vb(21,"div",42),V.Ic(22),V.Ub(),V.Ub(),V.Ub(),V.Qb(23,"div",40),V.Ub(),V.Vb(24,"div",0),V.Vb(25,"div",1),V.Vb(26,"div",43),V.Qb(27,"canvas",44),V.Ub(),V.Ub(),V.Ub(),V.Vb(28,"div",0),V.Vb(29,"div",1),V.Vb(30,"div",45),V.Vb(31,"div",46),V.Vb(32,"table",47),V.Vb(33,"tbody"),V.Vb(34,"tr"),V.Vb(35,"th",48),V.Ic(36),V.jc(37,"translate"),V.Ub(),V.Gc(38,W,2,1,"th",49),V.Vb(39,"th",50),V.Ic(40,"YTD"),V.Ub(),V.Ub(),V.Vb(41,"tr"),V.Vb(42,"th",48),V.Ic(43),V.jc(44,"translate"),V.Ub(),V.Gc(45,tt,4,2,"td",49),V.Gc(46,et,3,1,"ng-container",51),V.Gc(47,it,2,1,"ng-template",null,52,V.Hc),V.Ub(),V.Vb(49,"tr"),V.Vb(50,"th",48),V.Ic(51),V.jc(52,"translate"),V.Ub(),V.Gc(53,ct,4,2,"td",49),V.Gc(54,at,3,1,"ng-container",51),V.Gc(55,rt,2,1,"ng-template",null,52,V.Hc),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(57,"div",0),V.Vb(58,"div",1),V.Vb(59,"ejs-grid",53,54),V.fc("queryCellInfo",function(e){return V.Ac(t),V.ic().queryCellInfoEvent(e)})("headerCellInfo",function(e){return V.Ac(t),V.ic().headerCellInfo(e)}),V.Vb(61,"e-columns"),V.Vb(62,"e-column",55),V.Gc(63,st,5,6,"ng-template",null,20,V.Hc),V.Ub(),V.Vb(65,"e-column",56),V.Gc(66,lt,5,6,"ng-template",null,20,V.Hc),V.Ub(),V.Vb(68,"e-column",57),V.Gc(69,dt,5,6,"ng-template",null,20,V.Hc),V.Ub(),V.Vb(71,"e-column",58),V.Gc(72,bt,5,6,"ng-template",null,20,V.Hc),V.Ub(),V.Vb(74,"e-column",59),V.Gc(75,ut,5,6,"ng-template",null,20,V.Hc),V.Ub(),V.Vb(77,"e-column",60),V.Gc(78,ht,5,6,"ng-template",null,20,V.Hc),V.Ub(),V.Vb(80,"e-column",61),V.Gc(81,pt,5,6,"ng-template",null,20,V.Hc),V.Ub(),V.Vb(83,"e-column",62),V.Gc(84,gt,5,6,"ng-template",null,20,V.Hc),V.Ub(),V.Vb(86,"e-column",63),V.Gc(87,ft,5,6,"ng-template",null,20,V.Hc),V.Ub(),V.Vb(89,"e-column",64),V.Gc(90,mt,5,6,"ng-template",null,20,V.Hc),V.Ub(),V.Vb(92,"e-column",65),V.Gc(93,yt,5,6,"ng-template",null,20,V.Hc),V.Ub(),V.Vb(95,"e-column",66),V.Gc(96,vt,5,6,"ng-template",null,20,V.Hc),V.Ub(),V.Ub(),V.Gc(98,Gt,1,1,"ng-template",null,67,V.Hc),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(100,"div",68),V.Vb(101,"button",69),V.fc("click",function(){return e.$implicit.close("Close click")}),V.Ic(102,"Close"),V.Ub(),V.Vb(103,"span",70),V.Ic(104,"| |"),V.Ub(),V.Vb(105,"a",71),V.fc("click",function(){V.Ac(t);const e=V.xc(1);return V.ic().scroll(e)}),V.Qb(106,"i",72),V.Ub(),V.Ub()}if(2&t){const t=V.xc(48),e=V.ic();V.Cb(14),V.Kc("Policy: ",e.policyTitle,""),V.Cb(2),V.Kc("Level: ",e.levelTitle,""),V.Cb(4),V.Kc("KPI: ",e.kpiTitle,""),V.Cb(2),V.Kc("PIC: ",e.picTitle,""),V.Cb(14),V.Jc(V.kc(37,20,"meetingMonth")),V.Cb(2),V.oc("ngForOf",e.labels),V.Cb(5),V.Kc("",V.kc(44,22,"meetingTarget")," "),V.Cb(2),V.oc("ngForOf",e.targets),V.Cb(1),V.oc("ngIf",1===e.typeId)("ngIfElse",t),V.Cb(5),V.Kc("",V.kc(52,24,"meetingPer")," "),V.Cb(2),V.oc("ngForOf",e.perfomance),V.Cb(1),V.oc("ngIf",1===e.typeId)("ngIfElse",t),V.Cb(5),V.oc("dataSource",e.dataTable)("allowResizing",!0)("showColumnMenu",!0)("allowExcelExport",!0)("editSettings",e.editSettings)("pageSettings",e.pageSettings)}}function Rt(t,e){if(1&t&&(V.Vb(0,"li",93),V.Vb(1,"a",94),V.Ic(2),V.Ub(),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.oc("id",t.path)("href",t.path,V.Cc),V.Cb(1),V.Jc(t.name)}}function $t(t,e){if(1&t&&(V.Tb(0),V.Vb(1,"ul",91),V.Gc(2,Rt,3,3,"li",92),V.Ub(),V.Sb()),2&t){const t=V.ic(2);V.Cb(2),V.oc("ngForOf",t.files)}}function Ft(t,e){1&t&&(V.Vb(0,"span"),V.Ic(1,"No data"),V.Ub())}function Et(t,e){if(1&t){const t=V.Wb();V.Qb(0,"a",null,33),V.Vb(2,"div",34),V.Vb(3,"h4",35),V.Qb(4,"i",36),V.Ic(5," Download File "),V.Ub(),V.Vb(6,"button",37),V.fc("click",function(){return e.$implicit.dismiss("Cross click")}),V.Vb(7,"span",38),V.Ic(8,"\xd7"),V.Ub(),V.Ub(),V.Ub(),V.Vb(9,"div",39),V.Vb(10,"div",90),V.Gc(11,$t,3,1,"ng-container",51),V.Gc(12,Ft,2,0,"ng-template",null,52,V.Hc),V.Ub(),V.Ub(),V.Vb(14,"div",68),V.Vb(15,"button",69),V.fc("click",function(){return e.$implicit.close("Close click")}),V.Ic(16,"Close"),V.Ub(),V.Vb(17,"span",70),V.Ic(18,"| |"),V.Ub(),V.Vb(19,"a",71),V.fc("click",function(){V.Ac(t);const e=V.xc(1);return V.ic().scroll(e)}),V.Qb(20,"i",72),V.Ub(),V.Ub()}if(2&t){const t=V.xc(13),e=V.ic();V.Cb(11),V.oc("ngIf",e.files.length>0)("ngIfElse",t)}}let Bt=(()=>{class t extends g.a{constructor(t,e,i,o,n,c,a,r,s,l){super(),this.service=t,this.accountGroupService=e,this.modalService=i,this.ocService=o,this.datePipe=n,this.ocPolicyService=c,this.meetingService=a,this.alertify=r,this.todolist2Service=s,this.route=l,this.data=[],this.password="",this.fields={text:"name",value:"id"},this.leaderFields={text:"fullName",value:"id"},this.managerFields={text:"fullName",value:"id"},this.passwordFake="aRlG8BBHDYjrood3UqjzRl3FubHFI99nEPCahGtZl9jvkexwlJ",this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.locale=localStorage.getItem("lang"),this.leaders=[],this.managers=[],this.unit=null,this.period=null,this.plugins=[x],this.options={responsive:!0,maintainAspectRatio:!1,showScale:!1,plugins:{datalabels:{backgroundColor:function(t){return t.dataset.backgroundColor},borderRadius:4,color:"white",font:{weight:"bold"},formatter:function(t,e){return t}}},title:{display:!0,text:"",fontSize:14,fontColor:"black"},elements:{point:{radius:0},line:{tension:.2}},scales:{yAxes:[{stacked:!0,display:!0,position:"left",ticks:{beginAtZero:!0,padding:10,fontSize:12,stepSize:10,min:-5},scaleLabel:{display:!0,labelString:this.unit,fontSize:12,fontStyle:"normal"}}],xAxes:[{gridLines:{display:!0,tickMarkLength:8},ticks:{fontSize:12},scaleLabel:{display:!0,labelString:this.period,fontSize:12,fontStyle:"normal"}}]}},this.pointBackgroundColors=[],this.chart={},this.levelFields={text:"name",value:"id"},this.picFields={text:"name",value:"id"},this.levelId=0,this.factId=0,this.centerId=0,this.deptId=0,this.picId=0,this.files=[],this.base=C.a.apiUrl.replace("/api/",""),this.queryCellInfoEvent=t=>{const e=t.data;this.dataTable.filter((t,e,i)=>i.indexOf(i.find(e=>e.actionId===t.actionId))===e),["month","cContent"].includes(t.column.field)&&(t.rowSpan=this.dataTable.filter(t=>t.month===e.month&&t.cContent===e.cContent).length)}}ngOnInit(){this.getAllOcLv3(),this.getAllKpi(),this.currentTime=new Date}ngAfterViewInit(){}filterFact(t){this.factId=t.value,0===this.factId&&0===this.centerId&&0===this.deptId&&0===this.levelId&&(this.policyData=this.policyDataTamp),this.factId>0&&0===this.centerId&&0===this.deptId&&0===this.levelId&&(this.policyData=this.policyDataTamp.filter(t=>t.factId==this.factId)),this.factId>0&&this.centerId>0&&0===this.deptId&&0===this.levelId&&(this.policyData=this.policyDataTamp.filter(t=>t.factId==this.factId&&t.centerId==this.centerId)),this.factId>0&&this.centerId>0&&this.deptId>0&&0===this.levelId&&(this.policyData=this.policyDataTamp.filter(t=>t.factId==this.factId&&t.centerId==this.centerId&&t.deptId==this.deptId)),this.factId>0&&this.centerId>0&&this.deptId>0&&this.levelId>0&&(this.policyData=this.policyDataTamp.filter(t=>t.factId==this.factId&&t.centerId==this.centerId&&t.deptId==this.deptId&&t.level==this.levelId))}filterCenter(t){this.centerId=t.value,0===this.centerId&&0===this.factId&&0===this.deptId&&0===this.levelId&&(this.policyData=this.policyDataTamp),this.centerId>0&&0===this.factId&&0===this.deptId&&0===this.levelId&&(this.policyData=this.policyDataTamp.filter(t=>t.centerId==this.centerId)),this.centerId>0&&this.factId>0&&0===this.deptId&&0===this.levelId&&(this.policyData=this.policyDataTamp.filter(t=>t.factId==this.factId&&t.centerId==this.centerId)),this.factId>0&&this.centerId>0&&this.deptId>0&&0===this.levelId&&(this.policyData=this.policyDataTamp.filter(t=>t.factId==this.factId&&t.centerId==this.centerId&&t.deptId==this.deptId)),this.factId>0&&this.centerId>0&&this.deptId>0&&this.levelId>0&&(this.policyData=this.policyDataTamp.filter(t=>t.factId==this.factId&&t.centerId==this.centerId&&t.deptId==this.deptId&&t.level==this.levelId))}filterDept(t){this.deptId=t.value,0===this.deptId&&0===this.factId&&0===this.centerId&&0===this.levelId&&(this.policyData=this.policyDataTamp),this.deptId>0&&0===this.factId&&0===this.centerId&&0===this.levelId&&(this.policyData=this.policyDataTamp.filter(t=>t.deptId==this.deptId)),this.deptId>0&&this.factId>0&&0===this.centerId&&0===this.levelId&&(this.policyData=this.policyDataTamp.filter(t=>t.factId==this.factId&&t.deptId==this.deptId)),this.deptId>0&&this.centerId>0&&this.factId>0&&0===this.levelId&&(this.policyData=this.policyDataTamp.filter(t=>t.factId==this.factId&&t.centerId==this.centerId&&t.deptId==this.deptId)),this.factId>0&&this.centerId>0&&this.deptId>0&&this.levelId>0&&(this.policyData=this.policyDataTamp.filter(t=>t.factId==this.factId&&t.centerId==this.centerId&&t.deptId==this.deptId&&t.level==this.levelId))}filterlevel(t){this.levelId=t.value,0===this.levelId&&0===this.factId&&0===this.centerId&&0===this.deptId&&(this.policyData=this.policyDataTamp),this.levelId>0&&0===this.factId&&0===this.centerId&&0===this.deptId&&(this.policyData=this.policyDataTamp.filter(t=>t.level==this.levelId)),this.levelId>0&&this.factId>0&&0===this.deptId&&0===this.centerId&&(this.policyData=this.policyDataTamp.filter(t=>t.factId==this.factId&&t.level==this.levelId)),this.levelId>0&&this.factId>0&&this.centerId>0&&0===this.deptId&&(this.policyData=this.policyDataTamp.filter(t=>t.factId==this.factId&&t.centerId==this.centerId&&t.level==this.levelId)),this.factId>0&&this.centerId>0&&this.deptId>0&&this.levelId>0&&(this.policyData=this.policyDataTamp.filter(t=>t.factId==this.factId&&t.centerId==this.centerId&&t.deptId==this.deptId&&t.level==this.levelId))}filterPic(t){this.picId=t.value,0===this.levelId&&0===this.picId&&(this.policyData=this.policyDataTamp),this.levelId>0&&0===this.picId&&(this.policyData=this.policyDataTamp.filter(t=>t.level==this.levelId)),this.levelId>0&&this.picId>0&&(this.policyData=this.policyDataTamp.filter(t=>t.level==this.levelId&&t.picId==this.picId)),0===this.levelId&&this.picId>0&&(this.policyData=this.policyDataTamp.filter(t=>t.picId==this.picId))}scroll(t){t.scrollIntoView()}openModal(t,e){this.policyTitle=t.policyName,this.kpiTitle=t.name,this.levelTitle=t.level,this.picTitle=t.picName,this.unitId=t.typeId,this.unitName=t.typeName,this.kpiId=t.id,this.loadDataModel2(t.id),this.modalRef=this.modalService.open(e,{size:"lg",backdrop:"static"}),this.modalRef.result.then(t=>{this.perfomance=[],this.targets=[],this.labels=[],this.dataTable=[]},t=>{this.perfomance=[],this.targets=[],this.labels=[],this.dataTable=[]})}createChart(t,e,i){const o=document.getElementById(t),n=new w(o,{type:"line",data:{labels:e,datasets:[{label:"This month perfomance",backgroundColor:"#008cff",borderColor:"#008cff",fill:!1,data:this.perfomance},{label:"This month targets",data:this.targets,backgroundColor:"#ff8c00",borderColor:"#ff8c00",fill:!1}]},options:{plugins:{datalabels:{backgroundColor:function(t){return t.dataset.backgroundColor},borderRadius:4,color:"white",font:{weight:"bold"},formatter:function(t,e){return t}}},scales:{yAxes:[{display:!0,stacked:!1,position:"left",ticks:{beginAtZero:!0,padding:10,fontSize:12,stepSize:10,min:-5},scaleLabel:{display:!0,fontSize:12,fontStyle:"normal"}}],xAxes:[{gridLines:{display:!0,tickMarkLength:8},ticks:{fontSize:12},scaleLabel:{display:!0,fontSize:12,fontStyle:"normal"}}]},title:{display:!0,text:this.options.title.text,fontSize:14,fontColor:"black"},elements:{point:{radius:0},line:{tension:.2}}}});this.chart=n}loadDataModel(t){}download(t,e){this.modalRef=this.modalService.open(e,{size:"sm",backdrop:"static"}),console.log(this.kpiId),console.log(t),this.todolist2Service.getDownloadFilesMeeting(this.kpiId,t).subscribe(t=>{console.log(t),this.files=(t||[]).map(t=>({name:t.name,path:this.base+t.path}))})}headerCellInfo(t){"CustomerID"===t.cell.column.field&&new P.c({content:t.cell.column.headerText}).appendTo(t.node)}loadDataModel2(t){this.meetingService.getChartWithTime(t,this.datePipe.transform(this.currentTime,"YYYY-MM-dd HH:mm")).subscribe(t=>{console.log(t),this.typeId=t.typeId,this.YTD=t.ytd,this.targetYTD=t.targetYTD,this.perfomance=t.perfomances,this.targets=t.targets,this.labels=t.labels,this.dataTable=t.dataTable.filter(t=>t.currentMonthData.length>0),console.log(this.dataTable),this.createChart("planet-chart",this.labels,this.unitName)})}getAllKpi(){this.meetingService.getAllKpi().subscribe(t=>{console.log(t),this.policyData=t,this.policyDataTamp=t;const e=t.map(t=>({id:t.level,name:"Level "+t.level}));this.dataLevel=e.filter((t,e,i)=>i.indexOf(i.find(e=>e.id===t.id))===e);const i=t.map(t=>({id:t.picId,name:t.picName}));this.dataPic=[...new Map(i.map(t=>[t[t.id],t])).values()],this.dataPic=i.filter((t,e,i)=>i.indexOf(i.find(e=>e.id===t.id))===e);const o=t.map(t=>({id:t.factId,name:t.factName}));this.dataFact=[...new Map(o.map(t=>[t[t.id],t])).values()],this.dataFact=o.filter((t,e,i)=>i.indexOf(i.find(e=>e.id===t.id))===e);const n=t.map(t=>({id:t.centerId,name:t.centerName}));this.dataCenter=[...new Map(n.map(t=>[t[t.id],t])).values()],this.dataCenter=n.filter((t,e,i)=>i.indexOf(i.find(e=>e.id===t.id))===e);const c=t.map(t=>({id:t.deptId,name:t.deptName}));this.dataDept=[...new Map(c.map(t=>[t[t.id],t])).values()],this.dataDept=c.filter((t,e,i)=>i.indexOf(i.find(e=>e.id===t.id))===e),this.dataLevel.unshift({name:"All",id:0}),this.dataPic.unshift({name:"All",id:0})})}getAllPolicy(){this.ocPolicyService.getAllPolicy().subscribe(t=>{this.policyData=t})}getAllOcLv3(){this.ocService.getAllLv3().subscribe(t=>{this.oclv3Data=t})}createdManager(t,e){this.managers=this.accounts,this.managers=this.managers.filter(t=>t.id!==e.id)}createdLeader(t,e){this.leaders=this.accounts.filter(t=>t.isLeader),this.leaders=this.leaders.filter(t=>t.id!==e.id)}onDoubleClick(t){this.setFocus=t.column}initialModel(){this.accountGroupItem=[]}updateModel(t){this.accountGroupItem=t.factory}actionBegin(t){if("add"===t.requestType&&this.initialModel(),"beginEdit"===t.requestType&&this.updateModel(t.rowData),"save"===t.requestType&&"add"===t.action){const e={Name:t.data.name,OcIdList:this.accountGroupItem};if(void 0===t.data.name)return this.alertify.error("Please key in policy name! <br> Vui l\xf2ng nh\u1eadp Policy!"),void(t.cancel=!0);this.create(e)}"save"===t.requestType&&"edit"===t.action&&this.update({ID:t.data.id,Name:t.data.name,OcIdList:this.accountGroupItem}),"delete"===t.requestType&&this.delete(t.data[0].id)}deleteOption(t){this.ocPolicyService.deletePolicy(t).subscribe(t=>{t?(this.alertify.success(y.a.CREATED_OK_MSG),this.getAllPolicy(),this.accountGroupItem=[]):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)})}toolbarClick(t){switch(t.item.id){case"grid_excelexport":this.grid.excelExport({hierarchyExportMode:"All"})}}actionComplete(t){"add"===t.requestType&&t.form.elements.namedItem("name").focus()}lock(t){this.service.lock(t).subscribe(t=>{!0===t.success?(this.alertify.success(t.message),this.loadData()):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)},t=>this.alertify.warning(y.a.SYSTEM_ERROR_MSG))}loadData(){this.service.getAll().subscribe(t=>{this.data=t})}getAccounts(){this.service.getAccounts().subscribe(t=>{this.accounts=t,this.leaders=t.filter(t=>t.isLeader),this.managers=t})}loadAccountGroupData(){this.accountGroupService.getAll().subscribe(t=>{this.accountGroupData=t})}delete(t){this.ocPolicyService.deletePolicy(t).subscribe(t=>{t?(this.alertify.success(y.a.CREATED_OK_MSG),this.getAllPolicy(),this.accountGroupItem=[]):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)})}create(t){this.ocPolicyService.addPolicy(t).subscribe(t=>{t?(this.alertify.success(y.a.CREATED_OK_MSG),this.getAllPolicy(),this.accountGroupItem=[]):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)})}update(t){this.ocPolicyService.updatePolicy(t).subscribe(t=>{t?(this.alertify.success(y.a.CREATED_OK_MSG),this.getAllPolicy(),this.accountGroupItem=[]):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)})}NO(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}return t.\u0275fac=function(e){return new(e||t)(V.Pb(m.a),V.Pb(v.a),V.Pb(k.b),V.Pb(I.a),V.Pb(n.e),V.Pb(p.a),V.Pb(T),V.Pb(f.a),V.Pb(O),V.Pb(L.a))},t.\u0275cmp=V.Jb({type:t,selectors:[["app-meeting"]],viewQuery:function(t,e){if(1&t&&(V.Mc(F,1),V.Mc(E,1),V.Mc(B,1),V.Mc(_,1),V.Mc(N,3)),2&t){let t;V.wc(t=V.gc())&&(e.grid=t.first),V.wc(t=V.gc())&&(e.detailModal=t.first),V.wc(t=V.gc())&&(e.fileModal=t.first),V.wc(t=V.gc())&&(e.grid2=t.first),V.wc(t=V.gc())&&(e.elementView=t.first)}},features:[V.Bb([n.e]),V.zb],decls:56,vars:37,consts:[[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-body","table-responsive","p-0"],[1,"row","my-3"],[1,"row","mb-2"],[1,"col-md-12","d-flex","justify-content-center","align-items-center"],[1,"font-weight-bold","px-3"],["placeholder","Select a Factory",3,"dataSource","fields","allowFiltering","ngModel","change","ngModelChange"],[1,"font-weight-bold","pr-3"],["placeholder","Select a Center",3,"dataSource","fields","allowFiltering","ngModel","change","ngModelChange"],["placeholder","Select a Dept.",3,"dataSource","fields","allowFiltering","ngModel","change","ngModelChange"],["placeholder","Select a Level",3,"dataSource","fields","allowFiltering","ngModel","change","ngModelChange"],[1,"col-md-3","d-flex","justify-content-center"],[1,"form-group"],["for","exampleInputEmail1"],[2,"width","100%",3,"ngModel","ngModelChange"],["id","grid","gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","locale","pageSettings","allowExcelExport","editSettings","actionBegin","actionComplete","recordDoubleClick"],["grid",""],["field","level","textAlign","Center","width","80","isPrimaryKey","true","headerText","Level"],["headerTemplate",""],["field","name","textAlign","Center","headerText","KPI Name"],["field","centerName","textAlign","Center","headerText","Center"],["field","deptName","textAlign","Center","headerText","Dept."],["field","picName","headerText","PIC","width","200","textAlign","Center"],["field","option","width","100","textAlign","Center","headerText","PDCA"],["template",""],["editTemplate",""],["detailModal",""],["fileModal",""],[1,"btn-group"],["type","button",1,"btn","btn-xs","btn-primary",3,"click"],[1,"fa","fa-eye"],["top",""],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-6"],[1,"col-md-7"],[1,"col-md-5"],[1,"chart"],["id","planet-chart"],[1,"box-body"],[1,"table-responsive"],["id","tblDataChart",1,"table","table-bordered",2,"margin-bottom","20px"],["width","5%",1,"text-center"],["class","text-center",4,"ngFor","ngForOf"],[1,"text-center"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["id","grid","gridLines","Both","isPrimaryKey","true",3,"dataSource","allowResizing","showColumnMenu","allowExcelExport","editSettings","pageSettings","queryCellInfo","headerCellInfo"],["gridDataTable",""],["field","month","textAlign","Center","width","30px","headerText","\u5167\u5bb9"],["field","","textAlign","Center","width","210px","headerText","P"],["field","target","textAlign","Center","width","50px","headerText","Target"],["field","deadline","textAlign","Center","width","50px","headerText","Deadline"],["field","doContent","textAlign","Center","width","210px","headerText","D"],["field","achievement","textAlign","Center","width","50px","headerText","Achievement"],["field","statusName","textAlign","Center","width","80px","headerText","Status"],["field","content","textAlign","Center","width","210px","headerText","C"],["field","aContent","textAlign","Center","width","210px","headerText","A"],["field","aTarget","textAlign","Center","width","50px","headerText","Target"],["field","aDeadline","textAlign","Center","width","50px","headerText","Deadline"],["field","","textAlign","Center","width","50px","headerText","Attatchment"],["rowTemplate",""],[1,"modal-footer"],["type","button",1,"btn","btn-danger",3,"click"],[2,"color","transparent"],[1,"btn","btn-outline-warning",3,"click"],[1,"fas","fa-chevron-up"],[3,"content"],[2,"font-size","14px","font-weight","bold"],[4,"ngFor","ngForOf"],["style","font-size: 14px; ","scope","row","class","border text-center align-middle",4,"ngIf"],[1,"border","align-top",2,"font-size","14px"],[1,"border","text-center",2,"font-size","14px"],["style","font-size: 14px; ","scope","row","class","border align-top ",4,"ngIf"],["style","font-size: 14px; ","scope","row","class","border align-top text-center",4,"ngIf"],["style","font-size: 14px; ","scope","row","class","border text-center align-top",4,"ngIf"],["scope","row",1,"border","text-center","align-middle",2,"font-size","14px"],["scope","row",1,"border","align-top",2,"font-size","14px"],[2,"height","350px","overflow-y","scroll"],["scope","row",1,"border","align-top","text-center",2,"font-size","14px"],[2,"height","350px","padding-top","175px"],["scope","row",1,"border","text-center","align-top",2,"font-size","14px"],[2,"text-align","center"],[1,"fa","fa-download"],[1,"mt-3","d-flex","justify-content-start"],[1,"list-group",2,"width","100%"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],[3,"id","href"]],template:function(t,e){1&t&&(V.Vb(0,"div",0),V.Vb(1,"div",1),V.Vb(2,"div",2),V.Vb(3,"div",3),V.Vb(4,"div",4),V.Vb(5,"div",1),V.Vb(6,"div",5),V.Vb(7,"div",6),V.Vb(8,"div",7),V.Ic(9),V.jc(10,"translate"),V.Ub(),V.Vb(11,"ejs-dropdownlist",8),V.fc("change",function(t){return e.filterFact(t)})("ngModelChange",function(t){return e.factId=t}),V.Ub(),V.Vb(12,"div",9),V.Ic(13),V.jc(14,"translate"),V.Ub(),V.Vb(15,"ejs-dropdownlist",10),V.fc("change",function(t){return e.filterCenter(t)})("ngModelChange",function(t){return e.centerId=t}),V.Ub(),V.Vb(16,"div",9),V.Ic(17),V.jc(18,"translate"),V.Ub(),V.Vb(19,"ejs-dropdownlist",11),V.fc("change",function(t){return e.filterDept(t)})("ngModelChange",function(t){return e.deptId=t}),V.Ub(),V.Vb(20,"div",9),V.Ic(21),V.jc(22,"translate"),V.Ub(),V.Vb(23,"ejs-dropdownlist",12),V.fc("change",function(t){return e.filterlevel(t)})("ngModelChange",function(t){return e.levelId=t}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(24,"div",13),V.Vb(25,"div",14),V.Vb(26,"label",15),V.Ic(27,"Change System Date"),V.Ub(),V.Vb(28,"kendo-datepicker",16),V.fc("ngModelChange",function(t){return e.currentTime=t}),V.Ub(),V.Ub(),V.Ub(),V.Vb(29,"ejs-grid",17,18),V.fc("actionBegin",function(t){return e.actionBegin(t)})("actionComplete",function(t){return e.actionComplete(t)})("recordDoubleClick",function(t){return e.onDoubleClick(t)}),V.Vb(31,"e-columns"),V.Vb(32,"e-column",19),V.Gc(33,K,2,3,"ng-template",null,20,V.Hc),V.Ub(),V.Vb(35,"e-column",21),V.Gc(36,H,2,3,"ng-template",null,20,V.Hc),V.Ub(),V.Vb(38,"e-column",22),V.Gc(39,J,2,3,"ng-template",null,20,V.Hc),V.Ub(),V.Vb(41,"e-column",23),V.Gc(42,z,2,3,"ng-template",null,20,V.Hc),V.Ub(),V.Vb(44,"e-column",24),V.Gc(45,Q,2,3,"ng-template",null,20,V.Hc),V.Ub(),V.Vb(47,"e-column",25),V.Gc(48,Y,3,0,"ng-template",null,26,V.Hc),V.Gc(50,q,1,0,"ng-template",null,27,V.Hc),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Gc(52,jt,107,26,"ng-template",null,28,V.Hc),V.Gc(54,Et,21,2,"ng-template",null,29,V.Hc)),2&t&&(V.Cb(9),V.Kc("",V.kc(10,29,"Factory")," :"),V.Cb(2),V.oc("dataSource",e.dataFact)("fields",e.levelFields)("allowFiltering",!0)("ngModel",e.factId),V.Cb(2),V.Kc("",V.kc(14,31,"Center"),": "),V.Cb(2),V.oc("dataSource",e.dataCenter)("fields",e.levelFields)("allowFiltering",!0)("ngModel",e.centerId),V.Cb(2),V.Kc("",V.kc(18,33,"Dept"),": "),V.Cb(2),V.oc("dataSource",e.dataDept)("fields",e.levelFields)("allowFiltering",!0)("ngModel",e.deptId),V.Cb(2),V.Kc("",V.kc(22,35,"Level"),": "),V.Cb(2),V.oc("dataSource",e.dataLevel)("fields",e.levelFields)("allowFiltering",!0)("ngModel",e.levelId),V.Cb(5),V.oc("ngModel",e.currentTime),V.Cb(1),V.oc("dataSource",e.policyData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("locale",e.locale)("pageSettings",e.pageSettings)("allowExcelExport",!0)("editSettings",e.editSettings))},directives:[l.b,c.f,c.i,r.b,d.g,d.d,d.b,G.d,G.b,j.d,d.c,d.a,G.c,G.a,j.c,n.l,n.m,R.b],pipes:[a.c],styles:[".chart-container[_ngcontent-%COMP%]{position:relative;margin:auto;height:48vh;width:auto}canvas[_ngcontent-%COMP%]{height:500px!important}"]}),t})();var _t=i("K1le"),Nt=i("kjH0"),Kt=i("6fnv");let Ht=(()=>{class t extends Kt.a{constructor(t,e,i){super(t,"Objective",e,i)}post(t){return this.http.post(`${this.env.apiUrl}${this.entity}/add`,t).pipe(Object(A.a)(this.handleError))}put(t){return this.http.put(`${this.env.apiUrl}${this.entity}/update`,t).pipe(Object(A.a)(this.handleError))}getAllKPIObjectiveByAccountId(){return this.http.get(`${this.env.apiUrl}${this.entity}/GetAllKPIObjectiveByAccountId`,{}).pipe(Object(A.a)(this.handleError))}}return t.\u0275fac=function(e){return new(e||t)(V.cc(h.b),V.cc(M.a),V.cc(S.a))},t.\u0275prov=V.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Jt=["addNewModal"],zt=["grid"];function Qt(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic();V.Kc(" ",i.NO(t.index)," ")}}function Yt(t,e){1&t&&V.Ic(0," # ")}function qt(t,e){if(1&t){const t=V.Wb();V.Vb(0,"ejs-dropdownlist",14,15),V.fc("change",function(e){return V.Ac(t),V.ic().onChangeAccountGroup(e)}),V.Ub()}if(2&t){const t=e.$implicit,i=V.ic();V.oc("dataSource",i.accountGroupData)("value",t.accountGroupId)("fields",i.fields)("allowFiltering",!0)}}function Wt(t,e){if(1&t){const t=V.Wb();V.Vb(0,"button",16),V.fc("click",function(){V.Ac(t);const i=e.$implicit;return V.ic().delete(i.id)}),V.Qb(1,"i",17),V.Ub()}}function Xt(t,e){1&t&&(V.Vb(0,"span"),V.Ic(1),V.Ub()),2&t&&(V.Cb(1),V.Kc(" ","Update KPI Object"," "))}function Zt(t,e){1&t&&(V.Vb(0,"span"),V.Ic(1),V.Ub()),2&t&&(V.Cb(1),V.Kc(" ","Add new KPI Object"," "))}function te(t,e){if(1&t){const t=V.Wb();V.Vb(0,"button",34),V.fc("click",function(){return V.Ac(t),V.ic(2).create()}),V.Ic(1),V.Ub()}2&t&&(V.Cb(1),V.Jc("Finish"))}function ee(t,e){if(1&t){const t=V.Wb();V.Vb(0,"button",34),V.fc("click",function(){return V.Ac(t),V.ic(2).update()}),V.Ic(1),V.Ub()}2&t&&(V.Cb(1),V.Jc("Finish"))}function ie(t,e){if(1&t){const t=V.Wb();V.Vb(0,"div",18),V.Vb(1,"h4",19),V.Qb(2,"i",20),V.Gc(3,Xt,2,1,"span",21),V.Gc(4,Zt,2,1,"span",21),V.Ub(),V.Vb(5,"button",22),V.fc("click",function(){return e.$implicit.dismiss("Cross click")}),V.Vb(6,"span",23),V.Ic(7,"\xd7"),V.Ub(),V.Ub(),V.Ub(),V.Vb(8,"div",24),V.Vb(9,"div",0),V.Vb(10,"div",25),V.Vb(11,"div",26),V.Vb(12,"label",27),V.Ic(13,"KPI Objective"),V.Ub(),V.Vb(14,"input",28),V.fc("ngModelChange",function(e){return V.Ac(t),V.ic().topic=e}),V.Ub(),V.Ub(),V.Ub(),V.Vb(15,"div",25),V.Vb(16,"div",26),V.Vb(17,"label",27),V.Ic(18,"Choose PIC"),V.Ub(),V.Vb(19,"ejs-multiselect",29,30),V.fc("removing",function(e){return V.Ac(t),V.ic().removing(e)})("select",function(e){return V.Ac(t),V.ic().onSelect(e)}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(21,"div",31),V.Vb(22,"button",32),V.fc("click",function(){return e.$implicit.close("Close click")}),V.Ic(23),V.Ub(),V.Gc(24,te,2,1,"button",33),V.Gc(25,ee,2,1,"button",33),V.Ub()}if(2&t){const t=V.ic();V.Cb(3),V.oc("ngIf",(null==t.model?null:t.model.id)>0),V.Cb(1),V.oc("ngIf",0===(null==t.model?null:t.model.id)),V.Cb(10),V.oc("ngModel",t.topic),V.Cb(5),V.oc("dataSource",t.accountData)("fields",t.fields)("allowFiltering",!0)("value",t.accountIdList),V.Cb(4),V.Jc("Close"),V.Cb(1),V.oc("ngIf",0===t.model.id),V.Cb(1),V.oc("ngIf",t.model.id>0)}}let oe=(()=>{class t extends g.a{constructor(t,e,i,o,n,c,a,r,s){super(),this.service=t,this.periodService=e,this.accountService=i,this.periodReportTimeService=o,this.accountGroupService=n,this.modalService=c,this.alertify=a,this.route=r,this.datePipe=s,this.data=[],this.periodReportTimeData=[],this.password="",this.fields={text:"fullName",value:"id"},this.filterSettings={type:"Excel"},this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.locale=localStorage.getItem("lang"),this.accountIdList=[],this.accountList=[],this.model={id:0,topic:"",status:!1,date:(new Date).toLocaleDateString(),accountIdList:this.accountIdList},this.toolbarOptions=["Add","Search"]}ngOnInit(){this.loadData(),this.loadPeriodData(),this.loadAccountData(),this.loadAccountGroupData()}onDoubleClick(t){console.log(t);const e=t.rowData;this.model={id:e.id,topic:e.topic,status:e.status,date:e.date,accountIdList:e.accountIdList},this.accountIdList=e.accountIdList,this.openModal(this.addNewModal),this.setFocus=t.column}actionBegin(t){if("beginEdit"===t.requestType){const e=t.rowData;this.accountGroupId=e.accountGroupId,this.topic=e.topic,t.cancel=!0}"save"===t.requestType&&"add"===t.action&&this.create(),"save"===t.requestType&&"edit"===t.action&&(this.model={id:t.data.id,topic:t.data.topic,status:!1,date:t.data.date,accountIdList:this.accountIdList},this.update()),"delete"===t.requestType&&this.delete(t.data[0].id)}actionComplete(t){}loadData(){this.service.getAllKPIObjectiveByAccountId().subscribe(t=>{this.data=t})}loadAccountData(){this.accountService.getAll().subscribe(t=>{this.accountData=t.filter(t=>t.id!==+JSON.parse(localStorage.getItem("user")).id)})}loadAccountGroupData(){this.accountGroupService.getAll().subscribe(t=>{this.accountGroupData=t})}loadPeriodData(){this.periodService.getAll().subscribe(t=>{this.periodData=t})}loadPeriodReportTimeData(){this.periodReportTimeService.getAll().subscribe(t=>{this.periodReportTimeData=t})}delete(t){this.alertify.confirm("Delete","Are you sure you want to delete the objective?",()=>{this.service.delete(t).subscribe(t=>{!0===t.success?(this.alertify.success(y.a.DELETED_OK_MSG),this.loadData()):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)},t=>this.alertify.warning(y.a.SYSTEM_ERROR_MSG))})}create(){this.model={id:0,topic:this.topic,status:!1,date:(new Date).toLocaleDateString(),accountIdList:this.accountIdList},this.service.post(this.model).subscribe(t=>{!0===t.success?(this.alertify.success(y.a.CREATED_OK_MSG),this.loadData(),this.topic="",this.accountIdList=[],this.model={id:0,topic:"",status:!1,date:(new Date).toLocaleDateString(),accountIdList:this.accountIdList},this.modalService.dismissAll()):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)},t=>{this.alertify.warning(y.a.SYSTEM_ERROR_MSG)})}update(){this.model.topic=this.topic,this.model.accountIdList=this.accountIdList,this.service.put(this.model).subscribe(t=>{!0===t.success?(this.alertify.success(y.a.UPDATED_OK_MSG),this.loadData(),this.modalService.dismissAll()):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)},t=>{this.alertify.warning(y.a.SYSTEM_ERROR_MSG)})}NO(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}onChangeAccountGroup(t){console.log(t),this.accountGroupId=t.itemData.id}removing(t){const e=this.accountIdList.filter(e=>e!==t.itemData.id);this.accountIdList=e,this.accountList=this.accountList.filter(e=>e.id!==t.itemData.id),console.log(this.accountList),console.log(this.accountIdList)}onSelect(t){const e=t.itemData;this.accountIdList.push(e.id),this.accountList.push({objectiveId:0,id:e.id,username:e.username}),console.log(this.accountList),console.log(this.accountIdList)}toolbarClick(t){switch(t.item.id){case"grid_add":t.cancel=!0,this.openModal(this.addNewModal)}}openModal(t){this.modalReference=this.modalService.open(this.addNewModal,{size:"xl"})}}return t.\u0275fac=function(e){return new(e||t)(V.Pb(Ht),V.Pb(_t.a),V.Pb(m.a),V.Pb(Nt.a),V.Pb(v.a),V.Pb(k.b),V.Pb(f.a),V.Pb(L.a),V.Pb(n.e))},t.\u0275cmp=V.Jb({type:t,selectors:[["app-objective"]],viewQuery:function(t,e){if(1&t&&(V.Mc(Jt,1),V.Mc(zt,1)),2&t){let t;V.wc(t=V.gc())&&(e.addNewModal=t.first),V.wc(t=V.gc())&&(e.grid=t.first)}},features:[V.Bb([n.e]),V.zb],decls:22,vars:12,consts:[[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-body","table-responsive","p-0"],["id","grid","gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","locale","toolbar","pageSettings","allowExcelExport","editSettings","actionBegin","actionComplete","recordDoubleClick","toolbarClick"],["grid",""],["field","ID","textAlign","Center","width","80","isPrimaryKey","true","headerText","ID"],["template",""],["editTemplate",""],["field","topic","width","200","textAlign","Center",3,"headerText"],["field","accounts","width","200","textAlign","Center",3,"headerText"],["field","date","type","date","format","MM-dd-yyyy","width","200","textAlign","Center",3,"headerText"],["field","option","width","80","headerText","Option","textAlign","Center"],["addNewModal",""],[3,"dataSource","value","fields","allowFiltering","change"],["accountGroupDropdownlist",""],[1,"btn","btn-danger","btn-sm",3,"click"],[1,"fa","fa-trash"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],[4,"ngIf"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-6"],[1,"form-group"],["for",""],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["id","glueDropdownlist","mode","Box","placeholder","Choose PIC",3,"dataSource","fields","allowFiltering","value","removing","select"],["accountDropdownlist",""],[1,"modal-footer"],["type","button",1,"btn","btn-danger",3,"click"],["type","button","class","btn btn-success",3,"click",4,"ngIf"],["type","button",1,"btn","btn-success",3,"click"]],template:function(t,e){1&t&&(V.Vb(0,"div",0),V.Vb(1,"div",1),V.Vb(2,"div",2),V.Vb(3,"div",3),V.Vb(4,"ejs-grid",4,5),V.fc("actionBegin",function(t){return e.actionBegin(t)})("actionComplete",function(t){return e.actionComplete(t)})("recordDoubleClick",function(t){return e.onDoubleClick(t)})("toolbarClick",function(t){return e.toolbarClick(t)}),V.Vb(6,"e-columns"),V.Vb(7,"e-column",6),V.Gc(8,Qt,1,1,"ng-template",null,7,V.Hc),V.Gc(10,Yt,1,0,"ng-template",null,8,V.Hc),V.Ub(),V.Qb(12,"e-column",9),V.Vb(13,"e-column",10),V.Gc(14,qt,2,4,"ng-template",null,8,V.Hc),V.Ub(),V.Qb(16,"e-column",11),V.Vb(17,"e-column",12),V.Gc(18,Wt,2,0,"ng-template",null,7,V.Hc),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Gc(20,ie,26,10,"ng-template",null,13,V.Hc)),2&t&&(V.Cb(4),V.oc("dataSource",e.data)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("locale",e.locale)("toolbar",e.toolbarOptions)("pageSettings",e.pageSettings)("allowExcelExport",!0)("editSettings",e.editSettings),V.Cb(8),V.pc("headerText","Period"),V.Cb(1),V.pc("headerText","PIC"),V.Cb(3),V.pc("headerText","Date"))},directives:[d.g,d.d,d.b,G.d,G.b,j.d,d.c,d.a,G.c,G.a,j.c,l.b,n.m,c.a,c.f,c.i,l.e],styles:[""]}),t})(),ne=(()=>{class t extends Kt.a{constructor(t,e,i){super(t,"Performance",e,i)}getKPIObjectivesByUpdater(){return this.http.get(`${this.env.apiUrl}${this.entity}/GetKPIObjectivesByUpdater`,{}).pipe(Object(A.a)(this.handleError))}submit(t){return this.http.put(`${this.env.apiUrl}${this.entity}/Submit`,t).pipe(Object(A.a)(this.handleError))}}return t.\u0275fac=function(e){return new(e||t)(V.cc(h.b),V.cc(M.a),V.cc(S.a))},t.\u0275prov=V.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var ce=function(t){return t[t.L0=1]="L0",t[t.L1=2]="L1",t[t.FunctionalLeader=6]="FunctionalLeader",t[t.GFL=6]="GFL",t[t.L2=3]="L2",t[t.FHO=4]="FHO",t[t.Updater=4]="Updater",t[t.GHR=5]="GHR",t[t.GM=7]="GM",t}({}),ae=function(t){return t[t.Objective=1]="Objective",t[t.Target=2]="Target",t[t.Action=3]="Action",t}({}),re=function(t){return t.L0="L0",t.L1="L1",t.L2="L2",t.FHO="FHO",t.Updater="FHO",t.GHR="GHR",t.GM="GM",t.FunctionalLeader="FunctionalLeader",t.GFL="FunctionalLeader",t}({}),se=function(t){return t.KPI="KPI",t.Attitude="Attitude",t}({}),le=function(t){return t.Monthly="Monthly",t.Quarterly="Quarterly",t.HalfYear="HalfYear",t}({}),de=function(t){return t[t.Q1=1]="Q1",t[t.Q2=2]="Q2",t[t.Q3=3]="Q3",t[t.Q4=4]="Q4",t}({}),be=function(t){return t.Comment="Comment",t.SelfEvaluation="Self Evaluation",t}({});let ue=(()=>{class t extends Kt.a{constructor(t,e,i){super(t,"Todolist",e,i),this.env=i,this.messageSource=new U.a(null),this.currentMessage=this.messageSource.asObservable()}changeMessage(t){this.messageSource.next(t)}getAllByObjectiveId(t){return this.http.get(`${this.env.apiUrl}${this.entity}/GetAllByObjectiveId?objectiveId=${t}`,{}).pipe(Object(A.a)(this.handleError))}getAllByObjectiveIdAsTree(t){return this.http.get(`${this.env.apiUrl}${this.entity}/GetAllByObjectiveIdAsTree?objectiveId=${t}`,{}).pipe(Object(A.a)(this.handleError))}l0(t){return this.http.get(`${this.env.apiUrl}${this.entity}/L0?currentTime=${t}`,{}).pipe(Object(A.a)(this.handleError))}l1(t){return this.http.get(`${this.env.apiUrl}${this.entity}/L1?currentTime=${t}`,{}).pipe(Object(A.a)(this.handleError))}functionalLeader(t){return this.http.get(`${this.env.apiUrl}${this.entity}/FunctionalLeader?currentTime=${t}`,{}).pipe(Object(A.a)(this.handleError))}l2(t){return this.http.get(`${this.env.apiUrl}${this.entity}/L2?currentTime=${t}`,{}).pipe(Object(A.a)(this.handleError))}fho(t){return this.http.get(`${this.env.apiUrl}${this.entity}/fho?currentTime=${t}`,{}).pipe(Object(A.a)(this.handleError))}updater(t){return this.http.get(`${this.env.apiUrl}${this.entity}/updater?currentTime=${t}`,{}).pipe(Object(A.a)(this.handleError))}ghr(t){return this.http.get(`${this.env.apiUrl}${this.entity}/ghr?currentTime=${t}`,{}).pipe(Object(A.a)(this.handleError))}gm(t){return this.http.get(`${this.env.apiUrl}${this.entity}/gm?currentTime=${t}`,{}).pipe(Object(A.a)(this.handleError))}getAllInCurrentQuarterByObjectiveId(t){return this.http.get(`${this.env.apiUrl}${this.entity}/GetAllInCurrentQuarterByObjectiveId?objectiveId=${t}`,{}).pipe(Object(A.a)(this.handleError))}getAllObjectiveByL1L2(){return this.http.get(`${this.env.apiUrl}${this.entity}/GetAllObjectiveByL1L2`,{}).pipe(Object(A.a)(this.handleError))}getAllKPIScoreByAccountId(){return this.http.get(`${this.env.apiUrl}${this.entity}/GetAllKPIScoreL0ByAccountId`,{}).pipe(Object(A.a)(this.handleError))}getAllKPISelfScoreByObjectiveId(t){return this.http.get(`${this.env.apiUrl}${this.entity}/getAllKPISelfScoreByObjectiveId?objectiveId=${t}`,{}).pipe(Object(A.a)(this.handleError))}dateToYMD(t){var e=t.getDate(),i=t.getMonth()+1;return t.getFullYear()+"-"+(i<=9?"0"+i:i)+"-"+(e<=9?"0"+e:e)}getAllKPIScoreL1ByAccountId(t,e){return this.http.get(`${this.env.apiUrl}${this.entity}/GetAllKPIScoreL1ByAccountId?accountId=${t}&currentTime=${this.dateToYMD(e)}`,{}).pipe(Object(A.a)(this.handleError))}getAllKPIScoreL2ByAccountId(t,e){return this.http.get(`${this.env.apiUrl}${this.entity}/GetAllKPIScoreL2ByAccountId?accountId=${t}&currentTime=${this.dateToYMD(e)}`,{}).pipe(Object(A.a)(this.handleError))}getAllKPIScoreGHRByAccountId(t,e){return this.http.get(`${this.env.apiUrl}${this.entity}/GetAllKPIScoreGHRByAccountId?accountId=${t}&currentTime=${this.dateToYMD(e)}`,{}).pipe(Object(A.a)(this.handleError))}getAllKPIScoreL0ByPeriod(t){return this.http.get(`${this.env.apiUrl}${this.entity}/GetAllKPIScoreL0ByPeriod?period=${t}`,{}).pipe(Object(A.a)(this.handleError))}getAllAttitudeScoreByFunctionalLeader(){return this.http.get(`${this.env.apiUrl}${this.entity}/GetAllAttitudeScoreByFunctionalLeader`,{}).pipe(Object(A.a)(this.handleError))}getQuarterlySetting(){return this.http.get(`${this.env.apiUrl}${this.entity}/getQuarterlySetting`,{}).pipe(Object(A.a)(this.handleError))}getAllAttitudeScoreL1ByAccountId(t){return this.http.get(`${this.env.apiUrl}${this.entity}/GetAllAttitudeScoreL1ByAccountId?accountId=${t}`,{}).pipe(Object(A.a)(this.handleError))}getAllAttitudeScoreL2ByAccountId(t){return this.http.get(`${this.env.apiUrl}${this.entity}/GetAllAttitudeScoreL2ByAccountId?accountId=${t}`,{}).pipe(Object(A.a)(this.handleError))}getAllAttitudeScoreGHRByAccountId(t){return this.http.get(`${this.env.apiUrl}${this.entity}/getAllAttitudeScoreGHRByAccountId?accountId=${t}`,{}).pipe(Object(A.a)(this.handleError))}getAllAttitudeScoreGFLByAccountId(t){return this.http.get(`${this.env.apiUrl}${this.entity}/getAllAttitudeScoreGFLByAccountId?accountId=${t}`,{}).pipe(Object(A.a)(this.handleError))}import(t,e){const i=new FormData;return i.append("UploadedFile",t),i.append("UploadBy",e),this.http.post(e+"todolist/Import",i)}reject(t){return this.http.put(`${this.env.apiUrl}${this.entity}/reject`,{ids:t}).pipe(Object(A.a)(this.handleError))}disableReject(t){return this.http.put(`${this.env.apiUrl}${this.entity}/DisableReject`,{ids:t}).pipe(Object(A.a)(this.handleError))}release(t){return this.http.put(`${this.env.apiUrl}${this.entity}/release`,{ids:t}).pipe(Object(A.a)(this.handleError))}}return t.\u0275fac=function(e){return new(e||t)(V.cc(h.b),V.cc(M.a),V.cc(S.a))},t.\u0275prov=V.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),he=(()=>{class t extends Kt.a{constructor(t,e,i){super(t,"KPIScore",e,i)}getFisrtSelfScoreByAccountId(t,e,i,o){return this.http.get(`${this.env.apiUrl}${this.entity}/GetFisrtSelfScoreByAccountId?accountId=${t}&periodTypeId=${e}&period=${i}&scoreType=${o}`,{}).pipe(Object(A.a)(this.handleError))}getFisrtSelfScoreL1ByAccountId(t,e,i,o){return this.http.get(`${this.env.apiUrl}${this.entity}/GetFisrtSelfScoreL1ByAccountId?accountId=${t}&periodTypeId=${e}&period=${i}&scoreType=${o}`,{}).pipe(Object(A.a)(this.handleError))}getFisrtByAccountId(t,e,i,o){return this.http.get(`${this.env.apiUrl}${this.entity}/GetFisrtByAccountId?accountId=${t}&periodTypeId=${e}&period=${i}&scoreType=${o}`,{}).pipe(Object(A.a)(this.handleError))}getFisrtKPIScoreL1ByAccountId(t,e,i,o){return this.http.get(`${this.env.apiUrl}${this.entity}/GetFisrtKPIScoreL1ByAccountId?accountId=${t}&periodTypeId=${e}&period=${i}&scoreType=${o}`,{}).pipe(Object(A.a)(this.handleError))}}return t.\u0275fac=function(e){return new(e||t)(V.cc(h.b),V.cc(M.a),V.cc(S.a))},t.\u0275prov=V.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),pe=(()=>{class t extends Kt.a{constructor(t,e,i){super(t,"KPI",e,i)}}return t.\u0275fac=function(e){return new(e||t)(V.cc(h.b),V.cc(M.a),V.cc(S.a))},t.\u0275prov=V.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),ge=(()=>{class t extends Kt.a{constructor(t,e,i){super(t,"Comment",e,i)}getFisrtByAccountId(t,e,i,o){return this.http.get(`${this.env.apiUrl}${this.entity}/GetFisrtByAccountId?accountId=${t}&periodTypeId=${e}&period=${i}&scoreType=${o}`,{}).pipe(Object(A.a)(this.handleError))}getFunctionalLeaderCommentByAccountId(t,e,i){return this.http.get(`${this.env.apiUrl}${this.entity}/GetFunctionalLeaderCommentByAccountId?accountId=${t}&periodTypeId=${e}&period=${i}`,{}).pipe(Object(A.a)(this.handleError))}getGHRCommentByAccountId(t,e,i){return this.http.get(`${this.env.apiUrl}${this.entity}/GetGHRCommentByAccountId?accountId=${t}&periodTypeId=${e}&period=${i}`,{}).pipe(Object(A.a)(this.handleError))}getL1CommentByAccountId(t,e,i){return this.http.get(`${this.env.apiUrl}${this.entity}/GetL1CommentByAccountId?accountId=${t}&periodTypeId=${e}&period=${i}`,{}).pipe(Object(A.a)(this.handleError))}getL0SelfEvaluationCommentByAccountId(t,e,i){return this.http.get(`${this.env.apiUrl}${this.entity}/GetL0SelfEvaluationCommentByAccountId?accountId=${t}&periodTypeId=${e}&period=${i}`,{}).pipe(Object(A.a)(this.handleError))}getL1SelfEvaluationCommentByAccountId(t,e,i){return this.http.get(`${this.env.apiUrl}${this.entity}/GetL1SelfEvaluationCommentByAccountId?accountId=${t}&periodTypeId=${e}&period=${i}`,{}).pipe(Object(A.a)(this.handleError))}getL2SelfEvaluationCommentByAccountId(t,e,i){return this.http.get(`${this.env.apiUrl}${this.entity}/GetL2SelfEvaluationCommentByAccountId?accountId=${t}&periodTypeId=${e}&period=${i}`,{}).pipe(Object(A.a)(this.handleError))}}return t.\u0275fac=function(e){return new(e||t)(V.cc(h.b),V.cc(M.a),V.cc(S.a))},t.\u0275prov=V.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var fe=i("cp0P");let me=(()=>{class t extends Kt.a{constructor(t,e,i){super(t,"AttitudeScore",e,i)}getFisrtByObjectiveIdAndScoreBy(t,e){return this.http.get(`${this.env.apiUrl}${this.entity}/GetFisrtByObjectiveIdAndScoreBy?objectiveId=${t}&scoreby=${e}`,{}).pipe(Object(A.a)(this.handleError))}getFisrtByAccountId(t,e,i,o){return this.http.get(`${this.env.apiUrl}${this.entity}/GetFisrtByAccountId?accountId=${t}&periodTypeId=${e}&period=${i}&scoreType=${o}`,{}).pipe(Object(A.a)(this.handleError))}getFunctionalLeaderAttitudeScoreByAccountId(t,e,i){return this.http.get(`${this.env.apiUrl}${this.entity}/GetFunctionalLeaderAttitudeScoreByAccountId?accountId=${t}&periodTypeId=${e}&period=${i}`,{}).pipe(Object(A.a)(this.handleError))}getL1AttitudeScoreByAccountId(t,e,i){return this.http.get(`${this.env.apiUrl}${this.entity}/GetL1AttitudeScoreByAccountId?accountId=${t}&periodTypeId=${e}&period=${i}`,{}).pipe(Object(A.a)(this.handleError))}}return t.\u0275fac=function(e){return new(e||t)(V.cc(h.b),V.cc(M.a),V.cc(S.a))},t.\u0275prov=V.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const ye=["grid"];function ve(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic();V.Kc(" ",i.NO(t.index)," ")}}function Ie(t,e){if(1&t&&(V.Vb(0,"li"),V.Ic(1),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.Jc(t)}}function Se(t,e){if(1&t&&(V.Vb(0,"ul",30),V.Gc(1,Ie,2,1,"li",31),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.oc("ngForOf",t.l0ActionList)}}function Ue(t,e){if(1&t&&V.Qb(0,"e-column",32),2&t){const t=e.$implicit;V.oc("field",t.field)("headerText",t.headerText)}}function Ce(t,e){if(1&t&&(V.Vb(0,"table",33),V.Vb(1,"thead"),V.Vb(2,"tr"),V.Vb(3,"th",34),V.Ic(4,"Self - Evaluation"),V.Qb(5,"br"),V.Ic(6,"\u81ea\u6211\u8a55\u50f9"),V.Ub(),V.Vb(7,"th",35),V.Ic(8),V.Ub(),V.Vb(9,"th",36),V.Ic(10),V.Qb(11,"br"),V.Ic(12),V.Ub(),V.Ub(),V.Ub(),V.Ub()),2&t){const t=V.ic();V.Cb(8),V.Jc(t.selfEvaluationCommentContent),V.Cb(2),V.Kc("",(null==t.data?null:t.data.fullName)||""," Self-Score"),V.Cb(2),V.Kc("\u81ea\u8a55\u5206\u6578\uff1a",t.selfPoint,"")}}function Ve(t,e){1&t&&(V.Vb(0,"div",37),V.Vb(1,"strong",38),V.Ic(2," Please ask L0 to self score!"),V.Ub(),V.Ub())}let Te=(()=>{class t{constructor(t,e,i,o,n,c,a,r){this.activeModal=t,this.service=e,this.kpiScoreService=i,this.kpiService=o,this.commentService=n,this.alertify=c,this.attitudeScoreService=a,this.utilitiesService=r,this.toolbarOptions=["Search"],this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.fields={text:"point",value:"point"},this.filterSettings={type:"Excel"},this.content="",this.quarterlySettingsData=[],this.columns=[],this.queryCellInfoEvent=t=>{var e;const i=t.data;for(const o of this.quarterlySettingsData)(""+o).includes(t.column.field)&&(t.cell.innerText=(null===(e=i.resultOfMonth.filter(t=>t.month===o)[0])||void 0===e?void 0:e.title)||"N/A")}}ngOnInit(){this.hasFunctionalLeader=this.data.hasFunctionalLeader,this.isQuarter2Or4=this.data.period==de.Q2||this.data.period==de.Q4,this.kpiScoreModel={id:0,periodTypeId:this.data.periodTypeId,period:this.data.period,point:this.point,scoreBy:+JSON.parse(localStorage.getItem("user")).id,modifiedTime:null,createdTime:(new Date).toDateString(),accountId:this.data.id,scoreType:this.scoreType},this.commentModel={id:0,content:this.content,createdBy:+JSON.parse(localStorage.getItem("user")).id,accountId:this.data.id,modifiedBy:null,createdTime:(new Date).toDateString(),modifiedTime:null,period:this.data.period,periodTypeId:this.data.periodTypeId,scoreType:this.scoreType,commentTypeId:be.Comment},!0===this.isQuarter2Or4&&this.getFisrtSelfScoreL1ByAccountId(),this.getQuarterlySetting(),this.loadData(),this.loadKPIScoreData(),this.loadKPIData(),this.getFisrtByAccountId(),this.getFisrtCommentByObjectiveId(),this.getL1SelfEvaluationCommentByAccountId()}getFunctionalLeaderAttitudeScoreByAccountId(){this.attitudeScoreService.getFunctionalLeaderAttitudeScoreByAccountId(this.data.id,this.data.halfYearId,this.data.halfYearPeriod).subscribe(t=>{this.functionalLeaderAttitudeScoreData=(null==t?void 0:t.point)||0,this.functionalLeaderScored=this.functionalLeaderAttitudeScoreData>0})}getFunctionalLeaderCommentByAccountId(){this.commentService.getFunctionalLeaderCommentByAccountId(this.data.id,this.data.halfYearId,this.data.halfYearPeriod).subscribe(t=>{this.functionalLeaderCommentContent=null==t?void 0:t.content})}getFisrtSelfScoreL1ByAccountId(){this.kpiScoreService.getFisrtSelfScoreL1ByAccountId(this.data.id,this.data.halfYearId,this.data.halfYearPeriod,re.L0).subscribe(t=>{this.selfPoint=(null==t?void 0:t.point)||0,this.selfScored=0!==this.selfPoint})}getL1SelfEvaluationCommentByAccountId(){this.commentService.getL1SelfEvaluationCommentByAccountId(this.data.id,this.data.halfYearId,this.data.halfYearPeriod).subscribe(t=>{this.selfEvaluationCommentContent=null==t?void 0:t.content})}getMonthListInCurrentQuarter(t){return["Result of Jan.","Result of Feb.","Result of Mar.","Result of Apr.","Result of May.","Result of Jun.","Result of Jul.","Result of Aug.","Result of Sep.","Result of Oct.","Result of Nov.","Result of Dec."][t-1]}getQuarterlySetting(){this.quarterlySettingsData=this.data.settings||[],this.columns=[];for(const t of this.quarterlySettingsData)this.columns.push({field:`${t}`,headerText:this.getMonthListInCurrentQuarter(t),month:t})}loadData(){this.service.getAllKPIScoreL1ByAccountId(this.data.id,this.currentTime).subscribe(t=>{this.gridData=t})}loadKPIScoreData(){this.kpiScoreService.getById(this.data.id).subscribe(t=>{this.kpiScoreData=t})}getFisrtByAccountId(){this.kpiScoreService.getFisrtByAccountId(this.data.id,this.data.periodTypeId,this.data.period,this.scoreType).subscribe(t=>{this.point=null==t?void 0:t.point,this.kpiScoreModel.id=null==t?void 0:t.id})}getFisrtCommentByObjectiveId(){this.commentService.getFisrtByAccountId(this.data.id,this.data.periodTypeId,this.data.period,this.scoreType).subscribe(t=>{this.content=null==t?void 0:t.content,this.commentModel.id=null==t?void 0:t.id})}loadKPIData(){this.kpiService.getAll().subscribe(t=>{this.kpiData=t})}addKPIScore(){return this.kpiScoreModel.point=this.point,this.kpiScoreService.add(this.kpiScoreModel)}addComment(){return this.commentModel.content=this.content,this.commentService.add(this.commentModel)}isShowSelfScore(){return[2,4].includes(this.data.period)}finish(){if(!this.point)return void this.alertify.warning("Not yet complete. Can not submit! \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0);const t=this.addKPIScore(),e=this.addComment();Object(fe.a)([t,e]).subscribe(t=>{console.log(t),t.map(t=>t.success),t=>t.every(Boolean)?(this.alertify.success(y.a.CREATED_OK_MSG),this.service.changeMessage(!0),this.activeModal.close()):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)})}NO(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}return t.\u0275fac=function(e){return new(e||t)(V.Pb(k.a),V.Pb(ue),V.Pb(he),V.Pb(pe),V.Pb(ge),V.Pb(f.a),V.Pb(me),V.Pb(M.a))},t.\u0275cmp=V.Jb({type:t,selectors:[["app-kpi-score"]],viewQuery:function(t,e){if(1&t&&V.Mc(ye,1),2&t){let t;V.wc(t=V.gc())&&(e.grid=t.first)}},inputs:{data:"data",periodTypeCode:"periodTypeCode",scoreType:"scoreType",currentTime:"currentTime"},decls:73,vars:21,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","p-0"],["allowTextWrap","true","gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","toolbar","pageSettings","allowExcelExport","queryCellInfo"],["grid",""],["field","#","headerText","#","textAlign","Center","width","80","type","number"],["template",""],["field","objective","headerText","KPI Objective","type","string"],["field","l0TargetList","headerText","L0 Target"],["field","l0ActionList","headerText","L0 Action"],["ngFor","",3,"ngForOf"],[1,"row","mt-2","d-flex","justify-content-center"],[1,"col-md-12"],[1,"table","table-bordered"],["scope","col"],["class","table",4,"ngIf"],["class","alert alert-danger text-center","role","alert",4,"ngIf"],[1,"table",2,"border","none"],["scope","col",1,"text-center",2,"border","none","width","70%","padding","0"],["scope","col",1,"text-center",2,"border","none","width","30%","padding","0"],[2,"border","none"],[1,"form-group"],["id","comment","rows","6","type","text","placeholder","Type something!",1,"form-control",3,"ngModel","ngModelChange"],[3,"dataSource","value","fields","allowFiltering","valueChange"],["accountGroupDropdownlist",""],[1,"modal-footer","justify-content-end"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-success",3,"disabled","click"],[2,"padding","0 0 0 15px"],[4,"ngFor","ngForOf"],[3,"field","headerText"],[1,"table"],["scope","col",2,"width","20%"],["scope","col",2,"width","50%","text-align","left"],["scope","col",2,"width","30%","text-align","left"],["role","alert",1,"alert","alert-danger","text-center"],[1,"text-center"]],template:function(t,e){1&t&&(V.Vb(0,"div",0),V.Vb(1,"h4",1),V.Ic(2),V.Ub(),V.Vb(3,"button",2),V.fc("click",function(){return e.activeModal.dismiss("Cross click")}),V.Vb(4,"span",3),V.Ic(5,"\xd7"),V.Ub(),V.Ub(),V.Ub(),V.Vb(6,"div",4),V.Vb(7,"ejs-grid",5,6),V.fc("queryCellInfo",function(t){return e.queryCellInfoEvent(t)}),V.Vb(9,"e-columns"),V.Vb(10,"e-column",7),V.Gc(11,ve,1,1,"ng-template",null,8,V.Hc),V.Ub(),V.Qb(13,"e-column",9),V.Qb(14,"e-column",10),V.Vb(15,"e-column",11),V.Gc(16,Se,2,1,"ng-template",null,8,V.Hc),V.Ub(),V.Gc(18,Ue,1,2,"ng-template",12,8,V.Hc),V.Ub(),V.Ub(),V.Vb(20,"div",13),V.Vb(21,"div",14),V.Vb(22,"table",15),V.Vb(23,"thead"),V.Vb(24,"tr"),V.Vb(25,"th",16),V.Ic(26,"5>= X >=4.5 \u8d85\u51fa\u9810\u671f"),V.Ub(),V.Vb(27,"th",16),V.Ic(28,"4.5> X >=4 \u7b26\u5408\u9810\u671f"),V.Ub(),V.Vb(29,"th",16),V.Ic(30,"4 > X >=3 \u5927\u90e8\u5206\u7b26\u5408\u9810\u671f"),V.Ub(),V.Vb(31,"th",16),V.Ic(32,"3> X >=2 \u90e8\u5206\u7b26\u5408\u9810\u671f"),V.Ub(),V.Vb(33,"th",16),V.Ic(34,"2> X >= 0 \u4e0d\u4f73\u4e0d\u7b26\u5408\u9810\u671f"),V.Ub(),V.Ub(),V.Ub(),V.Vb(35,"tbody"),V.Vb(36,"tr"),V.Vb(37,"td"),V.Ic(38,"Exceed expectation"),V.Ub(),V.Vb(39,"td"),V.Ic(40,"Meet expectation"),V.Ub(),V.Vb(41,"td"),V.Ic(42,"Mostly meet expectation"),V.Ub(),V.Vb(43,"td"),V.Ic(44,"Partly meet expectation"),V.Ub(),V.Vb(45,"td"),V.Ic(46,"Poorly or not meet expectation"),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(47,"div",13),V.Vb(48,"div",14),V.Gc(49,Ce,13,3,"table",17),V.Gc(50,Ve,3,0,"div",18),V.Vb(51,"table",19),V.Vb(52,"thead"),V.Vb(53,"tr"),V.Vb(54,"th",20),V.Ic(55,"Comment"),V.Ub(),V.Vb(56,"th",21),V.Ic(57,"KPI Score"),V.Ub(),V.Ub(),V.Ub(),V.Vb(58,"tbody"),V.Vb(59,"tr"),V.Vb(60,"td",22),V.Vb(61,"div",23),V.Vb(62,"textarea",24),V.fc("ngModelChange",function(t){return e.content=t}),V.Ub(),V.Ub(),V.Ub(),V.Vb(63,"td",22),V.Vb(64,"div",23),V.Vb(65,"ejs-dropdownlist",25,26),V.fc("valueChange",function(t){return e.point=t}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(67,"div",27),V.Vb(68,"button",28),V.fc("click",function(){return e.activeModal.close("Close click")}),V.Ic(69),V.jc(70,"translate"),V.Ub(),V.Vb(71,"button",29),V.fc("click",function(){return e.finish()}),V.Ic(72),V.Ub(),V.Ub(),V.Ub()),2&t&&(V.Cb(2),V.Kc("Self-score of KPI Objective (",e.data.objective,")"),V.Cb(5),V.oc("dataSource",e.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",e.toolbarOptions)("pageSettings",e.pageSettings)("allowExcelExport",!0),V.Cb(11),V.oc("ngForOf",e.columns),V.Cb(31),V.oc("ngIf",e.isQuarter2Or4),V.Cb(1),V.oc("ngIf",e.isQuarter2Or4&&!1===e.selfScored),V.Cb(12),V.oc("ngModel",e.content),V.Cb(3),V.oc("dataSource",e.kpiData)("value",e.point)("fields",e.fields)("allowFiltering",!0),V.Cb(4),V.Jc(V.kc(70,19,"Close")),V.Cb(2),V.oc("disabled",e.isQuarter2Or4&&!1===e.selfScored||e.isQuarter2Or4&&e.hasFunctionalLeader&&!1===e.functionalLeaderScored),V.Cb(1),V.Jc("Finish"))},directives:[d.g,d.d,d.b,G.d,G.b,j.d,d.c,d.a,G.c,G.a,j.c,n.l,n.m,c.a,c.f,c.i,l.b],pipes:[a.c],styles:["#comment[_ngcontent-%COMP%]{border:2px solid #ffc107!important;font-family:Helvetica Neue,Helvetica,Arial,sans-serif,-apple-system,BlinkMacSystemFont}#comment[_ngcontent-%COMP%], #comment.form-control[_ngcontent-%COMP%]:focus{color:#212529!important;font-size:14px!important}#comment.form-control[_ngcontent-%COMP%]:focus{background-color:#fff!important;border-color:#ffc107!important;outline:0!important;box-shadow:0 0 0 .2rem rgba(32,168,216,.25)}.e-input-group.e-control-wrapper[_ngcontent-%COMP%]:not(.e-success):not(.e-warning):not(.e-error), .e-input-group[_ngcontent-%COMP%]:not(.e-success):not(.e-warning):not(.e-error){border:2px solid #ffc107!important}"]}),t})();const xe=["grid"];function we(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic();V.Kc(" ",i.NO(t.index)," ")}}let Me=(()=>{class t{constructor(t,e,i,o,n){this.activeModal=t,this.service=e,this.alertify=i,this.todolistService=o,this.datePipe=n,this.toolbarOptions=["Add","Delete","Search"],this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"}}ngOnInit(){this.targetModel={id:0,deadline:"",action:"",remark:"",parentId:0,objectiveId:this.data.id,level:ae.Target,createdBy:+JSON.parse(localStorage.getItem("user")).id,modifiedBy:null,createdTime:(new Date).toLocaleDateString(),modifiedTime:null},this.objectiveModel={id:0,deadline:"",action:"",remark:"",parentId:0,objectiveId:this.data.id,level:ae.Objective,createdBy:+JSON.parse(localStorage.getItem("user")).id,modifiedBy:null,createdTime:(new Date).toLocaleDateString(),modifiedTime:null},this.loadData()}loadData(){this.service.getAllByObjectiveId(this.data.id).subscribe(t=>{var e,i,o;if(this.gridData=t.filter(t=>3==t.level),t.length>0){const n=t.filter(t=>2==t.level)[0];this.targetModel={id:null==n?void 0:n.id,deadline:null==n?void 0:n.deadline,action:null==n?void 0:n.action,remark:null==n?void 0:n.remark,parentId:null==n?void 0:n.parentId,objectiveId:null==n?void 0:n.objectiveId,level:null==n?void 0:n.level,createdBy:null==n?void 0:n.createdBy,modifiedBy:null==n?void 0:n.modifiedBy,createdTime:null==n?void 0:n.createdTime,modifiedTime:null==n?void 0:n.modifiedTime},this.target=null===(e=this.targetModel)||void 0===e?void 0:e.action,this.deadline=null===(i=this.targetModel)||void 0===i?void 0:i.deadline;const c=t.filter(t=>1==t.level)[0];this.objectiveModel={id:null==c?void 0:c.id,deadline:null==c?void 0:c.deadline,action:null==c?void 0:c.action,remark:null==c?void 0:c.remark,parentId:null==c?void 0:c.parentId,objectiveId:null==c?void 0:c.objectiveId,level:null==c?void 0:c.level,createdBy:null==c?void 0:c.createdBy,modifiedBy:null==c?void 0:c.modifiedBy,createdTime:null==c?void 0:c.createdTime,modifiedTime:null==c?void 0:c.modifiedTime},this.objective=null===(o=this.objectiveModel)||void 0===o?void 0:o.action}})}delete(t){this.service.delete(t).subscribe(t=>{!0===t.success?(this.alertify.success(y.a.DELETED_OK_MSG),this.loadData()):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)},t=>this.alertify.warning(y.a.SYSTEM_ERROR_MSG))}actionBegin(t){"delete"===t.requestType&&t.data[0].id>0&&this.delete(t.data[0].id)}create(){this.model={id:0,deadline:"",action:"",remark:"",parentId:0,objectiveId:this.data.id,level:0,createdBy:+JSON.parse(localStorage.getItem("user")).id,modifiedBy:null,createdTime:(new Date).toLocaleDateString(),modifiedTime:null},this.service.add(this.model).subscribe(t=>{!0===t.success?(this.alertify.success(y.a.CREATED_OK_MSG),this.loadData(),this.model={}):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)},t=>{this.alertify.warning(y.a.SYSTEM_ERROR_MSG)})}isNullOrUndefined(t){return null==t}createRange(){const t=[],e=this.grid.currentViewData||[];if(console.log(this.target),console.log(this.objective),0===e.length||this.isNullOrUndefined(this.target)||this.isNullOrUndefined(this.objective)||this.isNullOrUndefined(this.deadline))return void this.alertify.warning("Not yet complete. Can not submit!",!0);this.targetModel.action=this.target,this.targetModel.deadline=this.datePipe.transform(this.deadline,"yyyy-MM-dd HH:mm:ss"),this.objectiveModel.action=this.objective,t.push(this.targetModel),t.push(this.objectiveModel);for(const n of e){const e={id:n.id,deadline:null,action:n.action,remark:"",level:ae.Action,parentId:null,objectiveId:this.data.id,createdBy:+JSON.parse(localStorage.getItem("user")).id,modifiedBy:null,createdTime:(new Date).toLocaleDateString(),modifiedTime:null};t.push(e)}const i=this.todolistService.disableReject([this.data.todolistId]),o=[this.service.addRange(t)];this.isReject&&o.push(i),Object(fe.a)(o).subscribe(t=>{console.log(t),t.map(t=>t.success),t=>t.every(Boolean)?(this.alertify.success(y.a.CREATED_OK_MSG),this.loadData(),this.activeModal.close(),this.todolistService.changeMessage(!0)):this.alertify.warning("Not yet complete. Can not submit! \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0)},t=>{this.alertify.warning(y.a.SYSTEM_ERROR_MSG)})}update(){this.service.update(this.model).subscribe(t=>{!0===t.success?(this.alertify.success(y.a.UPDATED_OK_MSG),this.loadData()):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)},t=>{this.alertify.warning(y.a.SYSTEM_ERROR_MSG)})}finish(){this.createRange()}NO(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}return t.\u0275fac=function(e){return new(e||t)(V.Pb(k.a),V.Pb(ue),V.Pb(f.a),V.Pb(ue),V.Pb(n.e))},t.\u0275cmp=V.Jb({type:t,selectors:[["app-action"]],viewQuery:function(t,e){if(1&t&&V.Mc(xe,1),2&t){let t;V.wc(t=V.gc())&&(e.grid=t.first)}},inputs:{data:"data",isReject:"isReject"},features:[V.Bb([n.e])],decls:39,vars:13,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","p-0"],[1,"d-flex"],[1,"flex-fill",2,"width","60%","padding","0 5px 0 5px"],[1,"flex-fill",2,"width","24%","padding","0 5px 0 5px"],[1,"form-group"],["for","title",1,"d-flex","justify-content-center",2,"font-weight","Bold","font-size","14px","margin-top","52px"],["id","title","rows","10","type","text","placeholder","Type something!",1,"form-control",3,"ngModel","ngModelChange"],[1,"flex-fill",2,"width","24%","padding","0 5px 0 0px"],["id","deadline",1,"flex-fill",2,"width","12%","padding","0 5px 0 0px"],["format","yyyy/MM/dd",3,"value","valueChange"],[1,"flex-fill",2,"width","40%","padding","5px 5px 5px 0"],["allowTextWrap","true",3,"dataSource","allowResizing","toolbar","editSettings","allowExcelExport","actionBegin"],["grid",""],["field","#","headerText","#","textAlign","Center","width","20","type","number",3,"allowEditing"],["template",""],["field","id","headerText","Id","type","number",3,"visible"],["field","action","textAlign","Left","headerTextAlign","Center","headerText","Action"],[1,"modal-footer","justify-content-end"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-success",3,"click"]],template:function(t,e){1&t&&(V.Vb(0,"div",0),V.Vb(1,"h4",1),V.Ic(2),V.Ub(),V.Vb(3,"button",2),V.fc("click",function(){return e.activeModal.dismiss("Cross click")}),V.Vb(4,"span",3),V.Ic(5,"\xd7"),V.Ub(),V.Ub(),V.Ub(),V.Vb(6,"div",4),V.Vb(7,"div",5),V.Vb(8,"div",6),V.Vb(9,"div",5),V.Vb(10,"div",7),V.Vb(11,"div",8),V.Vb(12,"label",9),V.Ic(13,"My Objective"),V.Ub(),V.Vb(14,"textarea",10),V.fc("ngModelChange",function(t){return e.objective=t}),V.Ub(),V.Ub(),V.Ub(),V.Vb(15,"div",11),V.Vb(16,"div",8),V.Vb(17,"label",9),V.Ic(18,"Target"),V.Ub(),V.Vb(19,"textarea",10),V.fc("ngModelChange",function(t){return e.target=t}),V.Ub(),V.Ub(),V.Ub(),V.Vb(20,"div",12),V.Vb(21,"div",8),V.Vb(22,"label",9),V.Ic(23,"Deadline"),V.Ub(),V.Vb(24,"ejs-datepicker",13),V.fc("valueChange",function(t){return e.deadline=t}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(25,"div",14),V.Vb(26,"ejs-grid",15,16),V.fc("actionBegin",function(t){return e.actionBegin(t)}),V.Vb(28,"e-columns"),V.Vb(29,"e-column",17),V.Gc(30,we,1,1,"ng-template",null,18,V.Hc),V.Ub(),V.Qb(32,"e-column",19),V.Qb(33,"e-column",20),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(34,"div",21),V.Vb(35,"button",22),V.fc("click",function(){return e.activeModal.close("Close click")}),V.Ic(36),V.Ub(),V.Vb(37,"button",23),V.fc("click",function(){return e.finish()}),V.Ic(38),V.Ub(),V.Ub()),2&t&&(V.Cb(2),V.Kc("Action of KPI Objective (",e.data.topic,")"),V.Cb(12),V.oc("ngModel",e.objective),V.Cb(5),V.oc("ngModel",e.target),V.Cb(5),V.oc("value",e.deadline),V.Cb(2),V.oc("dataSource",e.gridData)("allowResizing",!0)("toolbar",e.toolbarOptions)("editSettings",e.editSettings)("allowExcelExport",!0),V.Cb(3),V.oc("allowEditing",!1),V.Cb(3),V.oc("visible",!1),V.Cb(4),V.Jc("Close"),V.Cb(2),V.Jc("Finish"))},directives:[c.a,c.f,c.i,o.a,d.g,d.d,d.b,G.d,G.b,j.d,d.c,d.a,G.c,G.a,j.c],styles:["#title[_ngcontent-%COMP%]{border:2px solid #ffc107!important;font-family:Helvetica Neue,Helvetica,Arial,sans-serif,-apple-system,BlinkMacSystemFont}#title[_ngcontent-%COMP%], #title.form-control[_ngcontent-%COMP%]:focus{color:#212529!important;font-size:14px!important}#title.form-control[_ngcontent-%COMP%]:focus{background-color:#fff!important;border-color:#ffc107!important;outline:0!important;box-shadow:0 0 0 .2rem rgba(32,168,216,.25)}#deadline[_ngcontent-%COMP%]   .e-input-group[_ngcontent-%COMP%], #deadline[_ngcontent-%COMP%]   .e-input-group[_ngcontent-%COMP%]   .e-control-wrapper[_ngcontent-%COMP%]   .e-date-wrapper[_ngcontent-%COMP%]{border:2px solid #ffc107!important}"]}),t})();const De=["grid"];function Ae(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic();V.Kc(" ",i.NO(t.index)," ")}}function Oe(t,e){if(1&t&&(V.Vb(0,"ul",31),V.Vb(1,"li"),V.Ic(2),V.Ub(),V.Ub()),2&t){const t=e.$implicit;V.Cb(2),V.Jc(t)}}function Pe(t,e){1&t&&V.Gc(0,Oe,3,1,"ul",30),2&t&&V.oc("ngForOf",e.$implicit.l0ActionList)}function ke(t,e){if(1&t&&V.Qb(0,"e-column",32),2&t){const t=e.$implicit;V.oc("field",t.field)("headerText",t.headerText)}}function Le(t,e){if(1&t&&(V.Vb(0,"table",33),V.Vb(1,"thead"),V.Vb(2,"tr"),V.Vb(3,"th",34),V.Ic(4,"Functional leader comment"),V.Qb(5,"br"),V.Ic(6," \u529f\u80fd\u4e3b\u7ba1\u8a55\u8a9e"),V.Ub(),V.Vb(7,"th",35),V.Ic(8),V.Ub(),V.Vb(9,"th",34),V.Ic(10,"Functional leader score"),V.Qb(11,"br"),V.Ic(12,"\u529f\u80fd\u4e3b\u7ba1\u8a55\u5206"),V.Ub(),V.Vb(13,"th",36),V.Ic(14),V.Ub(),V.Ub(),V.Ub(),V.Ub()),2&t){const t=V.ic();V.Cb(8),V.Jc(t.functionalLeaderCommentContent||""),V.Cb(6),V.Jc(t.functionalLeaderAttitudeScoreData||0)}}function Ge(t,e){1&t&&(V.Vb(0,"div",37),V.Vb(1,"strong",38),V.Ic(2," Please ask functional leader to score attitude score L0!"),V.Ub(),V.Ub())}let je=(()=>{class t{constructor(t,e,i,o,n,c,a,r,s){this.activeModal=t,this.service=e,this.kpiScoreService=i,this.attitudeScoreService=o,this.kpiService=n,this.commentService=c,this.alertify=a,this.todolistService=r,this.utilitiesService=s,this.toolbarOptions=["Search"],this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.fields={text:"point",value:"point"},this.filterSettings={type:"Excel"},this.content="",this.quarterlySettingsData=[],this.columns=[],this.hasFunctionalLeader=!1,this.queryCellInfoEvent=t=>{var e;const i=t.data;for(const o of this.quarterlySettingsData)(""+o).includes(t.column.field)&&(t.cell.innerText=(null===(e=i.resultOfMonth.filter(t=>t.month===o)[0])||void 0===e?void 0:e.title)||"N/A")}}ngOnInit(){this.hasFunctionalLeader=this.data.hasFunctionalLeader,this.isQuarter2Or4=this.data.period==de.Q2||this.data.period==de.Q4,this.kpiScoreModel={id:0,periodTypeId:this.data.periodTypeId,period:this.data.period,point:this.point,scoreBy:+JSON.parse(localStorage.getItem("user")).id,modifiedTime:null,createdTime:(new Date).toDateString(),accountId:+JSON.parse(localStorage.getItem("user")).id,scoreType:this.scoreType},this.commentModel={id:0,content:this.content,createdBy:+JSON.parse(localStorage.getItem("user")).id,accountId:+JSON.parse(localStorage.getItem("user")).id,modifiedBy:null,createdTime:(new Date).toDateString(),modifiedTime:null,period:this.data.period,periodTypeId:this.data.periodTypeId,scoreType:this.scoreType,commentTypeId:be.SelfEvaluation},!0===this.hasFunctionalLeader&&(this.getFunctionalLeaderCommentByAccountId(),this.getFunctionalLeaderAttitudeScoreByAccountId()),this.getQuarterlySetting(),this.loadData(),this.loadKPIData(),this.getFisrtSelfScoreByAccountId(),this.getL0SelfEvaluationCommentByAccountId()}getMonthListInCurrentQuarter(t){return["Result of Jan.","Result of Feb.","Result of Mar.","Result of Apr.","Result of May.","Result of Jun.","Result of Jul.","Result of Aug.","Result of Sep.","Result of Oct.","Result of Nov.","Result of Dec."][t-1]}getQuarterlySetting(){this.quarterlySettingsData=this.data.settings||[],this.columns=[];for(const t of this.quarterlySettingsData)this.columns.push({field:`${t}`,headerText:this.getMonthListInCurrentQuarter(t),month:t})}loadData(){this.service.getAllKPIScoreL0ByPeriod(this.data.period).subscribe(t=>{this.gridData=t})}getFunctionalLeaderAttitudeScoreByAccountId(){this.attitudeScoreService.getFunctionalLeaderAttitudeScoreByAccountId(+JSON.parse(localStorage.getItem("user")).id,this.data.halfYearId,this.data.period).subscribe(t=>{this.functionalLeaderAttitudeScoreData=(null==t?void 0:t.point)||0,this.functionalLeaderScored=0!==this.functionalLeaderAttitudeScoreData})}getFisrtSelfScoreByAccountId(){this.kpiScoreService.getFisrtSelfScoreByAccountId(+JSON.parse(localStorage.getItem("user")).id,this.data.periodTypeId,this.data.period,this.scoreType).subscribe(t=>{this.point=null==t?void 0:t.point,this.kpiScoreModel.id=null==t?void 0:t.id})}getL0SelfEvaluationCommentByAccountId(){this.commentService.getL0SelfEvaluationCommentByAccountId(+JSON.parse(localStorage.getItem("user")).id,this.data.periodTypeId,this.data.period).subscribe(t=>{this.content=null==t?void 0:t.content,this.commentModel.id=null==t?void 0:t.id})}getFunctionalLeaderCommentByAccountId(){this.commentService.getFunctionalLeaderCommentByAccountId(+JSON.parse(localStorage.getItem("user")).id,this.data.halfYearId,this.data.period).subscribe(t=>{this.functionalLeaderCommentContent=null==t?void 0:t.content})}loadKPIData(){this.kpiService.getAll().subscribe(t=>{this.kpiData=t})}addKPIScore(){return this.kpiScoreModel.point=this.point,this.kpiScoreService.add(this.kpiScoreModel)}addComment(){return this.commentModel.content=this.content,this.commentService.add(this.commentModel)}finish(){if(0!=this.point&&this.utilitiesService.isUndefinedOrNullOrEmpty(this.content))return void this.alertify.warning("Please leave a Self - Evaluation! <br>Not yet complete. Can not submit! \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0);if(0===this.point&&!this.utilitiesService.isUndefinedOrNullOrEmpty(this.content))return void this.alertify.warning("Please choose a special score. <br>Not yet complete. Can not submit! \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0);const t=this.addKPIScore(),e=this.addComment();Object(fe.a)([t,e]).subscribe(t=>{console.log(t),t.map(t=>t.success),t=>t.every(Boolean)?(this.alertify.success(y.a.CREATED_OK_MSG),this.todolistService.changeMessage(!0),this.activeModal.close()):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)})}NO(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}return t.\u0275fac=function(e){return new(e||t)(V.Pb(k.a),V.Pb(ue),V.Pb(he),V.Pb(me),V.Pb(pe),V.Pb(ge),V.Pb(f.a),V.Pb(ue),V.Pb(M.a))},t.\u0275cmp=V.Jb({type:t,selectors:[["app-self-score"]],viewQuery:function(t,e){if(1&t&&V.Mc(De,1),2&t){let t;V.wc(t=V.gc())&&(e.grid=t.first)}},inputs:{data:"data",periodTypeCode:"periodTypeCode",scoreType:"scoreType"},decls:74,vars:18,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","p-0"],["allowTextWrap","true","gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","toolbar","pageSettings","allowExcelExport","queryCellInfo"],["grid",""],["field","#","headerText","#","textAlign","Center","width","30","type","number"],["template",""],["field","objective","headerText","KPI Objective","type","string"],["field","l0TargetList","headerText","L0 Target"],["field","l0ActionList","headerText","L0 Action"],["ngFor","",3,"ngForOf"],[1,"row","mt-2","d-flex","justify-content-center"],[1,"col-md-12"],[1,"table","table-bordered"],["scope","col"],["class","table",4,"ngIf"],["class","alert alert-danger text-center","role","alert",4,"ngIf"],[1,"table",2,"border","none"],["scope","col",1,"text-center",2,"border","none","width","60%","padding","0"],["scope","col",1,"text-center",2,"border","none","width","20%","padding","0"],[2,"border","none"],[1,"form-group"],["id","comment","rows","6","type","text","placeholder","Type something!",1,"form-control",3,"ngModel","ngModelChange"],[3,"dataSource","value","fields","allowFiltering","valueChange"],["accountGroupDropdownlist",""],[1,"modal-footer","justify-content-end"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-success",3,"disabled","click"],["style","padding: 0 0 0 15px;",4,"ngFor","ngForOf"],[2,"padding","0 0 0 15px"],[3,"field","headerText"],[1,"table"],["scope","col",2,"width","20%"],["scope","col",2,"width","50%"],["scope","col",2,"width","10%","text-align","center","font-size","xx-large"],["role","alert",1,"alert","alert-danger","text-center"],[1,"text-center"]],template:function(t,e){1&t&&(V.Vb(0,"div",0),V.Vb(1,"h4",1),V.Ic(2,"Self-score quarter \u6bcf\u5b63\u81ea\u8a55"),V.Ub(),V.Vb(3,"button",2),V.fc("click",function(){return e.activeModal.dismiss("Cross click")}),V.Vb(4,"span",3),V.Ic(5,"\xd7"),V.Ub(),V.Ub(),V.Ub(),V.Vb(6,"div",4),V.Vb(7,"ejs-grid",5,6),V.fc("queryCellInfo",function(t){return e.queryCellInfoEvent(t)}),V.Vb(9,"e-columns"),V.Vb(10,"e-column",7),V.Gc(11,Ae,1,1,"ng-template",null,8,V.Hc),V.Ub(),V.Qb(13,"e-column",9),V.Qb(14,"e-column",10),V.Vb(15,"e-column",11),V.Gc(16,Pe,1,1,"ng-template",null,8,V.Hc),V.Ub(),V.Gc(18,ke,1,2,"ng-template",12,8,V.Hc),V.Ub(),V.Ub(),V.Vb(20,"div",13),V.Vb(21,"div",14),V.Vb(22,"table",15),V.Vb(23,"thead"),V.Vb(24,"tr"),V.Vb(25,"th",16),V.Ic(26,"5>= X >=4.5 \u8d85\u51fa\u9810\u671f"),V.Ub(),V.Vb(27,"th",16),V.Ic(28,"4.5> X >=4 \u7b26\u5408\u9810\u671f"),V.Ub(),V.Vb(29,"th",16),V.Ic(30,"4 > X >=3 \u5927\u90e8\u5206\u7b26\u5408\u9810\u671f"),V.Ub(),V.Vb(31,"th",16),V.Ic(32,"3> X >=2 \u90e8\u5206\u7b26\u5408\u9810\u671f"),V.Ub(),V.Vb(33,"th",16),V.Ic(34,"2> X >= 0 \u4e0d\u4f73\u4e0d\u7b26\u5408\u9810\u671f"),V.Ub(),V.Ub(),V.Ub(),V.Vb(35,"tbody"),V.Vb(36,"tr"),V.Vb(37,"td"),V.Ic(38,"Exceed expectation"),V.Ub(),V.Vb(39,"td"),V.Ic(40,"Meet expectation"),V.Ub(),V.Vb(41,"td"),V.Ic(42,"Mostly meet expectation"),V.Ub(),V.Vb(43,"td"),V.Ic(44,"Partly meet expectation"),V.Ub(),V.Vb(45,"td"),V.Ic(46,"Poorly or not meet expectation"),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(47,"div",13),V.Vb(48,"div",14),V.Gc(49,Le,15,2,"table",17),V.Gc(50,Ge,3,0,"div",18),V.Vb(51,"table",19),V.Vb(52,"thead"),V.Vb(53,"tr"),V.Vb(54,"th",20),V.Ic(55,"Self - Evaluation \u81ea\u6211\u8a55\u50f9"),V.Ub(),V.Vb(56,"th",21),V.Ic(57,"Self-Score "),V.Qb(58,"br"),V.Ic(59,"\u81ea\u8a55"),V.Ub(),V.Ub(),V.Ub(),V.Vb(60,"tbody"),V.Vb(61,"tr"),V.Vb(62,"td",22),V.Vb(63,"div",23),V.Vb(64,"textarea",24),V.fc("ngModelChange",function(t){return e.content=t}),V.Ub(),V.Ub(),V.Ub(),V.Vb(65,"td",22),V.Vb(66,"div",23),V.Vb(67,"ejs-dropdownlist",25,26),V.fc("valueChange",function(t){return e.point=t}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(69,"div",27),V.Vb(70,"button",28),V.fc("click",function(){return e.activeModal.close("Close click")}),V.Ic(71),V.Ub(),V.Vb(72,"button",29),V.fc("click",function(){return e.finish()}),V.Ic(73),V.Ub(),V.Ub(),V.Ub()),2&t&&(V.Cb(7),V.oc("dataSource",e.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",e.toolbarOptions)("pageSettings",e.pageSettings)("allowExcelExport",!0),V.Cb(11),V.oc("ngForOf",e.columns),V.Cb(31),V.oc("ngIf",e.hasFunctionalLeader),V.Cb(1),V.oc("ngIf",e.hasFunctionalLeader&&!1===e.functionalLeaderScored),V.Cb(14),V.oc("ngModel",e.content),V.Cb(3),V.oc("dataSource",e.kpiData)("value",e.point)("fields",e.fields)("allowFiltering",!0),V.Cb(4),V.Jc("Close"),V.Cb(1),V.oc("disabled",e.hasFunctionalLeader&&!1===e.functionalLeaderScored),V.Cb(1),V.Jc("Finish"))},directives:[d.g,d.d,d.b,G.d,G.b,j.d,d.c,d.a,G.c,G.a,j.c,n.l,n.m,c.a,c.f,c.i,l.b],styles:["#comment[_ngcontent-%COMP%]{border:2px solid #ffc107!important;font-family:Helvetica Neue,Helvetica,Arial,sans-serif,-apple-system,BlinkMacSystemFont}#comment[_ngcontent-%COMP%], #comment.form-control[_ngcontent-%COMP%]:focus{color:#212529!important;font-size:14px!important}#comment.form-control[_ngcontent-%COMP%]:focus{background-color:#fff!important;border-color:#ffc107!important;outline:0!important;box-shadow:0 0 0 .2rem rgba(32,168,216,.25)}.e-input-group.e-control-wrapper[_ngcontent-%COMP%]:not(.e-success):not(.e-warning):not(.e-error), .e-input-group[_ngcontent-%COMP%]:not(.e-success):not(.e-warning):not(.e-error){border:2px solid #ffc107!important}"]}),t})(),Re=(()=>{class t extends Kt.a{constructor(t,e,i){super(t,"ResultOfMonth",e,i)}getAllByMonth(t,e){return this.http.get(`${this.env.apiUrl}${this.entity}/GetAllByMonth?objectiveId=${t}&currentTime=${e}`,{}).pipe(Object(A.a)(this.handleError))}updateResultOfMonth(t){return this.http.put(`${this.env.apiUrl}${this.entity}/UpdateResultOfMonth`,t).pipe(Object(A.a)(this.handleError))}}return t.\u0275fac=function(e){return new(e||t)(V.cc(h.b),V.cc(M.a),V.cc(S.a))},t.\u0275prov=V.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const $e=["grid"];function Fe(t,e){if(1&t&&(V.Vb(0,"li"),V.Ic(1),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.Jc(t.entity.action)}}function Ee(t,e){if(1&t&&(V.Vb(0,"ul",20),V.Gc(1,Fe,2,1,"li",21),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.oc("ngForOf",t.childNodes[0].childNodes)}}function Be(t,e){if(1&t){const t=V.Wb();V.Vb(0,"table",22),V.Vb(1,"thead"),V.Vb(2,"tr"),V.Vb(3,"th",23),V.Ic(4,"GHR Comment"),V.Ub(),V.Ub(),V.Ub(),V.Vb(5,"tbody"),V.Vb(6,"tr"),V.Vb(7,"td",24),V.Vb(8,"div",14),V.Vb(9,"textarea",25),V.fc("ngModelChange",function(e){return V.Ac(t),V.ic().content=e}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub()}if(2&t){const t=V.ic();V.Cb(9),V.oc("ngModel",t.content)}}let _e=(()=>{class t{constructor(t,e,i,o,n,c,a){this.activeModal=t,this.service=e,this.todolistService=i,this.alertify=o,this.commentService=n,this.resultOfMonthService=c,this.datePipe=a,this.toolbarOptions=["Search"],this.toolbarOptions2=[""],this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"}}ngOnInit(){this.currentTimeRequest=this.datePipe.transform(this.currentTime,"YYYY-MM-dd HH:mm"),this.title="",this.isReject&&this.getGHRCommentByAccountId(),this.loadCurrentResultOfMonthData(),this.loadData(),this.model={id:0,objectiveId:this.data.id,title:"",createdBy:+JSON.parse(localStorage.getItem("user")).id,period:this.data.period}}getMonthText(){return["Result of Jan.","Result of Feb.","Result of Mar.","Result of Apr.","Result of May.","Result of Jun.","Result of Jul.","Result of Aug.","Result of Sep.","Result of Oct.","Result of Nov.","Result of Dec."][this.currentTime.getMonth()]}getTitleText(){return["Jan.","Feb.","Mar.","Apr.","May.","Jun.","Jul.","Aug.","Sep.","Oct.","Nov.","Dec."][this.currentTime.getMonth()]}loadData(){this.todolistService.getAllByObjectiveIdAsTree(this.data.id).subscribe(t=>{this.gridData=t})}getGHRCommentByAccountId(){this.commentService.getGHRCommentByAccountId(+JSON.parse(localStorage.getItem("user")).id,this.data.quarterPeriodTypeId,this.data.quarter).subscribe(t=>{this.content=null==t?void 0:t.content})}loadCurrentResultOfMonthData(){this.resultOfMonthService.getAllByMonth(this.data.id,this.currentTimeRequest).subscribe(t=>{var e;this.gridResultOfMonthData=t||[],this.title=null===(e=t[0])||void 0===e?void 0:e.title})}updateResultOfMonth(){var t;const e=this.gridResultOfMonthData||[];if(!this.title)return void this.alertify.warning("Not yet complete. Can not submit! \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0);this.model.title=this.title,this.model.id=(null===(t=e[0])||void 0===t?void 0:t.id)||0;const i=this.resultOfMonthService.updateResultOfMonth(this.model),o=this.todolistService.disableReject([this.data.todolistId]),n=[i];this.isReject&&n.push(o),Object(fe.a)(n).subscribe(t=>{console.log(t),t.map(t=>t.success),t=>t.every(Boolean)?(this.alertify.success(y.a.UPDATED_OK_MSG),this.loadCurrentResultOfMonthData(),this.todolistService.changeMessage(!0),this.activeModal.close()):this.alertify.warning("Not yet complete. Can not submit! \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0)},t=>{this.alertify.warning("Not yet complete. Can not submit! \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0)})}finish(){this.updateResultOfMonth()}NO(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}return t.\u0275fac=function(e){return new(e||t)(V.Pb(k.a),V.Pb(Ht),V.Pb(ue),V.Pb(f.a),V.Pb(ge),V.Pb(Re),V.Pb(n.e))},t.\u0275cmp=V.Jb({type:t,selectors:[["app-update-result"]],viewQuery:function(t,e){if(1&t&&V.Mc($e,1),2&t){let t;V.wc(t=V.gc())&&(e.grid=t.first)}},inputs:{data:"data",isReject:"isReject",currentTime:"currentTime"},features:[V.Bb([n.e])],decls:27,vars:11,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","p-0"],[1,"d-flex"],[1,"flex-fill",2,"width","70%","padding","5px 0 5px 5px"],["allowTextWrap","true","allowTextWrap","true","gridLines","Both",3,"dataSource","allowResizing","showColumnMenu","allowExcelExport","toolbar"],["grid",""],["field","entity.action","headerText","Your Objective","type","string"],["field","action","headerText","Action"],["template",""],["class","table ","style","border: none;",4,"ngIf"],[1,"flex-fill",2,"width","30%","padding","0 5px 0 5px"],[1,"form-group"],["for","title",1,"d-flex","justify-content-center",2,"font-weight","Bold","font-size","14px","margin-top","52px"],["id","title","rows","10","type","text","placeholder","Type something!",1,"form-control",3,"ngModel","ngModelChange"],[1,"modal-footer","justify-content-end"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-success",3,"click"],[2,"padding","0 0 0 15px"],[4,"ngFor","ngForOf"],[1,"table",2,"border","none"],["scope","col",1,"text-center",2,"border","none","width","70%","padding","0"],[2,"border","none"],["id","comment","rows","6","type","text","placeholder","Type something!",1,"form-control",3,"ngModel","ngModelChange"]],template:function(t,e){1&t&&(V.Vb(0,"div",0),V.Vb(1,"h4",1),V.Ic(2),V.Ub(),V.Vb(3,"button",2),V.fc("click",function(){return e.activeModal.dismiss("Cross click")}),V.Vb(4,"span",3),V.Ic(5,"\xd7"),V.Ub(),V.Ub(),V.Ub(),V.Vb(6,"div",4),V.Vb(7,"div",5),V.Vb(8,"div",6),V.Vb(9,"ejs-grid",7,8),V.Vb(11,"e-columns"),V.Qb(12,"e-column",9),V.Vb(13,"e-column",10),V.Gc(14,Ee,2,1,"ng-template",null,11,V.Hc),V.Ub(),V.Ub(),V.Ub(),V.Gc(16,Be,10,1,"table",12),V.Ub(),V.Vb(17,"div",13),V.Vb(18,"div",14),V.Vb(19,"label",15),V.Ic(20),V.Ub(),V.Vb(21,"textarea",16),V.fc("ngModelChange",function(t){return e.title=t}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(22,"div",17),V.Vb(23,"button",18),V.fc("click",function(){return e.activeModal.close("Close click")}),V.Ic(24),V.Ub(),V.Vb(25,"button",19),V.fc("click",function(){return e.finish()}),V.Ic(26),V.Ub(),V.Ub()),2&t&&(V.Cb(2),V.Kc("Update result of KPI Objective (",e.data.topic,")"),V.Cb(7),V.oc("dataSource",e.gridData)("allowResizing",!0)("showColumnMenu",!0)("allowExcelExport",!0)("toolbar",e.toolbarOptions),V.Cb(7),V.oc("ngIf",e.isReject),V.Cb(4),V.Kc("Result of ",e.data.topic.split(" - ")[0],""),V.Cb(1),V.oc("ngModel",e.title),V.Cb(3),V.Jc("Close"),V.Cb(2),V.Jc("Finish"))},directives:[d.g,d.d,d.b,G.d,G.b,j.d,d.c,d.a,G.c,G.a,j.c,n.m,c.a,c.f,c.i,n.l],styles:["#title[_ngcontent-%COMP%]{border:2px solid #ffc107!important;font-family:Helvetica Neue,Helvetica,Arial,sans-serif,-apple-system,BlinkMacSystemFont}#title[_ngcontent-%COMP%], #title.form-control[_ngcontent-%COMP%]:focus{color:#212529!important;font-size:14px!important}#title.form-control[_ngcontent-%COMP%]:focus{background-color:#fff!important;border-color:#ffc107!important;outline:0!important;box-shadow:0 0 0 .2rem rgba(32,168,216,.25)}"]}),t})(),Ne=(()=>{class t extends Kt.a{constructor(t,e,i){super(t,"SpecialScore",e,i)}}return t.\u0275fac=function(e){return new(e||t)(V.cc(h.b),V.cc(M.a),V.cc(S.a))},t.\u0275prov=V.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Ke=(()=>{class t extends Kt.a{constructor(t,e,i){super(t,"Contribution",e,i)}getFisrtByAccountId(t,e,i,o){return this.http.get(`${this.env.apiUrl}${this.entity}/GetFisrtByAccountId?accountId=${t}&periodTypeId=${e}&period=${i}&scoreType=${o}`,{}).pipe(Object(A.a)(this.handleError))}getL1CommentByAccountId(t,e,i){return this.http.get(`${this.env.apiUrl}${this.entity}/GetL1CommentByAccountId?accountId=${t}&periodTypeId=${e}&period=${i}`,{}).pipe(Object(A.a)(this.handleError))}}return t.\u0275fac=function(e){return new(e||t)(V.cc(h.b),V.cc(M.a),V.cc(S.a))},t.\u0275prov=V.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),He=(()=>{class t extends Kt.a{constructor(t,e,i){super(t,"Attitude",e,i)}}return t.\u0275fac=function(e){return new(e||t)(V.cc(h.b),V.cc(M.a),V.cc(S.a))},t.\u0275prov=V.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Je=(()=>{class t extends Kt.a{constructor(t,e,i){super(t,"SpecialContributionScore",e,i)}getFisrtByObjectiveIdAndScoreBy(t,e){return this.http.get(`${this.env.apiUrl}${this.entity}/GetFisrtByObjectiveIdAndScoreBy?objectiveId=${t}&scoreby=${e}`,{}).pipe(Object(A.a)(this.handleError))}getFisrtByAccountId(t,e,i,o){return this.http.get(`${this.env.apiUrl}${this.entity}/GetFisrtByAccountId?accountId=${t}&periodTypeId=${e}&period=${i}&scoreType=${o}`,{}).pipe(Object(A.a)(this.handleError))}getSpecialScoreByAccountId(t,e,i,o){return this.http.get(`${this.env.apiUrl}${this.entity}/GetSpecialScoreByAccountId?accountId=${t}&periodTypeId=${e}&period=${i}&scoreType=${o}`,{}).pipe(Object(A.a)(this.handleError))}}return t.\u0275fac=function(e){return new(e||t)(V.cc(h.b),V.cc(M.a),V.cc(S.a))},t.\u0275prov=V.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const ze=["grid"];function Qe(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic();V.Kc(" ",i.NO(t.index)," ")}}function Ye(t,e){if(1&t&&(V.Vb(0,"li"),V.Ic(1),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.Jc(t)}}function qe(t,e){if(1&t&&(V.Vb(0,"ul",29),V.Gc(1,Ye,2,1,"li",30),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.oc("ngForOf",t.l0ActionList)}}function We(t,e){if(1&t&&V.Qb(0,"e-column",31),2&t){const t=e.$implicit;V.oc("field",t.field)("headerText",t.headerText)}}function Xe(t,e){if(1&t&&(V.Vb(0,"table",32),V.Vb(1,"thead"),V.Vb(2,"tr"),V.Vb(3,"th",33),V.Ic(4,"Functional leader comment"),V.Qb(5,"br"),V.Ic(6," \u529f\u80fd\u4e3b\u7ba1\u8a55\u8a9e"),V.Ub(),V.Vb(7,"th",34),V.Ic(8),V.Ub(),V.Vb(9,"th",33),V.Ic(10,"Functional leader score"),V.Qb(11,"br"),V.Ic(12,"\u529f\u80fd\u4e3b\u7ba1\u8a55\u5206"),V.Ub(),V.Vb(13,"th",35),V.Ic(14),V.Ub(),V.Ub(),V.Ub(),V.Ub()),2&t){const t=V.ic();V.Cb(8),V.Jc(t.functionalLeaderCommentContent||""),V.Cb(6),V.Jc(t.functionalLeaderAttitudeScoreData||0)}}let Ze=(()=>{class t{constructor(t,e,i,o,n,c,a,r,s,l){this.activeModal=t,this.service=e,this.attitudeScoreService=i,this.attitudeService=o,this.contributionService=n,this.specialScoreService=c,this.specialContributionScoreService=a,this.commentService=r,this.alertify=s,this.utilitiesService=l,this.toolbarOptions=["Search"],this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.specialPoint=0,this.fields={text:"point",value:"point"},this.filterSettings={type:"Excel"},this.content="",this.specialContent="",this.commentContent="",this.queryCellInfoEvent=t=>{var e;const i=t.data;for(const o of this.halfYearSettingsData)(""+o).includes(t.column.field)&&(t.cell.innerText=(null===(e=i.resultOfMonth.filter(t=>t.month===o)[0])||void 0===e?void 0:e.title)||"N/A")}}ngOnInit(){this.hasFunctionalLeader=this.data.hasFunctionalLeader,this.attitudeScoreModel={id:0,periodTypeId:this.data.periodTypeId,period:this.data.period,point:this.point,accountId:this.data.id,scoreBy:+JSON.parse(localStorage.getItem("user")).id,createdTime:(new Date).toDateString(),modifiedTime:null,scoreType:this.scoreType},this.specialContributionScoreModel={id:0,periodTypeId:this.data.periodTypeId,period:this.data.period,point:this.specialPoint,accountId:this.data.id,scoreBy:+JSON.parse(localStorage.getItem("user")).id,createdTime:(new Date).toDateString(),modifiedTime:null,scoreType:this.scoreType},this.contributionModel={id:0,content:this.content,createdBy:+JSON.parse(localStorage.getItem("user")).id,accountId:this.data.id,modifiedBy:null,createdTime:(new Date).toDateString(),modifiedTime:null,periodTypeId:this.data.periodTypeId,period:this.data.period,scoreType:this.scoreType},this.commentModel={id:0,content:this.content,createdBy:+JSON.parse(localStorage.getItem("user")).id,accountId:this.data.id,modifiedBy:null,createdTime:(new Date).toDateString(),modifiedTime:null,period:this.data.period,periodTypeId:this.data.periodTypeId,scoreType:this.scoreType,commentTypeId:be.SelfEvaluation},!0===this.hasFunctionalLeader&&(this.getFunctionalLeaderCommentByAccountId(),this.getFunctionalLeaderAttitudeScoreByAccountId()),this.getHalfYearSetting(),this.loadData(),this.loadAttitudeScoreData(),this.loadAttitudeData(),this.loadSpecialScoreData(),this.getFisrtByObjectiveIdAndScoreBy(),this.getFisrtContributionByObjectiveId(),this.getFisrtCommentByObjectiveId(),this.getFisrtSpecialContributionScoreByObjectiveIdAndScoreBy()}getMonthListInCurrentQuarter(t){return["Result of Jan.","Result of Feb.","Result of Mar.","Result of Apr.","Result of May.","Result of Jun.","Result of Jul.","Result of Aug.","Result of Sep.","Result of Oct.","Result of Nov.","Result of Dec."][t-1]}getHalfYearSetting(){this.halfYearSettingsData=this.data.settings||[],this.columns=[];for(const t of this.halfYearSettingsData)this.columns.push({field:`${t}`,headerText:this.getMonthListInCurrentQuarter(t),month:t})}loadData(){this.service.getAllAttitudeScoreL1ByAccountId(this.data.id).subscribe(t=>{this.gridData=t})}loadAttitudeScoreData(){this.attitudeScoreService.getById(this.data.id).subscribe(t=>{this.attitudeScoreData=t})}getFunctionalLeaderAttitudeScoreByAccountId(){this.attitudeScoreService.getFunctionalLeaderAttitudeScoreByAccountId(this.data.id,this.data.periodTypeId,this.data.period).subscribe(t=>{this.functionalLeaderAttitudeScoreData=(null==t?void 0:t.point)||0})}getFisrtByObjectiveIdAndScoreBy(){this.attitudeScoreService.getFisrtByAccountId(this.data.id,this.data.periodTypeId,this.data.period,this.scoreType).subscribe(t=>{this.point=null==t?void 0:t.point,this.attitudeScoreModel.id=null==t?void 0:t.id})}getFisrtContributionByObjectiveId(){this.contributionService.getFisrtByAccountId(this.data.id,this.data.periodTypeId,this.data.period,this.scoreType).subscribe(t=>{this.content=null==t?void 0:t.content,this.contributionModel.id=null==t?void 0:t.id})}getFunctionalLeaderCommentByAccountId(){this.commentService.getFunctionalLeaderCommentByAccountId(this.data.id,this.data.periodTypeId,this.data.period).subscribe(t=>{this.functionalLeaderCommentContent=null==t?void 0:t.content})}getFisrtCommentByObjectiveId(){this.commentService.getFisrtByAccountId(this.data.id,this.data.periodTypeId,this.data.period,this.scoreType).subscribe(t=>{this.commentContent=null==t?void 0:t.content,this.commentModel.id=null==t?void 0:t.id})}getFisrtSpecialContributionScoreByObjectiveIdAndScoreBy(){this.specialContributionScoreService.getFisrtByAccountId(this.data.id,this.data.periodTypeId,this.data.period,this.scoreType).subscribe(t=>{this.specialPoint=(null==t?void 0:t.point)||0,this.specialContributionScoreModel.id=null==t?void 0:t.id})}loadAttitudeData(){this.attitudeService.getAll().subscribe(t=>{this.attitudeData=t})}loadSpecialScoreData(){this.specialScoreService.getAll().subscribe(t=>{this.specialScoreData=t})}addComment(){return this.commentModel.content=this.commentContent,this.commentService.add(this.commentModel)}addAttitudeScore(){return this.attitudeScoreModel.point=this.point,this.attitudeScoreService.add(this.attitudeScoreModel)}addSpecialContributionScore(){return this.specialContributionScoreModel.point=this.specialPoint,this.specialContributionScoreService.add(this.specialContributionScoreModel)}addContribution(){return this.contributionModel.content=this.content,this.contributionService.add(this.contributionModel)}finish(){if(this.utilitiesService.isUndefinedOrNull(this.point))return void this.alertify.warning("Please choose a attitude score. <br>Not yet complete. Can not submit! \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0);if(this.utilitiesService.isUndefinedOrNullOrEmpty(this.commentContent))return void this.alertify.warning("Please leave a comment. <br>Not yet complete. Can not submit! \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0);if(0!=this.specialPoint&&this.utilitiesService.isUndefinedOrNullOrEmpty(this.content))return void this.alertify.warning("Please leave a special contribution or mistake! <br>Not yet complete. Can not submit! \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0);if(0===this.specialPoint&&!this.utilitiesService.isUndefinedOrNullOrEmpty(this.content))return void this.alertify.warning("Please choose a special score. <br>Not yet complete. Can not submit! \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0);const t=this.addAttitudeScore(),e=this.addContribution(),i=this.addSpecialContributionScore(),o=this.addComment();Object(fe.a)([t,e,i,o]).subscribe(t=>{console.log(t),t.map(t=>t.success),t=>t.every(Boolean)?(this.alertify.success(y.a.CREATED_OK_MSG),this.service.changeMessage(!0),this.activeModal.close()):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)})}NO(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}return t.\u0275fac=function(e){return new(e||t)(V.Pb(k.a),V.Pb(ue),V.Pb(me),V.Pb(He),V.Pb(Ke),V.Pb(Ne),V.Pb(Je),V.Pb(ge),V.Pb(f.a),V.Pb(M.a))},t.\u0275cmp=V.Jb({type:t,selectors:[["app-attitude-score"]],viewQuery:function(t,e){if(1&t&&V.Mc(ze,1),2&t){let t;V.wc(t=V.gc())&&(e.grid=t.first)}},inputs:{data:"data",scoreType:"scoreType"},decls:91,vars:22,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","p-0"],["allowTextWrap","true","gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","toolbar","pageSettings","allowExcelExport","queryCellInfo"],["grid",""],["field","#","headerText","#","textAlign","Center","width","30","type","number"],["template",""],["field","objective","headerText","KPI Objective","type","string"],["field","l0TargetList","headerText","L0 Target","type","string"],["field","l0ActionList","headerText","L0 Action","type","string"],["ngFor","",3,"ngForOf"],[1,"row","mt-2","d-flex","justify-content-center"],[1,"col-md-12"],[1,"table","table-bordered"],["scope","col"],["class","table",4,"ngIf"],[1,"table",2,"border","none"],["scope","col",1,"text-center",2,"border","none","width","70%","padding","0"],["scope","col",1,"text-center",2,"border","none","width","30%","padding","0"],[2,"border","none"],[1,"form-group"],["id","comment","rows","6","type","text","placeholder","Type something!",1,"form-control",3,"ngModel","ngModelChange"],[3,"dataSource","value","fields","allowFiltering","valueChange"],["accountGroupDropdownlist",""],[1,"modal-footer","justify-content-end"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-success",3,"click"],[2,"padding","0 0 0 8px"],[4,"ngFor","ngForOf"],[3,"field","headerText"],[1,"table"],["scope","col",2,"width","20%"],["scope","col",2,"width","50%"],["scope","col",2,"width","10%","text-align","center","font-size","xx-large"]],template:function(t,e){1&t&&(V.Vb(0,"div",0),V.Vb(1,"h4",1),V.Ic(2),V.Ub(),V.Vb(3,"button",2),V.fc("click",function(){return e.activeModal.dismiss("Cross click")}),V.Vb(4,"span",3),V.Ic(5,"\xd7"),V.Ub(),V.Ub(),V.Ub(),V.Vb(6,"div",4),V.Vb(7,"ejs-grid",5,6),V.fc("queryCellInfo",function(t){return e.queryCellInfoEvent(t)}),V.Vb(9,"e-columns"),V.Vb(10,"e-column",7),V.Gc(11,Qe,1,1,"ng-template",null,8,V.Hc),V.Ub(),V.Qb(13,"e-column",9),V.Qb(14,"e-column",10),V.Vb(15,"e-column",11),V.Gc(16,qe,2,1,"ng-template",null,8,V.Hc),V.Ub(),V.Gc(18,We,1,2,"ng-template",12,8,V.Hc),V.Ub(),V.Ub(),V.Vb(20,"div",13),V.Vb(21,"div",14),V.Vb(22,"table",15),V.Vb(23,"thead"),V.Vb(24,"tr"),V.Vb(25,"th",16),V.Ic(26,"\u5de5\u4f5c\u614b\u5ea6 = \u4e3b\u52d5\u7a4d\u6975 + \u6e9d\u901a\u53caEQ + \u914d\u5408\u5ea6"),V.Ub(),V.Vb(27,"th",16),V.Ic(28,"\u975e\u5e38\u597d 10 \u5206"),V.Ub(),V.Vb(29,"th",16),V.Ic(30,"\u8f03\u597d 8-9 \u5206"),V.Ub(),V.Vb(31,"th",16),V.Ic(32,"\u4e00\u822c 6-7 \u5206"),V.Ub(),V.Vb(33,"th",16),V.Ic(34,"\u8f03\u5dee 4-5 \u5206"),V.Ub(),V.Vb(35,"th",16),V.Ic(36,"\u6975\u5dee 3 \u5206\u4ee5\u4e0b"),V.Ub(),V.Ub(),V.Ub(),V.Vb(37,"tbody"),V.Vb(38,"tr"),V.Vb(39,"td"),V.Ic(40,"Attitude = Proactiveness + Communication & EQ + Cooperation"),V.Ub(),V.Vb(41,"td"),V.Ic(42,"Excellent 10 points"),V.Ub(),V.Vb(43,"td"),V.Ic(44,"Good 8-9 points"),V.Ub(),V.Vb(45,"td"),V.Ic(46,"Normal 6-7 points"),V.Ub(),V.Vb(47,"td"),V.Ic(48,"Not goo 4-5 points"),V.Ub(),V.Vb(49,"td"),V.Ic(50,"Poor 3 points or below"),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(51,"div",13),V.Vb(52,"div",14),V.Gc(53,Xe,15,2,"table",17),V.Vb(54,"table",18),V.Vb(55,"thead"),V.Vb(56,"tr"),V.Vb(57,"th",19),V.Ic(58,"Comment"),V.Ub(),V.Vb(59,"th",20),V.Ic(60,"Attitude Score"),V.Ub(),V.Ub(),V.Ub(),V.Vb(61,"tbody"),V.Vb(62,"tr"),V.Vb(63,"td",21),V.Vb(64,"div",22),V.Vb(65,"textarea",23),V.fc("ngModelChange",function(t){return e.commentContent=t}),V.Ub(),V.Ub(),V.Ub(),V.Vb(66,"td",21),V.Vb(67,"div",22),V.Vb(68,"ejs-dropdownlist",24,25),V.fc("valueChange",function(t){return e.point=t}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(70,"table",18),V.Vb(71,"thead"),V.Vb(72,"tr"),V.Vb(73,"th",19),V.Ic(74,"\u91cd\u5927\u8ca2\u737b\u6216\u932f\u8aa4(\u5982\u6709) Special Contribution or Mistake(if any)"),V.Ub(),V.Vb(75,"th",20),V.Ic(76,"Special Score \u91cd\u5927\u8ca2\u737b\u6216\u932f\u8aa4(\u5982\u6709) "),V.Ub(),V.Ub(),V.Ub(),V.Vb(77,"tbody"),V.Vb(78,"tr"),V.Vb(79,"td",21),V.Vb(80,"div",22),V.Vb(81,"textarea",23),V.fc("ngModelChange",function(t){return e.content=t}),V.Ub(),V.Ub(),V.Ub(),V.Vb(82,"td",21),V.Vb(83,"div",22),V.Vb(84,"ejs-dropdownlist",24,25),V.fc("valueChange",function(t){return e.specialPoint=t}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(86,"div",26),V.Vb(87,"button",27),V.fc("click",function(){return e.activeModal.close("Close click")}),V.Ic(88),V.Ub(),V.Vb(89,"button",28),V.fc("click",function(){return e.finish()}),V.Ic(90),V.Ub(),V.Ub(),V.Ub()),2&t&&(V.Cb(2),V.Kc("Self-score of KPI Objective (",e.data.objective,")"),V.Cb(5),V.oc("dataSource",e.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",e.toolbarOptions)("pageSettings",e.pageSettings)("allowExcelExport",!0),V.Cb(11),V.oc("ngForOf",e.columns),V.Cb(35),V.oc("ngIf",e.hasFunctionalLeader),V.Cb(12),V.oc("ngModel",e.commentContent),V.Cb(3),V.oc("dataSource",e.attitudeData)("value",e.point)("fields",e.fields)("allowFiltering",!0),V.Cb(13),V.oc("ngModel",e.content),V.Cb(3),V.oc("dataSource",e.specialScoreData)("value",e.specialPoint)("fields",e.fields)("allowFiltering",!0),V.Cb(4),V.Jc("Close"),V.Cb(2),V.Jc("Finish"))},directives:[d.g,d.d,d.b,G.d,G.b,j.d,d.c,d.a,G.c,G.a,j.c,n.l,n.m,c.a,c.f,c.i,l.b],styles:["#comment[_ngcontent-%COMP%]{border:2px solid #ffc107!important;font-family:Helvetica Neue,Helvetica,Arial,sans-serif,-apple-system,BlinkMacSystemFont}#comment[_ngcontent-%COMP%], #comment.form-control[_ngcontent-%COMP%]:focus{color:#212529!important;font-size:14px!important}#comment.form-control[_ngcontent-%COMP%]:focus{background-color:#fff!important;border-color:#ffc107!important;outline:0!important;box-shadow:0 0 0 .2rem rgba(32,168,216,.25)}.e-input-group.e-control-wrapper[_ngcontent-%COMP%]:not(.e-success):not(.e-warning):not(.e-error), .e-input-group[_ngcontent-%COMP%]:not(.e-success):not(.e-warning):not(.e-error){border:2px solid #ffc107!important}"]}),t})();const ti=["grid"];function ei(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic();V.Kc(" ",i.NO(t.index)," ")}}function ii(t,e){if(1&t&&(V.Vb(0,"li"),V.Ic(1),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.Jc(t)}}function oi(t,e){if(1&t&&(V.Vb(0,"ul",34),V.Gc(1,ii,2,1,"li",35),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.oc("ngForOf",t.l0ActionList)}}function ni(t,e){if(1&t&&V.Qb(0,"e-column",36),2&t){const t=e.$implicit;V.oc("field",t.field)("headerText",t.headerText)}}function ci(t,e){if(1&t&&(V.Vb(0,"table",19),V.Vb(1,"thead"),V.Vb(2,"tr"),V.Vb(3,"th",20),V.Ic(4,"Functional leader comment"),V.Qb(5,"br"),V.Ic(6," \u529f\u80fd\u4e3b\u7ba1\u8a55\u8a9e"),V.Ub(),V.Vb(7,"th",21),V.Ic(8),V.Ub(),V.Vb(9,"th",20),V.Ic(10,"Functional leader score"),V.Qb(11,"br"),V.Ic(12,"\u529f\u80fd\u4e3b\u7ba1\u8a55\u5206"),V.Ub(),V.Vb(13,"th",22),V.Ic(14),V.Ub(),V.Ub(),V.Ub(),V.Ub()),2&t){const t=V.ic();V.Cb(8),V.Jc(t.functionalLeaderCommentContent||""),V.Cb(6),V.Jc(t.functionalLeaderAttitudeScoreData||0)}}function ai(t,e){1&t&&(V.Vb(0,"div",37),V.Vb(1,"strong",38),V.Ic(2," Please ask functional leader to score attitude score L0!"),V.Ub(),V.Ub())}function ri(t,e){1&t&&(V.Vb(0,"div",37),V.Vb(1,"strong",38),V.Ic(2," Please ask L1 to score attitude score L0."),V.Ub(),V.Ub())}let si=(()=>{class t{constructor(t,e,i,o,n,c,a,r,s,l){this.activeModal=t,this.service=e,this.attitudeScoreService=i,this.attitudeService=o,this.contributionService=n,this.specialScoreService=c,this.specialContributionScoreService=a,this.commentService=r,this.alertify=s,this.utilitiesService=l,this.toolbarOptions=["Search"],this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.specialPoint=0,this.fields={text:"point",value:"point"},this.filterSettings={type:"Excel"},this.content="",this.specialContent="",this.commentContent="",this.queryCellInfoEvent=t=>{var e;const i=t.data;for(const o of this.halfYearSettingsData)(""+o).includes(t.column.field)&&(t.cell.innerText=(null===(e=i.resultOfMonth.filter(t=>t.month===o)[0])||void 0===e?void 0:e.title)||"N/A")}}ngOnInit(){this.hasFunctionalLeader=this.data.hasFunctionalLeader,this.attitudeScoreModel={id:0,periodTypeId:this.data.periodTypeId,period:this.data.period,point:this.point,accountId:this.data.id,scoreBy:+JSON.parse(localStorage.getItem("user")).id,createdTime:(new Date).toDateString(),modifiedTime:null,scoreType:this.scoreType},this.specialContributionScoreModel={id:0,periodTypeId:this.data.periodTypeId,period:this.data.period,point:this.specialPoint,accountId:this.data.id,scoreBy:+JSON.parse(localStorage.getItem("user")).id,createdTime:(new Date).toDateString(),modifiedTime:null,scoreType:this.scoreType},this.contributionModel={id:0,content:this.content,createdBy:+JSON.parse(localStorage.getItem("user")).id,accountId:this.data.id,modifiedBy:null,createdTime:(new Date).toDateString(),modifiedTime:null,periodTypeId:this.data.periodTypeId,period:this.data.period,scoreType:this.scoreType},this.commentModel={id:0,content:this.commentContent,createdBy:+JSON.parse(localStorage.getItem("user")).id,accountId:this.data.id,modifiedBy:null,createdTime:(new Date).toDateString(),modifiedTime:null,period:this.data.period,periodTypeId:this.data.periodTypeId,scoreType:this.scoreType,commentTypeId:be.Comment},!0===this.hasFunctionalLeader&&(this.getFunctionalLeaderCommentByAccountId(),this.getFunctionalLeaderAttitudeScoreByAccountId()),this.getHalfYearSetting(),this.loadData(),this.loadAttitudeScoreData(),this.loadAttitudeData(),this.loadSpecialScoreData(),this.getFisrtByObjectiveIdAndScoreBy(),this.getFisrtContributionByObjectiveId(),this.getFisrtCommentByObjectiveId(),this.getFisrtSpecialContributionScoreByObjectiveIdAndScoreBy(),this.getL1CommentContributionByAccountId(),this.getSpecialScoreByAccountId(),this.getL1CommentByAccountId(),this.getL1AttitudeScoreByAccountId()}getMonthListInCurrentQuarter(t){return["Result of Jan.","Result of Feb.","Result of Mar.","Result of Apr.","Result of May.","Result of Jun.","Result of Jul.","Result of Aug.","Result of Sep.","Result of Oct.","Result of Nov.","Result of Dec."][t-1]}getHalfYearSetting(){this.halfYearSettingsData=this.data.settings||[],this.columns=[];for(const t of this.halfYearSettingsData)this.columns.push({field:`${t}`,headerText:this.getMonthListInCurrentQuarter(t),month:t})}loadData(){this.service.getAllAttitudeScoreL1ByAccountId(this.data.id).subscribe(t=>{this.gridData=t})}loadAttitudeScoreData(){this.attitudeScoreService.getById(this.data.id).subscribe(t=>{this.attitudeScoreData=t})}getFunctionalLeaderAttitudeScoreByAccountId(){this.attitudeScoreService.getFunctionalLeaderAttitudeScoreByAccountId(this.data.id,this.data.periodTypeId,this.data.period).subscribe(t=>{this.functionalLeaderAttitudeScoreData=(null==t?void 0:t.point)||0,this.functionalLeaderScored=this.functionalLeaderAttitudeScoreData>0})}getL1AttitudeScoreByAccountId(){this.attitudeScoreService.getL1AttitudeScoreByAccountId(this.data.id,this.data.periodTypeId,this.data.period).subscribe(t=>{this.l1AttitudeScoreData=(null==t?void 0:t.point)||0,this.l1Scored=this.l1AttitudeScoreData>0})}getFisrtByObjectiveIdAndScoreBy(){this.attitudeScoreService.getFisrtByAccountId(this.data.id,this.data.periodTypeId,this.data.period,this.scoreType).subscribe(t=>{this.point=null==t?void 0:t.point,this.attitudeScoreModel.id=null==t?void 0:t.id})}getFisrtContributionByObjectiveId(){this.contributionService.getFisrtByAccountId(this.data.id,this.data.periodTypeId,this.data.period,this.scoreType).subscribe(t=>{this.content=null==t?void 0:t.content,this.contributionModel.id=null==t?void 0:t.id})}getFunctionalLeaderCommentByAccountId(){this.commentService.getFunctionalLeaderCommentByAccountId(this.data.id,this.data.periodTypeId,this.data.period).subscribe(t=>{this.functionalLeaderCommentContent=null==t?void 0:t.content})}getL1CommentByAccountId(){this.commentService.getL1CommentByAccountId(this.data.id,this.data.periodTypeId,this.data.period).subscribe(t=>{this.l1CommentContent=null==t?void 0:t.content})}getFisrtCommentByObjectiveId(){this.commentService.getFisrtByAccountId(this.data.id,this.data.periodTypeId,this.data.period,this.scoreType).subscribe(t=>{this.commentContent=null==t?void 0:t.content,this.commentModel.id=null==t?void 0:t.id})}getSpecialScoreByAccountId(){this.specialContributionScoreService.getSpecialScoreByAccountId(this.data.id,this.data.periodTypeId,this.data.period,this.scoreType).subscribe(t=>{this.specialContributionScore=(null==t?void 0:t.point)||0,this.specialContributionScored=0!==this.specialContributionScore})}getL1CommentContributionByAccountId(){this.contributionService.getL1CommentByAccountId(this.data.id,this.data.periodTypeId,this.data.period).subscribe(t=>{this.l1SpecialContributionContent=null==t?void 0:t.content})}getFisrtSpecialContributionScoreByObjectiveIdAndScoreBy(){this.specialContributionScoreService.getFisrtByAccountId(this.data.id,this.data.periodTypeId,this.data.period,this.scoreType).subscribe(t=>{this.specialPoint=(null==t?void 0:t.point)||0,this.specialContributionScoreModel.id=null==t?void 0:t.id})}loadAttitudeData(){this.attitudeService.getAll().subscribe(t=>{this.attitudeData=t})}loadSpecialScoreData(){this.specialScoreService.getAll().subscribe(t=>{this.specialScoreData=t})}addComment(){return this.commentModel.content=this.commentContent,this.commentService.add(this.commentModel)}addAttitudeScore(){return this.attitudeScoreModel.point=this.point,this.attitudeScoreService.add(this.attitudeScoreModel)}addSpecialContributionScore(){return this.specialContributionScoreModel.point=this.specialPoint,this.specialContributionScoreService.add(this.specialContributionScoreModel)}addContribution(){return this.contributionModel.content=this.content,this.contributionService.add(this.contributionModel)}finish(){if(this.utilitiesService.isUndefinedOrNull(this.point))return void this.alertify.warning("Please choose a attitude score. <br>Not yet complete. Can not submit! \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0);if(this.utilitiesService.isUndefinedOrNullOrEmpty(this.commentContent))return void this.alertify.warning("Please leave a comment. <br>Not yet complete. Can not submit! \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0);if(0!=this.specialPoint&&this.utilitiesService.isUndefinedOrNullOrEmpty(this.content))return void this.alertify.warning("Please leave a special contribution or mistake! <br>Not yet complete. Can not submit! \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0);if(0===this.specialPoint&&!this.utilitiesService.isUndefinedOrNullOrEmpty(this.content))return void this.alertify.warning("Please choose a special score. <br>Not yet complete. Can not submit! \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0);const t=this.addAttitudeScore(),e=this.addContribution(),i=this.addSpecialContributionScore(),o=this.addComment();Object(fe.a)([t,e,i,o]).subscribe(t=>{console.log(t),t.map(t=>t.success),t=>t.every(Boolean)?(this.alertify.success(y.a.CREATED_OK_MSG),this.service.changeMessage(!0),this.activeModal.close()):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)})}NO(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}return t.\u0275fac=function(e){return new(e||t)(V.Pb(k.a),V.Pb(ue),V.Pb(me),V.Pb(He),V.Pb(Ke),V.Pb(Ne),V.Pb(Je),V.Pb(ge),V.Pb(f.a),V.Pb(M.a))},t.\u0275cmp=V.Jb({type:t,selectors:[["app-attitude-score-l2"]],viewQuery:function(t,e){if(1&t&&V.Mc(ti,1),2&t){let t;V.wc(t=V.gc())&&(e.grid=t.first)}},inputs:{data:"data",scoreType:"scoreType"},decls:123,vars:29,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","p-0"],["allowTextWrap","true","gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","toolbar","pageSettings","allowExcelExport","queryCellInfo"],["grid",""],["field","#","headerText","#","textAlign","Center","width","30","type","number"],["template",""],["field","objective","headerText","KPI Objective","type","string"],["field","l0TargetList","headerText","L0 Target","type","string"],["field","l0ActionList","headerText","L0 Action","type","string"],["ngFor","",3,"ngForOf"],[1,"row","mt-2","d-flex","justify-content-center"],[1,"col-md-12"],[1,"table","table-bordered"],["scope","col"],["class","table",4,"ngIf"],["class","alert alert-danger text-center","role","alert",4,"ngIf"],[1,"table"],["scope","col",2,"width","20%"],["scope","col",2,"width","50%"],["scope","col",2,"width","10%","text-align","center","font-size","xx-large"],[1,"table",2,"border","none"],["scope","col",1,"text-center",2,"border","none","width","70%","padding","0"],["scope","col",1,"text-center",2,"border","none","width","30%","padding","0"],[2,"border","none"],[1,"form-group"],["id","comment","rows","6","type","text","placeholder","Type something!",1,"form-control",3,"ngModel","ngModelChange"],[3,"dataSource","value","fields","allowFiltering","valueChange"],["accountGroupDropdownlist",""],[1,"modal-footer","justify-content-end"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-success",3,"disabled","click"],[2,"padding","0 0 0 8px"],[4,"ngFor","ngForOf"],[3,"field","headerText"],["role","alert",1,"alert","alert-danger","text-center"],[1,"text-center"]],template:function(t,e){1&t&&(V.Vb(0,"div",0),V.Vb(1,"h4",1),V.Ic(2),V.Ub(),V.Vb(3,"button",2),V.fc("click",function(){return e.activeModal.dismiss("Cross click")}),V.Vb(4,"span",3),V.Ic(5,"\xd7"),V.Ub(),V.Ub(),V.Ub(),V.Vb(6,"div",4),V.Vb(7,"ejs-grid",5,6),V.fc("queryCellInfo",function(t){return e.queryCellInfoEvent(t)}),V.Vb(9,"e-columns"),V.Vb(10,"e-column",7),V.Gc(11,ei,1,1,"ng-template",null,8,V.Hc),V.Ub(),V.Qb(13,"e-column",9),V.Qb(14,"e-column",10),V.Vb(15,"e-column",11),V.Gc(16,oi,2,1,"ng-template",null,8,V.Hc),V.Ub(),V.Gc(18,ni,1,2,"ng-template",12,8,V.Hc),V.Ub(),V.Ub(),V.Vb(20,"div",13),V.Vb(21,"div",14),V.Vb(22,"table",15),V.Vb(23,"thead"),V.Vb(24,"tr"),V.Vb(25,"th",16),V.Ic(26,"\u5de5\u4f5c\u614b\u5ea6 = \u4e3b\u52d5\u7a4d\u6975 + \u6e9d\u901a\u53caEQ + \u914d\u5408\u5ea6"),V.Ub(),V.Vb(27,"th",16),V.Ic(28,"\u975e\u5e38\u597d 10 \u5206"),V.Ub(),V.Vb(29,"th",16),V.Ic(30,"\u8f03\u597d 8-9 \u5206"),V.Ub(),V.Vb(31,"th",16),V.Ic(32,"\u4e00\u822c 6-7 \u5206"),V.Ub(),V.Vb(33,"th",16),V.Ic(34,"\u8f03\u5dee 4-5 \u5206"),V.Ub(),V.Vb(35,"th",16),V.Ic(36,"\u6975\u5dee 3 \u5206\u4ee5\u4e0b"),V.Ub(),V.Ub(),V.Ub(),V.Vb(37,"tbody"),V.Vb(38,"tr"),V.Vb(39,"td"),V.Ic(40,"Attitude = Proactiveness + Communication & EQ + Cooperation"),V.Ub(),V.Vb(41,"td"),V.Ic(42,"Excellent 10 points"),V.Ub(),V.Vb(43,"td"),V.Ic(44,"Good 8-9 points"),V.Ub(),V.Vb(45,"td"),V.Ic(46,"Normal 6-7 points"),V.Ub(),V.Vb(47,"td"),V.Ic(48,"Not goo 4-5 points"),V.Ub(),V.Vb(49,"td"),V.Ic(50,"Poor 3 points or below"),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(51,"div",13),V.Vb(52,"div",14),V.Gc(53,ci,15,2,"table",17),V.Gc(54,ai,3,0,"div",18),V.Vb(55,"table",19),V.Vb(56,"thead"),V.Vb(57,"tr"),V.Vb(58,"th",20),V.Ic(59," L1 comment"),V.Qb(60,"br"),V.Ic(61," \u76f4\u5c6c\u4e3b\u7ba1\u8a55\u8a9e\uff1a "),V.Ub(),V.Vb(62,"th",21),V.Ic(63),V.Ub(),V.Vb(64,"th",20),V.Ic(65," L1 give Attitude Score"),V.Qb(66,"br"),V.Ic(67," \u76f4\u5c6c\u4e3b\u7ba1\u7d66\u4e88\u614b\u5ea6\u5206\u6578\uff1a "),V.Ub(),V.Vb(68,"th",22),V.Ic(69),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Gc(70,ri,3,0,"div",18),V.Vb(71,"table",19),V.Vb(72,"thead"),V.Vb(73,"tr"),V.Vb(74,"th",20),V.Ic(75," Special Contribution or Mistake(if any)"),V.Qb(76,"br"),V.Ic(77," L1\u8a55\u50f9\u91cd\u5927\u8ca2\u737b\u6216\u932f\u8aa4(\u5982\u6709) "),V.Ub(),V.Vb(78,"th",21),V.Ic(79),V.Ub(),V.Vb(80,"th",20),V.Ic(81," L1 Score for Special Contribution or Mistake"),V.Qb(82,"br"),V.Ic(83," \u76f4\u5c6c\u4e3b\u7ba1\u7d66\u4e88\u7279\u5225\u8868\u73fe\u5206\u6578\uff1a "),V.Ub(),V.Vb(84,"th",22),V.Ic(85),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(86,"table",23),V.Vb(87,"thead"),V.Vb(88,"tr"),V.Vb(89,"th",24),V.Ic(90,"Comment"),V.Ub(),V.Vb(91,"th",25),V.Ic(92,"Attitude Score"),V.Ub(),V.Ub(),V.Ub(),V.Vb(93,"tbody"),V.Vb(94,"tr"),V.Vb(95,"td",26),V.Vb(96,"div",27),V.Vb(97,"textarea",28),V.fc("ngModelChange",function(t){return e.commentContent=t}),V.Ub(),V.Ub(),V.Ub(),V.Vb(98,"td",26),V.Vb(99,"div",27),V.Vb(100,"ejs-dropdownlist",29,30),V.fc("valueChange",function(t){return e.point=t}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(102,"table",23),V.Vb(103,"thead"),V.Vb(104,"tr"),V.Vb(105,"th",24),V.Ic(106,"\u91cd\u5927\u8ca2\u737b\u6216\u932f\u8aa4(\u5982\u6709) Special Contribution or Mistake(if any)"),V.Ub(),V.Vb(107,"th",25),V.Ic(108,"Special Score \u91cd\u5927\u8ca2\u737b\u6216\u932f\u8aa4(\u5982\u6709) "),V.Ub(),V.Ub(),V.Ub(),V.Vb(109,"tbody"),V.Vb(110,"tr"),V.Vb(111,"td",26),V.Vb(112,"div",27),V.Vb(113,"textarea",28),V.fc("ngModelChange",function(t){return e.content=t}),V.Ub(),V.Ub(),V.Ub(),V.Vb(114,"td",26),V.Vb(115,"div",27),V.Vb(116,"ejs-dropdownlist",29,30),V.fc("valueChange",function(t){return e.specialPoint=t}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(118,"div",31),V.Vb(119,"button",32),V.fc("click",function(){return e.activeModal.close("Close click")}),V.Ic(120),V.Ub(),V.Vb(121,"button",33),V.fc("click",function(){return e.finish()}),V.Ic(122),V.Ub(),V.Ub(),V.Ub()),2&t&&(V.Cb(2),V.Kc("Self-score of KPI Objective (",e.data.objective,")"),V.Cb(5),V.oc("dataSource",e.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",e.toolbarOptions)("pageSettings",e.pageSettings)("allowExcelExport",!0),V.Cb(11),V.oc("ngForOf",e.columns),V.Cb(35),V.oc("ngIf",e.hasFunctionalLeader),V.Cb(1),V.oc("ngIf",e.hasFunctionalLeader&&!1===e.functionalLeaderScored),V.Cb(9),V.Jc(e.l1CommentContent||""),V.Cb(6),V.Jc(e.l1AttitudeScoreData||0),V.Cb(1),V.oc("ngIf",!1===e.l1Scored),V.Cb(9),V.Jc(e.l1SpecialContributionContent||""),V.Cb(6),V.Jc(e.specialContributionScore||0),V.Cb(12),V.oc("ngModel",e.commentContent),V.Cb(3),V.oc("dataSource",e.attitudeData)("value",e.point)("fields",e.fields)("allowFiltering",!0),V.Cb(13),V.oc("ngModel",e.content),V.Cb(3),V.oc("dataSource",e.specialScoreData)("value",e.specialPoint)("fields",e.fields)("allowFiltering",!0),V.Cb(4),V.Jc("Close"),V.Cb(1),V.oc("disabled",e.hasFunctionalLeader&&!1===e.functionalLeaderScored||0==e.l1Scored||e.hasFunctionalLeader&&!1===e.functionalLeaderScored),V.Cb(1),V.Jc("Finish"))},directives:[d.g,d.d,d.b,G.d,G.b,j.d,d.c,d.a,G.c,G.a,j.c,n.l,n.m,c.a,c.f,c.i,l.b],styles:["#comment[_ngcontent-%COMP%]{border:2px solid #ffc107!important;font-family:Helvetica Neue,Helvetica,Arial,sans-serif,-apple-system,BlinkMacSystemFont}#comment[_ngcontent-%COMP%], #comment.form-control[_ngcontent-%COMP%]:focus{color:#212529!important;font-size:14px!important}#comment.form-control[_ngcontent-%COMP%]:focus{background-color:#fff!important;border-color:#ffc107!important;outline:0!important;box-shadow:0 0 0 .2rem rgba(32,168,216,.25)}.e-input-group.e-control-wrapper[_ngcontent-%COMP%]:not(.e-success):not(.e-warning):not(.e-error), .e-input-group[_ngcontent-%COMP%]:not(.e-success):not(.e-warning):not(.e-error){border:2px solid #ffc107!important}"]}),t})();const li=["grid"];function di(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic();V.Kc(" ",i.NO(t.index)," ")}}function bi(t,e){if(1&t&&(V.Vb(0,"li"),V.Ic(1),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.Jc(t)}}function ui(t,e){if(1&t&&(V.Vb(0,"ul",27),V.Gc(1,bi,2,1,"li",28),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.oc("ngForOf",t.l0ActionList)}}function hi(t,e){if(1&t&&V.Qb(0,"e-column",29),2&t){const t=e.$implicit;V.oc("field",t.field)("headerText",t.headerText)}}let pi=(()=>{class t{constructor(t,e,i,o,n,c,a){this.activeModal=t,this.service=e,this.attitudeScoreService=i,this.attitudeService=o,this.contributionService=n,this.alertify=c,this.utilitiesService=a,this.toolbarOptions=["Search"],this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.fields={text:"point",value:"point"},this.filterSettings={type:"Excel"},this.content="",this.queryCellInfoEvent=t=>{var e;const i=t.data;for(const o of this.halfYearSettingsData)(""+o).includes(t.column.field)&&(t.cell.innerText=(null===(e=i.resultOfMonth.filter(t=>t.month===o)[0])||void 0===e?void 0:e.title)||"N/A")}}ngOnInit(){this.attitudeScoreModel={id:0,periodTypeId:this.data.periodTypeId,period:this.data.period,point:this.point,accountId:this.data.id,scoreBy:+JSON.parse(localStorage.getItem("user")).id,createdTime:(new Date).toDateString(),modifiedTime:null,scoreType:this.scoreType},this.contributionModel={id:0,content:this.content,createdBy:+JSON.parse(localStorage.getItem("user")).id,accountId:this.data.id,modifiedBy:null,createdTime:(new Date).toDateString(),modifiedTime:null,periodTypeId:this.data.periodTypeId,period:this.data.period,scoreType:this.scoreType},this.getHalfYearSetting(),this.loadData(),this.loadAttitudeScoreData(),this.loadKPIData(),this.getFisrtByObjectiveIdAndScoreBy(),this.getFisrtContributionByObjectiveId()}getMonthListInCurrentQuarter(t){return["Result of Jan.","Result of Feb.","Result of Mar.","Result of Apr.","Result of May.","Result of Jun.","Result of Jul.","Result of Aug.","Result of Sep.","Result of Oct.","Result of Nov.","Result of Dec."][t-1]}getHalfYearSetting(){this.halfYearSettingsData=this.data.settings||[],this.columns=[];for(const t of this.halfYearSettingsData)this.columns.push({field:`${t}`,headerText:this.getMonthListInCurrentQuarter(t),month:t})}loadData(){this.service.getAllAttitudeScoreGHRByAccountId(this.data.id).subscribe(t=>{this.gridData=t})}loadAttitudeScoreData(){this.attitudeScoreService.getById(this.data.id).subscribe(t=>{this.attitudeScoreData=t})}getFisrtByObjectiveIdAndScoreBy(){this.attitudeScoreService.getFisrtByAccountId(this.data.id,this.data.periodTypeId,this.data.period,this.scoreType).subscribe(t=>{this.point=null==t?void 0:t.point,this.attitudeScoreModel.id=null==t?void 0:t.id})}getFisrtContributionByObjectiveId(){this.contributionService.getFisrtByAccountId(this.data.id,this.data.periodTypeId,this.data.period,this.data.scoreType).subscribe(t=>{this.content=null==t?void 0:t.content,this.contributionModel.id=null==t?void 0:t.id})}loadKPIData(){this.attitudeService.getAll().subscribe(t=>{this.attitudeData=t})}addAttitudeScore(){return this.attitudeScoreModel.point=this.point,this.attitudeScoreService.add(this.attitudeScoreModel)}addContribution(){return this.contributionModel.content=this.content,this.contributionService.add(this.contributionModel)}finish(){if(!this.point)return void this.alertify.warning("Not yet complete. Can not submit! \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0);const t=this.addAttitudeScore();Object(fe.a)([t]).subscribe(t=>{console.log(t),t.map(t=>t.success),t=>t.every(Boolean)?(this.alertify.success(y.a.CREATED_OK_MSG),this.service.changeMessage(!0),this.activeModal.close()):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)})}NO(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}return t.\u0275fac=function(e){return new(e||t)(V.Pb(k.a),V.Pb(ue),V.Pb(me),V.Pb(He),V.Pb(Ke),V.Pb(f.a),V.Pb(M.a))},t.\u0275cmp=V.Jb({type:t,selectors:[["app-attitude-score-ghr"]],viewQuery:function(t,e){if(1&t&&V.Mc(li,1),2&t){let t;V.wc(t=V.gc())&&(e.grid=t.first)}},inputs:{data:"data",scoreType:"scoreType"},decls:71,vars:15,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","p-0"],["allowTextWrap","true","gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","toolbar","pageSettings","allowExcelExport","queryCellInfo"],["grid",""],["field","#","headerText","#","textAlign","Center","width","80","type","number"],["template",""],["field","objective","headerText","KPI Objective","type","string"],["field","l0TargetList","headerText","L0 Target","type","string"],["field","l0ActionList","headerText","L0 Action","type","string"],["ngFor","",3,"ngForOf"],[1,"row","mt-2","d-flex","justify-content-center"],[1,"col-md-12"],[1,"table","table-bordered"],["scope","col"],[1,"table",2,"border","none"],["scope","col",1,"text-center",2,"border","none","width","70%","padding","0"],["scope","col",1,"text-center",2,"border","none","width","30%","padding","0"],[2,"border","none"],[1,"form-group"],[3,"dataSource","value","fields","allowFiltering","valueChange"],["accountGroupDropdownlist",""],[1,"modal-footer","justify-content-end"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-success",3,"click"],[2,"padding","0 0 0 8px"],[4,"ngFor","ngForOf"],[3,"field","headerText"]],template:function(t,e){1&t&&(V.Vb(0,"div",0),V.Vb(1,"h4",1),V.Ic(2),V.Ub(),V.Vb(3,"button",2),V.fc("click",function(){return e.activeModal.dismiss("Cross click")}),V.Vb(4,"span",3),V.Ic(5,"\xd7"),V.Ub(),V.Ub(),V.Ub(),V.Vb(6,"div",4),V.Vb(7,"ejs-grid",5,6),V.fc("queryCellInfo",function(t){return e.queryCellInfoEvent(t)}),V.Vb(9,"e-columns"),V.Vb(10,"e-column",7),V.Gc(11,di,1,1,"ng-template",null,8,V.Hc),V.Ub(),V.Qb(13,"e-column",9),V.Qb(14,"e-column",10),V.Vb(15,"e-column",11),V.Gc(16,ui,2,1,"ng-template",null,8,V.Hc),V.Ub(),V.Gc(18,hi,1,2,"ng-template",12,8,V.Hc),V.Ub(),V.Ub(),V.Vb(20,"div",13),V.Vb(21,"div",14),V.Vb(22,"table",15),V.Vb(23,"thead"),V.Vb(24,"tr"),V.Vb(25,"th",16),V.Ic(26,"\u5de5\u4f5c\u614b\u5ea6 = \u4e3b\u52d5\u7a4d\u6975 + \u6e9d\u901a\u53caEQ + \u914d\u5408\u5ea6"),V.Ub(),V.Vb(27,"th",16),V.Ic(28,"\u975e\u5e38\u597d 10 \u5206"),V.Ub(),V.Vb(29,"th",16),V.Ic(30,"\u8f03\u597d 8-9 \u5206"),V.Ub(),V.Vb(31,"th",16),V.Ic(32,"\u4e00\u822c 6-7 \u5206"),V.Ub(),V.Vb(33,"th",16),V.Ic(34,"\u8f03\u5dee 4-5 \u5206"),V.Ub(),V.Vb(35,"th",16),V.Ic(36,"\u6975\u5dee 3 \u5206\u4ee5\u4e0b"),V.Ub(),V.Ub(),V.Ub(),V.Vb(37,"tbody"),V.Vb(38,"tr"),V.Vb(39,"td"),V.Ic(40,"Attitude = Proactiveness + Communication & EQ + Cooperation"),V.Ub(),V.Vb(41,"td"),V.Ic(42,"Excellent 10 points"),V.Ub(),V.Vb(43,"td"),V.Ic(44,"Good 8-9 points"),V.Ub(),V.Vb(45,"td"),V.Ic(46,"Normal 6-7 points"),V.Ub(),V.Vb(47,"td"),V.Ic(48,"Not goo 4-5 points"),V.Ub(),V.Vb(49,"td"),V.Ic(50,"Poor 3 points or below"),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(51,"div",13),V.Vb(52,"div",14),V.Vb(53,"table",17),V.Vb(54,"thead"),V.Vb(55,"tr"),V.Qb(56,"th",18),V.Vb(57,"th",19),V.Ic(58,"Attitude"),V.Ub(),V.Ub(),V.Ub(),V.Vb(59,"tbody"),V.Vb(60,"tr"),V.Qb(61,"td",20),V.Vb(62,"td",20),V.Vb(63,"div",21),V.Vb(64,"ejs-dropdownlist",22,23),V.fc("valueChange",function(t){return e.point=t}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(66,"div",24),V.Vb(67,"button",25),V.fc("click",function(){return e.activeModal.close("Close click")}),V.Ic(68),V.Ub(),V.Vb(69,"button",26),V.fc("click",function(){return e.finish()}),V.Ic(70),V.Ub(),V.Ub(),V.Ub()),2&t&&(V.Cb(2),V.Kc("Self-score of KPI Objective (",e.data.objective,")"),V.Cb(5),V.oc("dataSource",e.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",e.toolbarOptions)("pageSettings",e.pageSettings)("allowExcelExport",!0),V.Cb(11),V.oc("ngForOf",e.columns),V.Cb(46),V.oc("dataSource",e.attitudeData)("value",e.point)("fields",e.fields)("allowFiltering",!0),V.Cb(4),V.Jc("Close"),V.Cb(2),V.Jc("Finish"))},directives:[d.g,d.d,d.b,G.d,G.b,j.d,d.c,d.a,G.c,G.a,j.c,n.l,l.b],styles:["#comment[_ngcontent-%COMP%]{border:2px solid #ffc107!important;font-family:Helvetica Neue,Helvetica,Arial,sans-serif,-apple-system,BlinkMacSystemFont}#comment[_ngcontent-%COMP%], #comment.form-control[_ngcontent-%COMP%]:focus{color:#212529!important;font-size:14px!important}#comment.form-control[_ngcontent-%COMP%]:focus{background-color:#fff!important;border-color:#ffc107!important;outline:0!important;box-shadow:0 0 0 .2rem rgba(32,168,216,.25)}.e-input-group.e-control-wrapper[_ngcontent-%COMP%]:not(.e-success):not(.e-warning):not(.e-error), .e-input-group[_ngcontent-%COMP%]:not(.e-success):not(.e-warning):not(.e-error){border:2px solid #ffc107!important}"]}),t})();const gi=["grid"];function fi(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic();V.Kc(" ",i.NO(t.index)," ")}}function mi(t,e){if(1&t&&(V.Vb(0,"ul",28),V.Vb(1,"li"),V.Ic(2),V.Ub(),V.Ub()),2&t){const t=e.$implicit;V.Cb(2),V.Jc(t)}}function yi(t,e){1&t&&V.Gc(0,mi,3,1,"ul",27),2&t&&V.oc("ngForOf",e.$implicit.l0ActionList)}function vi(t,e){if(1&t&&V.Qb(0,"e-column",29),2&t){const t=e.$implicit;V.oc("field",t.field)("headerText",t.headerText)}}let Ii=(()=>{class t{constructor(t,e,i,o,n,c,a,r){this.activeModal=t,this.service=e,this.kpiScoreService=i,this.kpiService=o,this.commentService=n,this.alertify=c,this.todolistService=a,this.utilitiesService=r,this.toolbarOptions=["Search"],this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.fields={text:"point",value:"point"},this.filterSettings={type:"Excel"},this.content="",this.quarterlySettingsData=[],this.columns=[],this.queryCellInfoEvent=t=>{var e;const i=t.data;for(const o of this.quarterlySettingsData)(""+o).includes(t.column.field)&&(t.cell.innerText=(null===(e=i.resultOfMonth.filter(t=>t.month===o)[0])||void 0===e?void 0:e.title)||"N/A")}}ngOnInit(){this.kpiScoreModel={id:0,periodTypeId:this.data.periodTypeId,period:this.data.period,point:this.point,scoreBy:+JSON.parse(localStorage.getItem("user")).id,modifiedTime:null,createdTime:(new Date).toDateString(),accountId:this.data.id,scoreType:this.scoreType},this.commentModel={id:0,content:this.content,createdBy:+JSON.parse(localStorage.getItem("user")).id,accountId:this.data.id,modifiedBy:null,createdTime:(new Date).toDateString(),modifiedTime:null,period:this.data.period,periodTypeId:this.data.periodTypeId,scoreType:this.scoreType,commentTypeId:be.Comment},this.getQuarterlySetting(),this.loadData(),this.loadKPIScoreData(),this.loadKPIData(),this.getFisrtByAccountId(),this.getFisrtCommentByObjectiveId()}getMonthListInCurrentQuarter(t){return["Result of Jan.","Result of Feb.","Result of Mar.","Result of Apr.","Result of May.","Result of Jun.","Result of Jul.","Result of Aug.","Result of Sep.","Result of Oct.","Result of Nov.","Result of Dec."][t-1]}getQuarterlySetting(){this.quarterlySettingsData=this.data.settings||[],this.columns=[];for(const t of this.quarterlySettingsData)this.columns.push({field:`${t}`,headerText:this.getMonthListInCurrentQuarter(t),month:t})}loadData(){this.service.getAllKPIScoreGHRByAccountId(this.data.id,this.currentTime).subscribe(t=>{this.gridData=t})}loadKPIScoreData(){this.kpiScoreService.getById(this.data.id).subscribe(t=>{this.kpiScoreData=t})}getFisrtByAccountId(){this.kpiScoreService.getFisrtByAccountId(this.data.id,this.data.periodTypeId,this.data.period,this.scoreType).subscribe(t=>{this.point=null==t?void 0:t.point,this.kpiScoreModel.id=null==t?void 0:t.id})}getFisrtCommentByObjectiveId(){this.commentService.getFisrtByAccountId(this.data.id,this.data.periodTypeId,this.data.period,this.scoreType).subscribe(t=>{this.content=null==t?void 0:t.content,this.commentModel.id=null==t?void 0:t.id})}loadKPIData(){this.kpiService.getAll().subscribe(t=>{this.kpiData=t})}addKPIScore(){return this.kpiScoreModel.point=this.point,this.kpiScoreService.add(this.kpiScoreModel)}addComment(){return this.commentModel.content=this.content,this.commentService.add(this.commentModel)}finish(){if(!this.point)return void this.alertify.warning("Not yet complete. Can not submit!",!0);const t=this.addKPIScore();Object(fe.a)([t]).subscribe(t=>{console.log(t),t.map(t=>t.success),t=>t.every(Boolean)?(this.alertify.success(y.a.CREATED_OK_MSG),this.todolistService.changeMessage(!0)):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)})}NO(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}return t.\u0275fac=function(e){return new(e||t)(V.Pb(k.a),V.Pb(ue),V.Pb(he),V.Pb(pe),V.Pb(ge),V.Pb(f.a),V.Pb(ue),V.Pb(M.a))},t.\u0275cmp=V.Jb({type:t,selectors:[["app-kpi-score-gm"]],viewQuery:function(t,e){if(1&t&&V.Mc(gi,1),2&t){let t;V.wc(t=V.gc())&&(e.grid=t.first)}},inputs:{data:"data",periodTypeCode:"periodTypeCode",scoreType:"scoreType",currentTime:"currentTime"},decls:67,vars:15,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","p-0"],["allowTextWrap","true","gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","toolbar","pageSettings","allowExcelExport","queryCellInfo"],["grid",""],["field","#","headerText","#","textAlign","Center","width","80","type","number"],["template",""],["field","objective","headerText","KPI Objective","type","string"],["field","l0TargetList","headerText","L0 Target"],["field","l0ActionList","headerText","L0 Action"],["ngFor","",3,"ngForOf"],[1,"row","mt-2","d-flex","justify-content-center"],[1,"col-md-12"],[1,"table","table-bordered"],["scope","col"],[1,"table",2,"border","none"],["scope","col",1,"text-center",2,"border","none","width","70%","padding","0"],["scope","col",1,"text-center",2,"border","none","width","30%","padding","0"],[2,"border","none"],[1,"form-group"],[3,"dataSource","value","fields","allowFiltering","valueChange"],["accountGroupDropdownlist",""],[1,"modal-footer","justify-content-end"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-success",3,"click"],["style","padding: 0 0 0 15px;",4,"ngFor","ngForOf"],[2,"padding","0 0 0 15px"],[3,"field","headerText"]],template:function(t,e){1&t&&(V.Vb(0,"div",0),V.Vb(1,"h4",1),V.Ic(2),V.Ub(),V.Vb(3,"button",2),V.fc("click",function(){return e.activeModal.dismiss("Cross click")}),V.Vb(4,"span",3),V.Ic(5,"\xd7"),V.Ub(),V.Ub(),V.Ub(),V.Vb(6,"div",4),V.Vb(7,"ejs-grid",5,6),V.fc("queryCellInfo",function(t){return e.queryCellInfoEvent(t)}),V.Vb(9,"e-columns"),V.Vb(10,"e-column",7),V.Gc(11,fi,1,1,"ng-template",null,8,V.Hc),V.Ub(),V.Qb(13,"e-column",9),V.Qb(14,"e-column",10),V.Vb(15,"e-column",11),V.Gc(16,yi,1,1,"ng-template",null,8,V.Hc),V.Ub(),V.Gc(18,vi,1,2,"ng-template",12,8,V.Hc),V.Ub(),V.Ub(),V.Vb(20,"div",13),V.Vb(21,"div",14),V.Vb(22,"table",15),V.Vb(23,"thead"),V.Vb(24,"tr"),V.Vb(25,"th",16),V.Ic(26,"5>= X >=4.5 \u8d85\u51fa\u9810\u671f"),V.Ub(),V.Vb(27,"th",16),V.Ic(28,"4.5> X >=4 \u7b26\u5408\u9810\u671f"),V.Ub(),V.Vb(29,"th",16),V.Ic(30,"4 > X >=3 \u5927\u90e8\u5206\u7b26\u5408\u9810\u671f"),V.Ub(),V.Vb(31,"th",16),V.Ic(32,"3> X >=2 \u90e8\u5206\u7b26\u5408\u9810\u671f"),V.Ub(),V.Vb(33,"th",16),V.Ic(34,"2> X >= 0 \u4e0d\u4f73\u4e0d\u7b26\u5408\u9810\u671f"),V.Ub(),V.Ub(),V.Ub(),V.Vb(35,"tbody"),V.Vb(36,"tr"),V.Vb(37,"td"),V.Ic(38,"Exceed expectation"),V.Ub(),V.Vb(39,"td"),V.Ic(40,"Meet expectation"),V.Ub(),V.Vb(41,"td"),V.Ic(42,"Mostly meet expectation"),V.Ub(),V.Vb(43,"td"),V.Ic(44,"Partly meet expectation"),V.Ub(),V.Vb(45,"td"),V.Ic(46,"Poorly or not meet expectation"),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(47,"div",13),V.Vb(48,"div",14),V.Vb(49,"table",17),V.Vb(50,"thead"),V.Vb(51,"tr"),V.Qb(52,"th",18),V.Vb(53,"th",19),V.Ic(54,"Score"),V.Ub(),V.Ub(),V.Ub(),V.Vb(55,"tbody"),V.Vb(56,"tr"),V.Qb(57,"td",20),V.Vb(58,"td",20),V.Vb(59,"div",21),V.Vb(60,"ejs-dropdownlist",22,23),V.fc("valueChange",function(t){return e.point=t}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(62,"div",24),V.Vb(63,"button",25),V.fc("click",function(){return e.activeModal.close("Close click")}),V.Ic(64),V.Ub(),V.Vb(65,"button",26),V.fc("click",function(){return e.finish()}),V.Ic(66),V.Ub(),V.Ub(),V.Ub()),2&t&&(V.Cb(2),V.Kc("Self-score of KPI Objective (",e.data.objective,")"),V.Cb(5),V.oc("dataSource",e.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",e.toolbarOptions)("pageSettings",e.pageSettings)("allowExcelExport",!0),V.Cb(11),V.oc("ngForOf",e.columns),V.Cb(42),V.oc("dataSource",e.kpiData)("value",e.point)("fields",e.fields)("allowFiltering",!0),V.Cb(4),V.Jc("Close"),V.Cb(2),V.Jc("Finish"))},directives:[d.g,d.d,d.b,G.d,G.b,j.d,d.c,d.a,G.c,G.a,j.c,n.l,l.b],styles:["#comment[_ngcontent-%COMP%]{border:2px solid #ffc107!important;font-family:Helvetica Neue,Helvetica,Arial,sans-serif,-apple-system,BlinkMacSystemFont}#comment[_ngcontent-%COMP%], #comment.form-control[_ngcontent-%COMP%]:focus{color:#212529!important;font-size:14px!important}#comment.form-control[_ngcontent-%COMP%]:focus{background-color:#fff!important;border-color:#ffc107!important;outline:0!important;box-shadow:0 0 0 .2rem rgba(32,168,216,.25)}.e-input-group.e-control-wrapper[_ngcontent-%COMP%]:not(.e-success):not(.e-warning):not(.e-error), .e-input-group[_ngcontent-%COMP%]:not(.e-success):not(.e-warning):not(.e-error){border:2px solid #ffc107!important}"]}),t})(),Si=(()=>{class t extends Kt.a{constructor(t,e,i){super(t,"SmartScore",e,i)}}return t.\u0275fac=function(e){return new(e||t)(V.cc(h.b),V.cc(M.a),V.cc(S.a))},t.\u0275prov=V.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Ui=["grid"];function Ci(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic();V.Kc(" ",i.NO(t.index)," ")}}function Vi(t,e){if(1&t&&(V.Vb(0,"li"),V.Ic(1),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.Jc(t)}}function Ti(t,e){if(1&t&&(V.Vb(0,"ul",28),V.Gc(1,Vi,2,1,"li",29),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.oc("ngForOf",t.l0ActionList)}}let xi=(()=>{class t{constructor(t,e,i,o,n,c,a,r,s){this.activeModal=t,this.service=e,this.kpiScoreService=i,this.kpiService=o,this.objectiveService=n,this.smartScoreService=c,this.commentService=a,this.alertify=r,this.utilitiesService=s,this.toolbarOptions=["Search"],this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.fields={text:"point",value:"point"},this.filterSettings={type:"Excel"},this.content="",this.quarterlySettingsData=[],this.columns=[],this.objectiveIds=[],this.queryCellInfoEvent=t=>{var e;const i=t.data;for(const o of this.quarterlySettingsData)(""+o).includes(t.column.field)&&(t.cell.innerText=(null===(e=i.resultOfMonth.filter(t=>t.month===o)[0])||void 0===e?void 0:e.title)||"N/A")}}ngOnInit(){this.kpiScoreModel={id:0,periodTypeId:this.data.periodTypeId,period:this.data.period,point:this.point,scoreBy:+JSON.parse(localStorage.getItem("user")).id,modifiedTime:null,createdTime:(new Date).toDateString(),accountId:this.data.id,scoreType:this.scoreType},this.commentModel={id:0,content:this.content,createdBy:+JSON.parse(localStorage.getItem("user")).id,accountId:this.data.id,modifiedBy:null,createdTime:(new Date).toDateString(),modifiedTime:null,period:this.data.period,periodTypeId:this.data.periodTypeId,scoreType:this.scoreType,commentTypeId:be.Comment},this.getQuarterlySetting(),this.loadData(),this.loadKPIScoreData(),this.loadSmartScoreData(),this.loadKPIData(),this.getFisrtByAccountId(),this.getFisrtCommentByObjectiveId()}getMonthListInCurrentQuarter(t){return["Result of Jan.","Result of Feb.","Result of Mar.","Result of Apr.","Result of May.","Result of Jun.","Result of Jul.","Result of Aug.","Result of Sep.","Result of Oct.","Result of Nov.","Result of Dec."][t-1]}getQuarterlySetting(){this.quarterlySettingsData=this.data.settings||[],this.columns=[];for(const t of this.quarterlySettingsData)this.columns.push({field:`${t}`,headerText:this.getMonthListInCurrentQuarter(t),month:t})}loadData(){this.service.getAllKPIScoreGHRByAccountId(this.data.id,this.currentTime).subscribe(t=>{this.gridData=t,this.objectiveIds=t.filter(t=>1==t.isReject).map(t=>t.id)||[]})}loadKPIScoreData(){this.kpiScoreService.getById(this.data.id).subscribe(t=>{this.kpiScoreData=t})}getFisrtByAccountId(){this.kpiScoreService.getFisrtByAccountId(this.data.id,this.data.periodTypeId,this.data.period,this.scoreType).subscribe(t=>{this.point=null==t?void 0:t.point,this.kpiScoreModel.id=null==t?void 0:t.id})}getFisrtCommentByObjectiveId(){this.commentService.getFisrtByAccountId(this.data.id,this.data.periodTypeId,this.data.period,this.scoreType).subscribe(t=>{this.content=null==t?void 0:t.content,this.commentModel.id=null==t?void 0:t.id})}loadKPIData(){this.kpiService.getAll().subscribe(t=>{this.kpiData=t})}loadSmartScoreData(){this.smartScoreService.getAll().subscribe(t=>{this.smartScoreData=t})}onchangeReject(t,e){t?(this.objectiveIds.push(e.todolistId),this.objectiveIds=this.utilitiesService.toDistinct(this.objectiveIds)):this.objectiveIds=this.utilitiesService.toArrayRemove(this.objectiveIds,e.todolistId)}onChangeSmartScore(t){if(t.isInteracted){const t=this.addKPIScore();Object(fe.a)([t]).subscribe(t=>{console.log(t),t.map(t=>t.success),(t=>t.every(Boolean))||this.alertify.warning("Not yet complete. Can not release. \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0)})}}addKPIScore(){return this.kpiScoreModel.point=this.point,this.kpiScoreService.add(this.kpiScoreModel)}addComment(){return this.commentModel.content=this.content,this.commentService.add(this.commentModel)}reject(){if(this.utilitiesService.isUndefinedOrNullOrEmpty(this.content))return void this.alertify.warning("Please leave a comment. \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0);if(this.utilitiesService.isUndefinedOrNull(this.point))return void this.alertify.warning("Please score smart score first. Not yet complete. Can not release. \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0);if(0===this.objectiveIds.length)return void this.alertify.warning("There's no reject item, please check remark. \u60a8\u6c92\u6709\u9078\u64c7\u4e0d\u5408\u683c\u7684\u9805\u76ee\uff0c\u8acb\u5b8c\u6210\u52fe\u9078",!0);const t=this.addComment(),e=this.service.reject(this.objectiveIds);Object(fe.a)([t,e]).subscribe(t=>{console.log(t),t.map(t=>t.success),t=>t.every(Boolean)?(this.alertify.success("Successfully \u6210\u529f\u5730",!0),this.service.changeMessage(!0),this.activeModal.close()):this.alertify.warning("Not yet complete. Can not release. \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0)})}release(){const t=this.grid.dataSource.map(t=>t.todolistId)||[];if(0===t.length)return void this.alertify.warning("Not yet complete. Can not release. \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0);if(this.objectiveIds.length>0)return void this.alertify.warning("You ticked in reject column, please click Reject . \u60a8\u6709\u52fe\u9078\u4e0d\u5408\u683c\u7684\u9805\u76ee\uff0c\u8acb\u6309Reject",!0);if(this.utilitiesService.isUndefinedOrNull(this.point))return void this.alertify.warning("Not yet complete. Can not release. \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0);const e=this.addComment(),i=this.service.release(t);Object(fe.a)([e,i]).subscribe(t=>{console.log(t),t.map(t=>t.success),t=>t.every(Boolean)?(this.alertify.success("Successfully \u6210\u529f\u5730",!0),this.service.changeMessage(!0),this.activeModal.close()):this.alertify.warning("Not yet complete. Can not release. \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0)})}finish(){const t=this.addComment();Object(fe.a)([t]).subscribe(t=>{console.log(t),t.map(t=>t.success),t=>t.every(Boolean)?(this.alertify.success(y.a.CREATED_OK_MSG),this.service.changeMessage(!0),this.activeModal.close()):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)})}NO(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}return t.\u0275fac=function(e){return new(e||t)(V.Pb(k.a),V.Pb(ue),V.Pb(he),V.Pb(pe),V.Pb(Ht),V.Pb(Si),V.Pb(ge),V.Pb(f.a),V.Pb(M.a))},t.\u0275cmp=V.Jb({type:t,selectors:[["app-kpi-score-ghr"]],viewQuery:function(t,e){if(1&t&&V.Mc(Ui,1),2&t){let t;V.wc(t=V.gc())&&(e.grid=t.first)}},inputs:{data:"data",periodTypeCode:"periodTypeCode",scoreType:"scoreType",currentTime:"currentTime"},decls:69,vars:15,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","p-0"],["allowTextWrap","true","gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","toolbar","pageSettings","allowExcelExport","queryCellInfo"],["grid",""],["field","#","headerText","#","textAlign","Center","width","80","type","number"],["template",""],["field","objective","headerText","KPI Objective","type","string"],["field","l0TargetList","headerText","L0 Target"],["field","l0ActionList","headerText","L0 Action"],["field","deadline","format","yyyy/MM/dd","type","Date","textAlign","Center","headerText","Deadline"],[1,"row","mt-2","d-flex","justify-content-center"],[1,"col-md-12"],[1,"table","table-bordered"],["scope","col"],[1,"table",2,"border","none"],["scope","col",1,"text-center",2,"border","none","width","70%","padding","0"],["scope","col",1,"text-center",2,"border","none","width","30%","padding","0"],[2,"border","none"],[1,"form-group"],["id","comment","rows","6","type","text","placeholder","Type something!",1,"form-control",3,"ngModel","ngModelChange"],[3,"dataSource","value","fields","allowFiltering","change","valueChange"],["accountGroupDropdownlist",""],[1,"modal-footer","justify-content-end"],["type","button",1,"btn","btn-success",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[2,"padding","0 0 0 15px"],[4,"ngFor","ngForOf"]],template:function(t,e){1&t&&(V.Vb(0,"div",0),V.Vb(1,"h4",1),V.Ic(2),V.Ub(),V.Vb(3,"button",2),V.fc("click",function(){return e.activeModal.dismiss("Cross click")}),V.Vb(4,"span",3),V.Ic(5,"\xd7"),V.Ub(),V.Ub(),V.Ub(),V.Vb(6,"div",4),V.Vb(7,"ejs-grid",5,6),V.fc("queryCellInfo",function(t){return e.queryCellInfoEvent(t)}),V.Vb(9,"e-columns"),V.Vb(10,"e-column",7),V.Gc(11,Ci,1,1,"ng-template",null,8,V.Hc),V.Ub(),V.Qb(13,"e-column",9),V.Qb(14,"e-column",10),V.Vb(15,"e-column",11),V.Gc(16,Ti,2,1,"ng-template",null,8,V.Hc),V.Ub(),V.Qb(18,"e-column",12),V.Ub(),V.Ub(),V.Vb(19,"div",13),V.Vb(20,"div",14),V.Vb(21,"table",15),V.Vb(22,"thead"),V.Vb(23,"tr"),V.Vb(24,"th",16),V.Ic(25,"5>= X >=4.5 \u8d85\u51fa\u9810\u671f"),V.Ub(),V.Vb(26,"th",16),V.Ic(27,"4.5> X >=4 \u7b26\u5408\u9810\u671f"),V.Ub(),V.Vb(28,"th",16),V.Ic(29,"4 > X >=3 \u5927\u90e8\u5206\u7b26\u5408\u9810\u671f"),V.Ub(),V.Vb(30,"th",16),V.Ic(31,"3> X >=2 \u90e8\u5206\u7b26\u5408\u9810\u671f"),V.Ub(),V.Vb(32,"th",16),V.Ic(33,"2> X >= 0 \u4e0d\u4f73\u4e0d\u7b26\u5408\u9810\u671f"),V.Ub(),V.Ub(),V.Ub(),V.Vb(34,"tbody"),V.Vb(35,"tr"),V.Vb(36,"td"),V.Ic(37,"Exceed expectation"),V.Ub(),V.Vb(38,"td"),V.Ic(39,"Meet expectation"),V.Ub(),V.Vb(40,"td"),V.Ic(41,"Mostly meet expectation"),V.Ub(),V.Vb(42,"td"),V.Ic(43,"Partly meet expectation"),V.Ub(),V.Vb(44,"td"),V.Ic(45,"Poorly or not meet expectation"),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(46,"div",13),V.Vb(47,"div",14),V.Vb(48,"table",17),V.Vb(49,"thead"),V.Vb(50,"tr"),V.Vb(51,"th",18),V.Ic(52,"Comment"),V.Ub(),V.Vb(53,"th",19),V.Ic(54,"SMART Score"),V.Ub(),V.Ub(),V.Ub(),V.Vb(55,"tbody"),V.Vb(56,"tr"),V.Vb(57,"td",20),V.Vb(58,"div",21),V.Vb(59,"textarea",22),V.fc("ngModelChange",function(t){return e.content=t}),V.Ub(),V.Ub(),V.Ub(),V.Vb(60,"td",20),V.Vb(61,"div",21),V.Vb(62,"ejs-dropdownlist",23,24),V.fc("change",function(t){return e.onChangeSmartScore(t)})("valueChange",function(t){return e.point=t}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(64,"div",25),V.Vb(65,"button",26),V.fc("click",function(){return e.release()}),V.Ic(66),V.Ub(),V.Vb(67,"button",27),V.fc("click",function(){return e.activeModal.close("Close click")}),V.Ic(68),V.Ub(),V.Ub(),V.Ub()),2&t&&(V.Cb(2),V.Kc("Self-score of KPI Objective (",e.data.objective,")"),V.Cb(5),V.oc("dataSource",e.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",e.toolbarOptions)("pageSettings",e.pageSettings)("allowExcelExport",!0),V.Cb(52),V.oc("ngModel",e.content),V.Cb(3),V.oc("dataSource",e.smartScoreData)("value",e.point)("fields",e.fields)("allowFiltering",!0),V.Cb(4),V.Jc("Release"),V.Cb(2),V.Jc("Close"))},directives:[d.g,d.d,d.b,G.d,G.b,j.d,d.c,d.a,G.c,G.a,j.c,c.a,c.f,c.i,l.b,n.l],styles:["#comment[_ngcontent-%COMP%]{border:2px solid #ffc107!important;font-family:Helvetica Neue,Helvetica,Arial,sans-serif,-apple-system,BlinkMacSystemFont}#comment[_ngcontent-%COMP%], #comment.form-control[_ngcontent-%COMP%]:focus{color:#212529!important;font-size:14px!important}#comment.form-control[_ngcontent-%COMP%]:focus{background-color:#fff!important;border-color:#ffc107!important;outline:0!important;box-shadow:0 0 0 .2rem rgba(32,168,216,.25)}.e-input-group.e-control-wrapper[_ngcontent-%COMP%]:not(.e-success):not(.e-warning):not(.e-error), .e-input-group[_ngcontent-%COMP%]:not(.e-success):not(.e-warning):not(.e-error){border:2px solid #ffc107!important}input[type=checkbox][_ngcontent-%COMP%]{transform:scale(2);padding:10px}.checkboxtext[_ngcontent-%COMP%]{font-size:110%;display:inline}"]}),t})();const wi=["grid"];function Mi(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic();V.Kc(" ",i.NO(t.index)," ")}}function Di(t,e){if(1&t&&(V.Vb(0,"li"),V.Ic(1),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.Jc(t)}}function Ai(t,e){if(1&t&&(V.Vb(0,"ul",28),V.Gc(1,Di,2,1,"li",29),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.oc("ngForOf",t.l0ActionList)}}function Oi(t,e){if(1&t&&V.Qb(0,"e-column",30),2&t){const t=e.$implicit;V.oc("field",t.field)("headerText",t.headerText)}}let Pi=(()=>{class t{constructor(t,e,i,o,n,c,a){this.activeModal=t,this.service=e,this.attitudeScoreService=i,this.commentService=o,this.attitudeService=n,this.alertify=c,this.utilitiesService=a,this.toolbarOptions=["Search"],this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.fields={text:"point",value:"point"},this.filterSettings={type:"Excel"},this.content="",this.queryCellInfoEvent=t=>{var e;const i=t.data;for(const o of this.halfYearSettingsData)(""+o).includes(t.column.field)&&(t.cell.innerText=(null===(e=i.resultOfMonth.filter(t=>t.month===o)[0])||void 0===e?void 0:e.title)||"N/A")}}ngOnInit(){this.attitudeScoreModel={id:0,periodTypeId:this.data.periodTypeId,period:this.data.period,point:this.point,accountId:this.data.id,scoreBy:+JSON.parse(localStorage.getItem("user")).id,createdTime:(new Date).toDateString(),modifiedTime:null,scoreType:this.scoreType},this.contributionModel={id:0,content:this.content,createdBy:+JSON.parse(localStorage.getItem("user")).id,accountId:this.data.id,modifiedBy:null,createdTime:(new Date).toDateString(),modifiedTime:null,periodTypeId:this.data.periodTypeId,period:this.data.period,scoreType:this.scoreType},this.commentModel={id:0,content:this.content,createdBy:+JSON.parse(localStorage.getItem("user")).id,accountId:this.data.id,modifiedBy:null,createdTime:(new Date).toDateString(),modifiedTime:null,period:this.data.period,periodTypeId:this.data.periodTypeId,scoreType:this.scoreType,commentTypeId:be.Comment},this.getHalfYearSetting(),this.loadData(),this.loadAttitudeScoreData(),this.loadKPIData(),this.getFisrtCommentByObjectiveId(),this.getFisrtByObjectiveIdAndScoreBy()}getMonthListInCurrentQuarter(t){return["Result of Jan.","Result of Feb.","Result of Mar.","Result of Apr.","Result of May.","Result of Jun.","Result of Jul.","Result of Aug.","Result of Sep.","Result of Oct.","Result of Nov.","Result of Dec."][t-1]}getHalfYearSetting(){this.halfYearSettingsData=this.data.settings||[],this.columns=[];for(const t of this.halfYearSettingsData)this.columns.push({field:`${t}`,headerText:this.getMonthListInCurrentQuarter(t),month:t})}loadData(){this.service.getAllAttitudeScoreGFLByAccountId(this.data.id).subscribe(t=>{this.gridData=t})}loadAttitudeScoreData(){this.attitudeScoreService.getById(this.data.id).subscribe(t=>{this.attitudeScoreData=t})}getFisrtCommentByObjectiveId(){this.commentService.getFisrtByAccountId(this.data.id,this.data.periodTypeId,this.data.period,this.scoreType).subscribe(t=>{this.content=null==t?void 0:t.content,this.commentModel.id=null==t?void 0:t.id})}getFisrtByObjectiveIdAndScoreBy(){this.attitudeScoreService.getFunctionalLeaderAttitudeScoreByAccountId(this.data.id,this.data.periodTypeId,this.data.period).subscribe(t=>{this.point=null==t?void 0:t.point,this.attitudeScoreModel.id=null==t?void 0:t.id})}loadKPIData(){this.attitudeService.getAll().subscribe(t=>{this.attitudeData=t})}addAttitudeScore(){return this.attitudeScoreModel.point=this.point,this.attitudeScoreService.add(this.attitudeScoreModel)}addComment(){return this.commentModel.content=this.content,this.commentService.add(this.commentModel)}finish(){if(!this.point)return void this.alertify.warning("Not yet complete. Can not submit!",!0);const t=this.addAttitudeScore(),e=this.addComment();Object(fe.a)([t,e]).subscribe(t=>{console.log(t),t.map(t=>t.success),t=>t.every(Boolean)?(this.alertify.success(y.a.CREATED_OK_MSG),this.service.changeMessage(!0),this.activeModal.close()):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)})}NO(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}return t.\u0275fac=function(e){return new(e||t)(V.Pb(k.a),V.Pb(ue),V.Pb(me),V.Pb(ge),V.Pb(He),V.Pb(f.a),V.Pb(M.a))},t.\u0275cmp=V.Jb({type:t,selectors:[["app-attitude-score-functional-leader"]],viewQuery:function(t,e){if(1&t&&V.Mc(wi,1),2&t){let t;V.wc(t=V.gc())&&(e.grid=t.first)}},inputs:{data:"data",scoreType:"scoreType"},decls:78,vars:16,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","p-0"],["allowTextWrap","true","gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","toolbar","pageSettings","allowExcelExport","queryCellInfo"],["grid",""],["field","#","headerText","#","textAlign","Center","width","30","type","number"],["template",""],["field","objective","headerText","KPI Objective","type","string"],["field","l0TargetList","headerText","L0 Target","type","string"],["field","l0ActionList","headerText","L0 Action","type","string"],["ngFor","",3,"ngForOf"],[1,"row","mt-2","d-flex","justify-content-center"],[1,"col-md-12"],[1,"table","table-bordered"],["scope","col"],[1,"table",2,"border","none"],["scope","col",1,"text-center",2,"border","none","width","70%","padding","0"],["scope","col",1,"text-center",2,"border","none","width","30%","padding","0"],[2,"border","none"],[1,"form-group"],["id","comment","rows","6","type","text","placeholder","Type something!",1,"form-control",3,"ngModel","ngModelChange"],[3,"dataSource","value","fields","allowFiltering","valueChange"],["accountGroupDropdownlist",""],[1,"modal-footer","justify-content-end"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-success",3,"click"],[2,"padding","0 0 0 8px"],[4,"ngFor","ngForOf"],[3,"field","headerText"]],template:function(t,e){1&t&&(V.Vb(0,"div",0),V.Vb(1,"h4",1),V.Ic(2),V.Ub(),V.Vb(3,"button",2),V.fc("click",function(){return e.activeModal.dismiss("Cross click")}),V.Vb(4,"span",3),V.Ic(5,"\xd7"),V.Ub(),V.Ub(),V.Ub(),V.Vb(6,"div",4),V.Vb(7,"ejs-grid",5,6),V.fc("queryCellInfo",function(t){return e.queryCellInfoEvent(t)}),V.Vb(9,"e-columns"),V.Vb(10,"e-column",7),V.Gc(11,Mi,1,1,"ng-template",null,8,V.Hc),V.Ub(),V.Qb(13,"e-column",9),V.Qb(14,"e-column",10),V.Vb(15,"e-column",11),V.Gc(16,Ai,2,1,"ng-template",null,8,V.Hc),V.Ub(),V.Gc(18,Oi,1,2,"ng-template",12,8,V.Hc),V.Ub(),V.Ub(),V.Vb(20,"div",13),V.Vb(21,"div",14),V.Vb(22,"table",15),V.Vb(23,"thead"),V.Vb(24,"tr"),V.Vb(25,"th",16),V.Ic(26,"\u5de5\u4f5c\u614b\u5ea6 = \u4e3b\u52d5\u7a4d\u6975 + \u6e9d\u901a\u53caEQ + \u914d\u5408\u5ea6"),V.Ub(),V.Vb(27,"th",16),V.Ic(28,"\u975e\u5e38\u597d 10 \u5206"),V.Ub(),V.Vb(29,"th",16),V.Ic(30,"\u8f03\u597d 8-9 \u5206"),V.Ub(),V.Vb(31,"th",16),V.Ic(32,"\u4e00\u822c 6-7 \u5206"),V.Ub(),V.Vb(33,"th",16),V.Ic(34,"\u8f03\u5dee 4-5 \u5206"),V.Ub(),V.Vb(35,"th",16),V.Ic(36,"\u6975\u5dee 3 \u5206\u4ee5\u4e0b"),V.Ub(),V.Ub(),V.Ub(),V.Vb(37,"tbody"),V.Vb(38,"tr"),V.Vb(39,"td"),V.Ic(40,"Attitude = Proactiveness + Communication & EQ + Cooperation"),V.Ub(),V.Vb(41,"td"),V.Ic(42,"Excellent 10 points"),V.Ub(),V.Vb(43,"td"),V.Ic(44,"Good 8-9 points"),V.Ub(),V.Vb(45,"td"),V.Ic(46,"Normal 6-7 points"),V.Ub(),V.Vb(47,"td"),V.Ic(48,"Not goo 4-5 points"),V.Ub(),V.Vb(49,"td"),V.Ic(50,"Poor 3 points or below"),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(51,"div",13),V.Vb(52,"div",14),V.Vb(53,"table",17),V.Vb(54,"thead"),V.Vb(55,"tr"),V.Vb(56,"th",18),V.Ic(57,"Functional leader comment"),V.Qb(58,"br"),V.Ic(59," \u529f\u80fd\u4e3b\u7ba1\u8a55\u8a9e\uff1a"),V.Ub(),V.Vb(60,"th",19),V.Ic(61,"Fuctional leader give Attitude Score"),V.Qb(62,"br"),V.Ic(63," \u529f\u80fd\u4e3b\u7ba1\u7d66\u4e88\u614b\u5ea6\u5206\u6578\uff1a"),V.Ub(),V.Ub(),V.Ub(),V.Vb(64,"tbody"),V.Vb(65,"tr"),V.Vb(66,"td",20),V.Vb(67,"div",21),V.Vb(68,"textarea",22),V.fc("ngModelChange",function(t){return e.content=t}),V.Ub(),V.Ub(),V.Ub(),V.Vb(69,"td",20),V.Vb(70,"div",21),V.Vb(71,"ejs-dropdownlist",23,24),V.fc("valueChange",function(t){return e.point=t}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(73,"div",25),V.Vb(74,"button",26),V.fc("click",function(){return e.activeModal.close("Close click")}),V.Ic(75),V.Ub(),V.Vb(76,"button",27),V.fc("click",function(){return e.finish()}),V.Ic(77),V.Ub(),V.Ub(),V.Ub()),2&t&&(V.Cb(2),V.Kc("Attitude-score of KPI Objective (",e.data.objective,")"),V.Cb(5),V.oc("dataSource",e.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",e.toolbarOptions)("pageSettings",e.pageSettings)("allowExcelExport",!0),V.Cb(11),V.oc("ngForOf",e.columns),V.Cb(50),V.oc("ngModel",e.content),V.Cb(3),V.oc("dataSource",e.attitudeData)("value",e.point)("fields",e.fields)("allowFiltering",!0),V.Cb(4),V.Jc("Close"),V.Cb(2),V.Jc("Finish"))},directives:[d.g,d.d,d.b,G.d,G.b,j.d,d.c,d.a,G.c,G.a,j.c,n.l,c.a,c.f,c.i,l.b],styles:["#comment[_ngcontent-%COMP%]{border:2px solid #ffc107!important;font-family:Helvetica Neue,Helvetica,Arial,sans-serif,-apple-system,BlinkMacSystemFont}#comment[_ngcontent-%COMP%], #comment.form-control[_ngcontent-%COMP%]:focus{color:#212529!important;font-size:14px!important}#comment.form-control[_ngcontent-%COMP%]:focus{background-color:#fff!important;border-color:#ffc107!important;outline:0!important;box-shadow:0 0 0 .2rem rgba(32,168,216,.25)}.e-input-group.e-control-wrapper[_ngcontent-%COMP%]:not(.e-success):not(.e-warning):not(.e-error), .e-input-group[_ngcontent-%COMP%]:not(.e-success):not(.e-warning):not(.e-error){border:2px solid #ffc107!important}"]}),t})();const ki=["grid"];function Li(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic();V.Kc(" ",i.NO(t.index)," ")}}function Gi(t,e){if(1&t&&(V.Vb(0,"li"),V.Ic(1),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.Jc(t)}}function ji(t,e){if(1&t&&(V.Vb(0,"ul",34),V.Gc(1,Gi,2,1,"li",35),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.oc("ngForOf",t.l0ActionList)}}function Ri(t,e){if(1&t&&V.Qb(0,"e-column",36),2&t){const t=e.$implicit;V.oc("field",t.field)("headerText",t.headerText)}}function $i(t,e){if(1&t&&(V.Vb(0,"table",19),V.Vb(1,"thead"),V.Vb(2,"tr"),V.Vb(3,"th",20),V.Ic(4,"Self - Evaluation"),V.Qb(5,"br"),V.Ic(6,"\u81ea\u6211\u8a55\u50f9"),V.Ub(),V.Vb(7,"th",37),V.Ic(8),V.Ub(),V.Vb(9,"th",38),V.Ic(10),V.Qb(11,"br"),V.Ic(12),V.Ub(),V.Ub(),V.Ub(),V.Ub()),2&t){const t=V.ic();V.Cb(8),V.Jc(t.selfEvaluationCommentContent),V.Cb(2),V.Kc("",(null==t.data?null:t.data.fullName)||""," Self-Score"),V.Cb(2),V.Kc("\u81ea\u8a55\u5206\u6578\uff1a",t.selfPoint,"")}}function Fi(t,e){1&t&&(V.Vb(0,"div",39),V.Vb(1,"strong",40),V.Ic(2," Please ask L0 to self-score!"),V.Ub(),V.Ub())}function Ei(t,e){1&t&&(V.Vb(0,"div",39),V.Vb(1,"strong",40),V.Ic(2," Please ask L1 to score attitude score L0!"),V.Ub(),V.Ub())}let Bi=(()=>{class t{constructor(t,e,i,o,n,c,a,r,s){this.activeModal=t,this.service=e,this.kpiScoreService=i,this.kpiService=o,this.commentService=n,this.alertify=c,this.utilitiesService=a,this.todolistService=r,this.attitudeScoreService=s,this.toolbarOptions=["Search"],this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.fields={text:"point",value:"point"},this.filterSettings={type:"Excel"},this.content="",this.quarterlySettingsData=[],this.columns=[],this.l1Scored=!1,this.selfScored=!1,this.hasFunctionalLeader=!1,this.queryCellInfoEvent=t=>{var e;const i=t.data;for(const o of this.quarterlySettingsData)(""+o).includes(t.column.field)&&(t.cell.innerText=(null===(e=i.resultOfMonth.filter(t=>t.month===o)[0])||void 0===e?void 0:e.title)||"N/A")}}ngOnInit(){this.hasFunctionalLeader=this.data.hasFunctionalLeader,this.isQuarter2Or4=this.data.period==de.Q2||this.data.period==de.Q4,this.kpiScoreModel={id:0,periodTypeId:this.data.periodTypeId,period:this.data.period,point:this.point,scoreBy:+JSON.parse(localStorage.getItem("user")).id,modifiedTime:null,createdTime:(new Date).toDateString(),accountId:this.data.id,scoreType:this.scoreType},this.commentModel={id:0,content:this.content,createdBy:+JSON.parse(localStorage.getItem("user")).id,accountId:this.data.id,modifiedBy:null,createdTime:(new Date).toDateString(),modifiedTime:null,period:this.data.period,periodTypeId:this.data.periodTypeId,scoreType:this.scoreType,commentTypeId:be.Comment},!0===this.isQuarter2Or4&&this.getFisrtSelfScoreL1ByAccountId(),this.getL1CommentByAccountId(),this.getFisrtKPIScoreL1ByAccountId(),this.getQuarterlySetting(),this.loadData(),this.loadKPIScoreData(),this.loadKPIData(),this.getFisrtByAccountId(),this.getFisrtCommentByObjectiveId(),this.getL2SelfEvaluationCommentByAccountId()}getFunctionalLeaderCommentByAccountId(){this.commentService.getFunctionalLeaderCommentByAccountId(this.data.id,this.data.halfYearId,this.data.halfYearPeriod).subscribe(t=>{this.functionalLeaderCommentContent=null==t?void 0:t.content})}getFunctionalLeaderAttitudeScoreByAccountId(){this.attitudeScoreService.getFunctionalLeaderAttitudeScoreByAccountId(this.data.id,this.data.halfYearId,this.data.halfYearPeriod).subscribe(t=>{this.functionalLeaderAttitudeScoreData=(null==t?void 0:t.point)||0,this.functionalLeaderScored=this.functionalLeaderAttitudeScoreData>0})}getFisrtSelfScoreL1ByAccountId(){this.kpiScoreService.getFisrtSelfScoreL1ByAccountId(this.data.id,this.data.halfYearId,this.data.halfYearPeriod,re.L0).subscribe(t=>{this.selfPoint=(null==t?void 0:t.point)||0,this.selfScored=this.selfPoint>0})}getL2SelfEvaluationCommentByAccountId(){this.commentService.getL2SelfEvaluationCommentByAccountId(this.data.id,this.data.halfYearId,this.data.halfYearPeriod).subscribe(t=>{this.selfEvaluationCommentContent=null==t?void 0:t.content})}getMonthListInCurrentQuarter(t){return["Result of Jan.","Result of Feb.","Result of Mar.","Result of Apr.","Result of May.","Result of Jun.","Result of Jul.","Result of Aug.","Result of Sep.","Result of Oct.","Result of Nov.","Result of Dec."][t-1]}getQuarterlySetting(){this.quarterlySettingsData=this.data.settings||[],this.columns=[];for(const t of this.quarterlySettingsData)this.columns.push({field:`${t}`,headerText:this.getMonthListInCurrentQuarter(t),month:t})}loadData(){this.service.getAllKPIScoreL2ByAccountId(this.data.id,this.currentTime).subscribe(t=>{this.gridData=t})}loadKPIScoreData(){this.kpiScoreService.getById(this.data.id).subscribe(t=>{this.kpiScoreData=t})}getFisrtByAccountId(){this.kpiScoreService.getFisrtByAccountId(this.data.id,this.data.periodTypeId,this.data.period,this.scoreType).subscribe(t=>{this.point=null==t?void 0:t.point,this.kpiScoreModel.id=null==t?void 0:t.id})}getFisrtKPIScoreL1ByAccountId(){this.kpiScoreService.getFisrtKPIScoreL1ByAccountId(this.data.id,this.data.periodTypeId,this.data.period,this.scoreType).subscribe(t=>{this.l1Point=(null==t?void 0:t.point)||0,this.l1Scored=this.l1Point>0})}getL1CommentByAccountId(){this.commentService.getL1CommentByAccountId(this.data.id,this.data.periodTypeId,this.data.period).subscribe(t=>{this.l1CommentContent=null==t?void 0:t.content})}getFisrtCommentByObjectiveId(){this.commentService.getFisrtByAccountId(this.data.id,this.data.periodTypeId,this.data.period,this.scoreType).subscribe(t=>{this.content=null==t?void 0:t.content,this.commentModel.id=null==t?void 0:t.id})}loadKPIData(){this.kpiService.getAll().subscribe(t=>{this.kpiData=t})}addKPIScore(){return this.kpiScoreModel.point=this.point,this.kpiScoreService.add(this.kpiScoreModel)}addComment(){return this.commentModel.content=this.content,this.commentService.add(this.commentModel)}isShowSelfScore(){return[2,4].includes(this.data.period)}finish(){if(!this.point)return void this.alertify.warning("Not yet complete. Can not submit! \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0);const t=this.addKPIScore(),e=this.addComment();Object(fe.a)([t,e]).subscribe(t=>{console.log(t),t.map(t=>t.success),t=>t.every(Boolean)?(this.alertify.success(y.a.CREATED_OK_MSG),this.todolistService.changeMessage(!0),this.activeModal.close()):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)})}NO(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}return t.\u0275fac=function(e){return new(e||t)(V.Pb(k.a),V.Pb(ue),V.Pb(he),V.Pb(pe),V.Pb(ge),V.Pb(f.a),V.Pb(M.a),V.Pb(ue),V.Pb(me))},t.\u0275cmp=V.Jb({type:t,selectors:[["app-kpi-score-l2"]],viewQuery:function(t,e){if(1&t&&V.Mc(ki,1),2&t){let t;V.wc(t=V.gc())&&(e.grid=t.first)}},inputs:{data:"data",periodTypeCode:"periodTypeCode",scoreType:"scoreType",currentTime:"currentTime"},decls:88,vars:22,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","p-0"],["allowTextWrap","true","gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","toolbar","pageSettings","allowExcelExport","queryCellInfo"],["grid",""],["field","#","headerText","#","textAlign","Center","width","80","type","number"],["template",""],["field","objective","headerText","KPI Objective","type","string"],["field","l0TargetList","headerText","L0 Target"],["field","l0ActionList","headerText","L0 Action"],["ngFor","",3,"ngForOf"],[1,"row","mt-2","d-flex","justify-content-center"],[1,"col-md-12"],[1,"table","table-bordered"],["scope","col"],["class","table",4,"ngIf"],["class","alert alert-danger text-center","role","alert",4,"ngIf"],[1,"table"],["scope","col",2,"width","20%"],["scope","col",2,"width","50%"],["scope","col",2,"width","10%","text-align","center","font-size","xx-large"],[1,"table",2,"border","none"],["scope","col",1,"text-center",2,"border","none","width","70%","padding","0"],["scope","col",1,"text-center",2,"border","none","width","30%","padding","0"],[2,"border","none"],[1,"form-group"],["id","comment","rows","6","type","text","placeholder","Type something!",1,"form-control",3,"ngModel","ngModelChange"],[3,"dataSource","value","fields","allowFiltering","valueChange"],["accountGroupDropdownlist",""],[1,"modal-footer","justify-content-end"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-success",3,"disabled","click"],[2,"padding","0 0 0 15px"],[4,"ngFor","ngForOf"],[3,"field","headerText"],["scope","col",2,"width","50%","text-align","left"],["scope","col",2,"width","30%","text-align","left"],["role","alert",1,"alert","alert-danger","text-center"],[1,"text-center"]],template:function(t,e){1&t&&(V.Vb(0,"div",0),V.Vb(1,"h4",1),V.Ic(2),V.Ub(),V.Vb(3,"button",2),V.fc("click",function(){return e.activeModal.dismiss("Cross click")}),V.Vb(4,"span",3),V.Ic(5,"\xd7"),V.Ub(),V.Ub(),V.Ub(),V.Vb(6,"div",4),V.Vb(7,"ejs-grid",5,6),V.fc("queryCellInfo",function(t){return e.queryCellInfoEvent(t)}),V.Vb(9,"e-columns"),V.Vb(10,"e-column",7),V.Gc(11,Li,1,1,"ng-template",null,8,V.Hc),V.Ub(),V.Qb(13,"e-column",9),V.Qb(14,"e-column",10),V.Vb(15,"e-column",11),V.Gc(16,ji,2,1,"ng-template",null,8,V.Hc),V.Ub(),V.Gc(18,Ri,1,2,"ng-template",12,8,V.Hc),V.Ub(),V.Ub(),V.Vb(20,"div",13),V.Vb(21,"div",14),V.Vb(22,"table",15),V.Vb(23,"thead"),V.Vb(24,"tr"),V.Vb(25,"th",16),V.Ic(26,"5>= X >=4.5 \u8d85\u51fa\u9810\u671f"),V.Ub(),V.Vb(27,"th",16),V.Ic(28,"4.5> X >=4 \u7b26\u5408\u9810\u671f"),V.Ub(),V.Vb(29,"th",16),V.Ic(30,"4 > X >=3 \u5927\u90e8\u5206\u7b26\u5408\u9810\u671f"),V.Ub(),V.Vb(31,"th",16),V.Ic(32,"3> X >=2 \u90e8\u5206\u7b26\u5408\u9810\u671f"),V.Ub(),V.Vb(33,"th",16),V.Ic(34,"2> X >= 0 \u4e0d\u4f73\u4e0d\u7b26\u5408\u9810\u671f"),V.Ub(),V.Ub(),V.Ub(),V.Vb(35,"tbody"),V.Vb(36,"tr"),V.Vb(37,"td"),V.Ic(38,"Exceed expectation"),V.Ub(),V.Vb(39,"td"),V.Ic(40,"Meet expectation"),V.Ub(),V.Vb(41,"td"),V.Ic(42,"Mostly meet expectation"),V.Ub(),V.Vb(43,"td"),V.Ic(44,"Partly meet expectation"),V.Ub(),V.Vb(45,"td"),V.Ic(46,"Poorly or not meet expectation"),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(47,"div",13),V.Vb(48,"div",14),V.Gc(49,$i,13,3,"table",17),V.Gc(50,Fi,3,0,"div",18),V.Vb(51,"table",19),V.Vb(52,"thead"),V.Vb(53,"tr"),V.Vb(54,"th",20),V.Ic(55,"L1 comment"),V.Qb(56,"br"),V.Ic(57,"\u76f4\u5c6c\u4e3b\u7ba1\u8a55\u8a9e\uff1a"),V.Ub(),V.Vb(58,"th",21),V.Ic(59),V.Ub(),V.Vb(60,"th",20),V.Ic(61,"L1 score"),V.Qb(62,"br"),V.Ic(63,"\u76f4\u5c6c\u4e3b\u7ba1\u8a55\u5206"),V.Ub(),V.Vb(64,"th",22),V.Ic(65),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Gc(66,Ei,3,0,"div",18),V.Vb(67,"table",23),V.Vb(68,"thead"),V.Vb(69,"tr"),V.Vb(70,"th",24),V.Ic(71,"Comment"),V.Ub(),V.Vb(72,"th",25),V.Ic(73,"KPI Score"),V.Ub(),V.Ub(),V.Ub(),V.Vb(74,"tbody"),V.Vb(75,"tr"),V.Vb(76,"td",26),V.Vb(77,"div",27),V.Vb(78,"textarea",28),V.fc("ngModelChange",function(t){return e.content=t}),V.Ub(),V.Ub(),V.Ub(),V.Vb(79,"td",26),V.Vb(80,"div",27),V.Vb(81,"ejs-dropdownlist",29,30),V.fc("valueChange",function(t){return e.point=t}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(83,"div",31),V.Vb(84,"button",32),V.fc("click",function(){return e.activeModal.close("Close click")}),V.Ic(85),V.Ub(),V.Vb(86,"button",33),V.fc("click",function(){return e.finish()}),V.Ic(87),V.Ub(),V.Ub(),V.Ub()),2&t&&(V.Cb(2),V.Kc("Self-score of KPI Objective (",e.data.objective,") - L2"),V.Cb(5),V.oc("dataSource",e.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",e.toolbarOptions)("pageSettings",e.pageSettings)("allowExcelExport",!0),V.Cb(11),V.oc("ngForOf",e.columns),V.Cb(31),V.oc("ngIf",e.isQuarter2Or4),V.Cb(1),V.oc("ngIf",e.isQuarter2Or4&&!1===e.selfScored),V.Cb(9),V.Jc(e.l1CommentContent||""),V.Cb(6),V.Jc(e.l1Point||0),V.Cb(1),V.oc("ngIf",!1===e.l1Scored),V.Cb(12),V.oc("ngModel",e.content),V.Cb(3),V.oc("dataSource",e.kpiData)("value",e.point)("fields",e.fields)("allowFiltering",!0),V.Cb(4),V.Jc("Close"),V.Cb(1),V.oc("disabled",!1===e.l1Scored||e.isQuarter2Or4&&!1===e.selfScored),V.Cb(1),V.Jc("Finish"))},directives:[d.g,d.d,d.b,G.d,G.b,j.d,d.c,d.a,G.c,G.a,j.c,n.l,n.m,c.a,c.f,c.i,l.b],styles:["#comment[_ngcontent-%COMP%]{border:2px solid #ffc107!important;font-family:Helvetica Neue,Helvetica,Arial,sans-serif,-apple-system,BlinkMacSystemFont}#comment[_ngcontent-%COMP%], #comment.form-control[_ngcontent-%COMP%]:focus{color:#212529!important;font-size:14px!important}#comment.form-control[_ngcontent-%COMP%]:focus{background-color:#fff!important;border-color:#ffc107!important;outline:0!important;box-shadow:0 0 0 .2rem rgba(32,168,216,.25)}.e-input-group.e-control-wrapper[_ngcontent-%COMP%]:not(.e-success):not(.e-warning):not(.e-error), .e-input-group[_ngcontent-%COMP%]:not(.e-success):not(.e-warning):not(.e-error){border:2px solid #ffc107!important}"]}),t})(),_i=(()=>{class t{constructor(t){this.template=t}}return t.\u0275fac=function(e){return new(e||t)(V.Pb(V.L))},t.\u0275dir=V.Kb({type:t,selectors:[["ng-template","name",""]],inputs:{name:"name"}}),t})();var Ni=i("BrIm");const Ki=["grid"],Hi=["importModal"],Ji=["remoteDataBinding"];function zi(t,e){if(1&t&&(V.Vb(0,"div"),V.Ic(1),V.Ub()),2&t){const t=V.ic().$implicit;V.Cb(1),V.Kc(" ",t.name," ")}}function Qi(t,e){if(1&t&&(V.Tb(0),V.Vb(1,"e-tabitem",17),V.Gc(2,zi,2,1,"ng-template",null,18,V.Hc),V.Ub(),V.Sb()),2&t){const t=e.$implicit,i=V.ic();V.Cb(1),V.oc("content",i.getGridTemplate(t.position))}}function Yi(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic(3);V.Kc(" ",i.NO(t.index)," ")}}function qi(t,e){1&t&&(V.Vb(0,"span",28),V.Ic(1,"Rejected"),V.Ub())}function Wi(t,e){1&t&&(V.Vb(0,"span",29),V.Ic(1,"Done"),V.Ub())}function Xi(t,e){if(1&t&&(V.Vb(0,"span"),V.Ic(1),V.Ub(),V.Gc(2,qi,2,0,"span",26),V.Gc(3,Wi,2,0,"span",27)),2&t){const t=e.$implicit;V.Cb(1),V.Jc(t.topic),V.Cb(1),V.oc("ngIf",t.isReject&&t.isDisplayAction),V.Cb(1),V.oc("ngIf",t.isUpdatedResult)}}function Zi(t,e){if(1&t){const t=V.Wb();V.Vb(0,"button",32),V.fc("click",function(){V.Ac(t);const e=V.ic().$implicit;return V.ic(3).openActionModalComponent(e)}),V.Ic(1,"Action"),V.Ub()}}function to(t,e){if(1&t){const t=V.Wb();V.Vb(0,"button",32),V.fc("click",function(){V.Ac(t);const e=V.ic().$implicit;return V.ic(3).openUpdateResultModalComponent(e)}),V.Ic(1,"Update Result"),V.Ub()}}function eo(t,e){if(1&t){const t=V.Wb();V.Vb(0,"button",32),V.fc("click",function(){V.Ac(t);const e=V.ic().$implicit;return V.ic(3).openSelfScoreModalComponent(e)}),V.Ic(1,"Self-score"),V.Ub()}}function io(t,e){if(1&t&&(V.Vb(0,"div",30),V.Gc(1,Zi,2,0,"button",31),V.Gc(2,to,2,0,"button",31),V.Gc(3,eo,2,0,"button",31),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.oc("ngIf",t.isDisplayAction),V.Cb(1),V.oc("ngIf",t.isDisplayUploadResult),V.Cb(1),V.oc("ngIf",t.isDisplaySelfScore)}}function oo(t,e){if(1&t&&(V.Vb(0,"div"),V.Vb(1,"ejs-grid",20,21),V.Vb(3,"e-columns"),V.Vb(4,"e-column",22),V.Gc(5,Yi,1,1,"ng-template",null,23,V.Hc),V.Ub(),V.Vb(7,"e-column",24),V.Gc(8,Xi,4,3,"ng-template",null,23,V.Hc),V.Ub(),V.Vb(10,"e-column",25),V.Gc(11,io,4,3,"ng-template",null,23,V.Hc),V.Ub(),V.Ub(),V.Ub(),V.Ub()),2&t){const t=V.ic(2);V.Cb(1),V.oc("dataSource",t.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings)("allowExcelExport",!0)}}function no(t,e){1&t&&(V.Vb(0,"div"),V.Vb(1,"p",33),V.Ic(2," No authority to view. "),V.Ub(),V.Ub())}function co(t,e){if(1&t&&(V.Gc(0,oo,13,7,"div",19),V.Gc(1,no,3,0,"div",19)),2&t){const t=V.ic();V.oc("ngIf",t.isAllowAccess(1)),V.Cb(1),V.oc("ngIf",!t.isAllowAccess(1))}}function ao(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic(3);V.Kc(" ",i.NO(t.index)," ")}}function ro(t,e){if(1&t){const t=V.Wb();V.Vb(0,"button",32),V.fc("click",function(){V.Ac(t);const e=V.ic().$implicit;return V.ic(3).openKPIScoreModalComponent(e)}),V.Ic(1,"KPI Score"),V.Ub()}}function so(t,e){if(1&t){const t=V.Wb();V.Vb(0,"button",32),V.fc("click",function(){V.Ac(t);const e=V.ic().$implicit;return V.ic(3).openAttitudeScoreModalComponent(e)}),V.Ic(1,"Attitude Score"),V.Ub()}}function lo(t,e){if(1&t&&(V.Vb(0,"div",30),V.Gc(1,ro,2,0,"button",31),V.Gc(2,so,2,0,"button",31),V.Ub()),2&t){const t=e.$implicit,i=V.ic(3);V.Cb(1),V.oc("ngIf",t.type==i.KPI),V.Cb(1),V.oc("ngIf",t.type==i.Attitude)}}function bo(t,e){if(1&t&&(V.Vb(0,"div"),V.Vb(1,"ejs-grid",20,21),V.Vb(3,"e-columns"),V.Vb(4,"e-column",22),V.Gc(5,ao,1,1,"ng-template",null,23,V.Hc),V.Ub(),V.Qb(7,"e-column",34),V.Vb(8,"e-column",25),V.Gc(9,lo,3,2,"ng-template",null,23,V.Hc),V.Ub(),V.Ub(),V.Ub(),V.Ub()),2&t){const t=V.ic(2);V.Cb(1),V.oc("dataSource",t.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings)("allowExcelExport",!0)}}function uo(t,e){1&t&&(V.Vb(0,"div"),V.Vb(1,"p",33),V.Ic(2," No authority to view. "),V.Ub(),V.Ub())}function ho(t,e){if(1&t&&(V.Gc(0,bo,11,7,"div",19),V.Gc(1,uo,3,0,"div",19)),2&t){const t=V.ic();V.oc("ngIf",t.isAllowAccess(2)),V.Cb(1),V.oc("ngIf",!t.isAllowAccess(2))}}function po(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic(3);V.Kc(" ",i.NO(t.index)," ")}}function go(t,e){if(1&t){const t=V.Wb();V.Vb(0,"button",32),V.fc("click",function(){V.Ac(t);const e=V.ic().$implicit;return V.ic(3).openKPIScoreL2ModalComponent(e)}),V.Ic(1,"KPI Score"),V.Ub()}}function fo(t,e){if(1&t){const t=V.Wb();V.Vb(0,"button",32),V.fc("click",function(){V.Ac(t);const e=V.ic().$implicit;return V.ic(3).openAttitudeScoreL2ModalComponent(e)}),V.Ic(1,"Attitude Score"),V.Ub()}}function mo(t,e){if(1&t&&(V.Vb(0,"div",30),V.Gc(1,go,2,0,"button",31),V.Gc(2,fo,2,0,"button",31),V.Ub()),2&t){const t=e.$implicit,i=V.ic(3);V.Cb(1),V.oc("ngIf",t.type==i.KPI),V.Cb(1),V.oc("ngIf",t.type==i.Attitude)}}function yo(t,e){if(1&t&&(V.Vb(0,"div"),V.Vb(1,"ejs-grid",20,21),V.Vb(3,"e-columns"),V.Vb(4,"e-column",22),V.Gc(5,po,1,1,"ng-template",null,23,V.Hc),V.Ub(),V.Qb(7,"e-column",34),V.Vb(8,"e-column",25),V.Gc(9,mo,3,2,"ng-template",null,23,V.Hc),V.Ub(),V.Ub(),V.Ub(),V.Ub()),2&t){const t=V.ic(2);V.Cb(1),V.oc("dataSource",t.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings)("allowExcelExport",!0)}}function vo(t,e){1&t&&(V.Vb(0,"div"),V.Vb(1,"p",33),V.Ic(2," No authority to view. "),V.Ub(),V.Ub())}function Io(t,e){if(1&t&&(V.Gc(0,yo,11,7,"div",19),V.Gc(1,vo,3,0,"div",19)),2&t){const t=V.ic();V.oc("ngIf",t.isAllowAccess(3)),V.Cb(1),V.oc("ngIf",!t.isAllowAccess(3))}}function So(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic(2);V.Kc(" ",i.NO(t.index)," ")}}function Uo(t,e){if(1&t){const t=V.Wb();V.Vb(0,"div",30),V.Vb(1,"button",32),V.fc("click",function(){return V.Ac(t),V.ic(2).gotoUpdate()}),V.Ic(2,"Update"),V.Ub(),V.Ub()}}function Co(t,e){if(1&t&&(V.Vb(0,"div"),V.Vb(1,"ejs-grid",20,21),V.Vb(3,"e-columns"),V.Vb(4,"e-column",22),V.Gc(5,So,1,1,"ng-template",null,23,V.Hc),V.Ub(),V.Qb(7,"e-column",35),V.Vb(8,"e-column",25),V.Gc(9,Uo,3,0,"ng-template",null,23,V.Hc),V.Ub(),V.Ub(),V.Ub(),V.Ub()),2&t){const t=V.ic();V.Cb(1),V.oc("dataSource",t.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings)("allowExcelExport",!0)}}function Vo(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic(3);V.Kc(" ",i.NO(t.index)," ")}}function To(t,e){if(1&t){const t=V.Wb();V.Vb(0,"button",32),V.fc("click",function(){V.Ac(t);const e=V.ic().$implicit;return V.ic(3).openKPIScoreGHRModalComponent(e)}),V.Ic(1,"SMART Score"),V.Ub()}}function xo(t,e){if(1&t){const t=V.Wb();V.Vb(0,"button",32),V.fc("click",function(){V.Ac(t);const e=V.ic().$implicit;return V.ic(3).openAttitudeScoreGHRModalComponent(e)}),V.Ic(1,"Attitude Score"),V.Ub()}}function wo(t,e){if(1&t&&(V.Vb(0,"div",30),V.Gc(1,To,2,0,"button",31),V.Gc(2,xo,2,0,"button",31),V.Ub()),2&t){const t=e.$implicit,i=V.ic(3);V.Cb(1),V.oc("ngIf",t.type==i.KPI),V.Cb(1),V.oc("ngIf",t.type==i.Attitude)}}function Mo(t,e){if(1&t&&(V.Vb(0,"div"),V.Vb(1,"ejs-grid",20,21),V.Vb(3,"e-columns"),V.Vb(4,"e-column",22),V.Gc(5,Vo,1,1,"ng-template",null,23,V.Hc),V.Ub(),V.Qb(7,"e-column",34),V.Vb(8,"e-column",25),V.Gc(9,wo,3,2,"ng-template",null,23,V.Hc),V.Ub(),V.Ub(),V.Ub(),V.Ub()),2&t){const t=V.ic(2);V.Cb(1),V.oc("dataSource",t.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings)("allowExcelExport",!0)}}function Do(t,e){1&t&&(V.Vb(0,"div"),V.Vb(1,"p",33),V.Ic(2," No authority to view. "),V.Ub(),V.Ub())}function Ao(t,e){if(1&t&&(V.Gc(0,Mo,11,7,"div",19),V.Gc(1,Do,3,0,"div",19)),2&t){const t=V.ic();V.oc("ngIf",t.isAllowAccess(5)),V.Cb(1),V.oc("ngIf",!t.isAllowAccess(5))}}function Oo(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic(3);V.Kc(" ",i.NO(t.index)," ")}}function Po(t,e){if(1&t){const t=V.Wb();V.Vb(0,"div",30),V.Vb(1,"button",37),V.fc("click",function(){V.Ac(t);const i=e.$implicit;return V.ic(3).openAttitudeScoreFunctionalLeaderModalComponent(i)}),V.Ic(2,"Attitude Score"),V.Ub(),V.Ub()}}function ko(t,e){if(1&t&&(V.Vb(0,"div"),V.Vb(1,"ejs-grid",20,21),V.Vb(3,"e-columns"),V.Vb(4,"e-column",22),V.Gc(5,Oo,1,1,"ng-template",null,23,V.Hc),V.Ub(),V.Qb(7,"e-column",36),V.Vb(8,"e-column",25),V.Gc(9,Po,3,0,"ng-template",null,23,V.Hc),V.Ub(),V.Ub(),V.Ub(),V.Ub()),2&t){const t=V.ic(2);V.Cb(1),V.oc("dataSource",t.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings)("allowExcelExport",!0)}}function Lo(t,e){1&t&&(V.Vb(0,"div"),V.Vb(1,"p",33),V.Ic(2," No authority to view. "),V.Ub(),V.Ub())}function Go(t,e){if(1&t&&(V.Gc(0,ko,11,7,"div",19),V.Gc(1,Lo,3,0,"div",19)),2&t){const t=V.ic();V.oc("ngIf",t.isAllowAccess(6)),V.Cb(1),V.oc("ngIf",!t.isAllowAccess(6))}}function jo(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic(2);V.Kc(" ",i.NO(t.index)," ")}}function Ro(t,e){if(1&t){const t=V.Wb();V.Vb(0,"div",30),V.Vb(1,"button",32),V.fc("click",function(){V.Ac(t);const i=e.$implicit;return V.ic(2).openKPIScoreGMModalComponent(i)}),V.Ic(2,"KPI Score"),V.Ub(),V.Ub()}}function $o(t,e){if(1&t&&(V.Vb(0,"ejs-grid",20,21),V.Vb(2,"e-columns"),V.Vb(3,"e-column",22),V.Gc(4,jo,1,1,"ng-template",null,23,V.Hc),V.Ub(),V.Qb(6,"e-column",34),V.Vb(7,"e-column",25),V.Gc(8,Ro,3,0,"ng-template",null,23,V.Hc),V.Ub(),V.Ub(),V.Ub()),2&t){const t=V.ic();V.oc("dataSource",t.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings)("allowExcelExport",!0)}}function Fo(t,e){if(1&t){const t=V.Wb();V.Vb(0,"div",38),V.Vb(1,"h4",39),V.Qb(2,"i",40),V.Ic(3," Import Excel "),V.Ub(),V.Vb(4,"button",41),V.fc("click",function(){return e.$implicit.dismiss("Cross click")}),V.Vb(5,"span",42),V.Ic(6,"\xd7"),V.Ub(),V.Ub(),V.Ub(),V.Vb(7,"div",43),V.Vb(8,"div",0),V.Vb(9,"div",44),V.Vb(10,"div",2),V.Vb(11,"label",45),V.Ic(12,"Select File (*Notice: Excel file must be followed a system template. If you do not have a template, please "),V.Vb(13,"a",46),V.Ic(14,"click here"),V.Ub(),V.Ic(15," to download. Thank you!)"),V.Ub(),V.Vb(16,"input",47),V.fc("change",function(e){return V.Ac(t),V.ic().fileProgress(e)}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(17,"div",48),V.Vb(18,"button",49),V.fc("click",function(){return V.Ac(t),V.ic().uploadFile()}),V.Ic(19,"Upload File"),V.Ub(),V.Vb(20,"button",50),V.fc("click",function(){return e.$implicit.close("Close click")}),V.Ic(21,"Close"),V.Ub(),V.Ub()}if(2&t){const t=V.ic();V.Cb(13),V.oc("href",t.excelDownloadUrl,V.Cc)}}let Eo=(()=>{class t{constructor(t,e,i,o,n,c,a,r){this.service=t,this.router=e,this.alertify=i,this.todolistService=o,this.accountGroupService=n,this.modalService=c,this.datePipe=a,this.performanceService=r,this.toolbarOptions=["Search"],this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.KPI=se.KPI,this.Attitude=se.Attitude,this.index=1,this.subscription=[],this.sheetName="Upload Details",this.isAuthorize=!1}ngOnDestroy(){}onChangeReportTime(t){this.loadData()}ngOnInit(){this.currentTime=new Date,this.content="",this.loadAccountGroupData(),this.subscription.push(this.todolistService.currentMessage.subscribe(t=>{t&&this.loadData()}))}isAllowAccess(t){return(JSON.parse(localStorage.getItem("user")).accountGroupPositions||[]).includes(t)}loadData(){var t,e;this.currentTimeRequest=this.datePipe.transform(this.currentTime,"YYYY-MM-dd HH:mm");let i=0;switch(""===this.content?(this.content=null===(t=this.accountGroupData[0])||void 0===t?void 0:t.name,i=ce[null===(e=this.accountGroupData[0])||void 0===e?void 0:e.name]||0):i=ce[this.content]||0,i){case ce.L0:this.scoreType=re.L0,this.loadDataL0();break;case ce.L1:this.scoreType=re.L1,this.loadDataL1();break;case ce.FunctionalLeader:this.scoreType=re.FunctionalLeader,this.loadDataFunctionalLeader();break;case ce.L2:this.scoreType=re.L2,this.loadDataL2();break;case ce.Updater:this.scoreType=re.FHO,this.loadDataUpdater();break;case ce.GHR:this.scoreType=re.GHR,this.loadDataGHR();break;case ce.GM:this.loadDataGM(),this.scoreType=re.GM}}selected(t){var e,i;this.currentTimeRequest=this.datePipe.transform(this.currentTime,"YYYY-MM-dd HH:mm"),this.index=t.selectedIndex+1;let o=0;switch(this.content=t.selectedItem.outerText,""===this.content?(this.content=null===(e=this.accountGroupData[0])||void 0===e?void 0:e.name,o=ce[null===(i=this.accountGroupData[0])||void 0===i?void 0:i.name]||0):o=ce[t.selectedItem.outerText],o){case ce.L0:this.scoreType=re.L0,this.loadDataL0();break;case ce.L1:this.scoreType=re.L1,this.loadDataL1();break;case ce.GFL:this.scoreType=re.FunctionalLeader,this.loadDataFunctionalLeader();break;case ce.L2:this.scoreType=re.L2,this.loadDataL2();break;case ce.Updater:this.scoreType=re.FHO,this.loadDataUpdater();break;case ce.GHR:this.scoreType=re.GHR,this.loadDataGHR();break;case ce.GM:this.loadDataGM(),this.scoreType=re.GM}}getGridTemplate(t){const e=this.Gridtemplates.find(e=>e.name===t+"");return e?e.template:null}loadDataL0(){this.gridData=[],this.todolistService.l0(this.currentTimeRequest).subscribe(t=>{this.gridData=t})}loadDataL1(){this.gridData=[],this.todolistService.l1(this.currentTimeRequest).subscribe(t=>{this.gridData=t})}loadDataUpdater(){this.gridData=[],this.todolistService.updater(this.currentTimeRequest).subscribe(t=>{this.gridData=t})}loadDataFunctionalLeader(){this.gridData=[],this.todolistService.functionalLeader(this.currentTimeRequest).subscribe(t=>{this.gridData=t})}loadDataL2(){this.gridData=[],this.todolistService.l2(this.currentTimeRequest).subscribe(t=>{this.gridData=t})}loadDataFHO(){this.gridData=[],this.todolistService.fho(this.currentTimeRequest).subscribe(t=>{this.gridData=t})}loadDataGHR(){this.gridData=[],this.todolistService.ghr(this.currentTimeRequest).subscribe(t=>{this.gridData=t})}loadDataGM(){this.gridData=[],this.todolistService.gm(this.currentTimeRequest).subscribe(t=>{this.gridData=t})}loadAccountGroupData(){this.accountGroupService.getAccountGroupForTodolistByAccountId().subscribe(t=>{this.accountGroupData=t,this.loadData()})}gotoUpdate(){return this.router.navigateByUrl("/transaction/upload-kpi-objective")}openActionModalComponent(t){const e=this.modalService.open(Me,{size:"xl",backdrop:"static"});e.componentInstance.data=t,e.componentInstance.isReject=t.isReject,e.result.then(t=>{},t=>{})}openUpdateResultModalComponent(t){const e=this.modalService.open(_e,{size:"xl",backdrop:"static"});e.componentInstance.data=t,e.componentInstance.currentTime=this.currentTime,e.componentInstance.isReject=t.isReject,e.result.then(t=>{},t=>{})}openSelfScoreModalComponent(t){const e=this.modalService.open(je,{size:"xl",backdrop:"static"});e.componentInstance.data=t,e.componentInstance.periodTypeCode=le.Monthly,e.componentInstance.scoreType=this.scoreType,e.result.then(t=>{},t=>{})}openKPIScoreModalComponent(t){const e=this.modalService.open(Te,{size:"xl",backdrop:"static"});e.componentInstance.data=t,e.componentInstance.periodTypeCode=le.Quarterly,e.componentInstance.scoreType=this.scoreType,e.componentInstance.currentTime=this.currentTime,e.result.then(t=>{},t=>{})}openKPIScoreL2ModalComponent(t){const e=this.modalService.open(Bi,{size:"xl",backdrop:"static"});e.componentInstance.data=t,e.componentInstance.periodTypeCode=le.Quarterly,e.componentInstance.scoreType=this.scoreType,e.componentInstance.currentTime=this.currentTime,e.result.then(t=>{},t=>{})}openKPIScoreGHRModalComponent(t){const e=this.modalService.open(xi,{size:"xl",backdrop:"static"});e.componentInstance.data=t,e.componentInstance.periodTypeCode=le.Quarterly,e.componentInstance.scoreType=this.scoreType,e.componentInstance.currentTime=this.currentTime,e.result.then(t=>{},t=>{})}openKPIScoreGMModalComponent(t){const e=this.modalService.open(Ii,{size:"xl",backdrop:"static"});e.componentInstance.data=t,e.componentInstance.periodTypeCode=le.Quarterly,e.componentInstance.scoreType=this.scoreType,e.componentInstance.currentTime=this.currentTime,e.result.then(t=>{},t=>{})}openAttitudeScoreModalComponent(t){const e=this.modalService.open(Ze,{size:"xl",backdrop:"static"});e.componentInstance.data=t,e.componentInstance.scoreType=this.scoreType,e.result.then(t=>{},t=>{})}openAttitudeScoreL2ModalComponent(t){const e=this.modalService.open(si,{size:"xl",backdrop:"static"});e.componentInstance.data=t,e.componentInstance.scoreType=this.scoreType,e.result.then(t=>{},t=>{})}openAttitudeScoreGHRModalComponent(t){const e=this.modalService.open(pi,{size:"xl",backdrop:"static"});e.componentInstance.data=t,e.componentInstance.scoreType=this.scoreType,e.result.then(t=>{},t=>{})}openAttitudeScoreFunctionalLeaderModalComponent(t){const e=this.modalService.open(Pi,{size:"xl",backdrop:"static"});e.componentInstance.data=t,e.componentInstance.scoreType=this.scoreType,e.result.then(t=>{},t=>{})}openImportExcelModalComponent(){this.excelDownloadUrl=`${C.a.apiUrl}todolist/ExcelExport`,this.modalReference=this.modalService.open(this.importModal,{size:"xl"})}fileProgress(t){this.file=t.target.files[0]}uploadFile(){const t=JSON.parse(localStorage.getItem("user")).id;this.todolistService.import(this.file,t).subscribe(t=>{this.loadDataFHO(),this.alertify.success("The excel has been imported into system!"),this.modalService.dismissAll()},t=>{this.alertify.error(t,!0)})}NO(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}return t.\u0275fac=function(e){return new(e||t)(V.Pb(Ht),V.Pb(L.c),V.Pb(f.a),V.Pb(ue),V.Pb(v.a),V.Pb(k.b),V.Pb(n.e),V.Pb(ne))},t.\u0275cmp=V.Jb({type:t,selectors:[["app-todolist"]],viewQuery:function(t,e){if(1&t&&(V.Mc(Ki,1),V.Mc(Hi,1),V.Mc(Ji,1),V.Mc(_i,1)),2&t){let t;V.wc(t=V.gc())&&(e.grid=t.first),V.wc(t=V.gc())&&(e.importModal=t.first),V.wc(t=V.gc())&&(e.spreadsheetObj=t.first),V.wc(t=V.gc())&&(e.Gridtemplates=t)}},features:[V.Bb([n.e])],decls:27,vars:2,consts:[[1,"row"],[1,"col-md-3","d-flex","justify-content-center"],[1,"form-group"],["for","exampleInputEmail1"],[2,"width","100%",3,"ngModel","ngModelChange","valueChange"],[1,"card"],[1,"card-body"],["id","element",3,"selected"],[4,"ngFor","ngForOf"],["name","1"],["GridtemplateRef",""],["name","2"],["name","3"],["name","4"],["name","5"],["name","6"],["importModal",""],[3,"content"],["headerText",""],[4,"ngIf"],["gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","toolbar","pageSettings","allowExcelExport"],["grid",""],["field","#","headerText","#","textAlign","Center","width","80","type","number"],["template",""],["field","topic","headerText","KPI Objective","type","string"],["field","option","headerText","Option"],["class","badge badge-danger",4,"ngIf"],["class","badge badge-success",4,"ngIf"],[1,"badge","badge-danger"],[1,"badge","badge-success"],[1,"btn-group"],["type","button","class","btn btn-sm btn-success mr-2",3,"click",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-success","mr-2",3,"click"],[2,"text-align","center","color","red","font-size","xx-large"],["field","objective","headerText","KPI Objective","type","string"],["field","title","headerText","KPI Objective","type","string"],["field","objective","headerText","Objective","type","string"],["type","button",1,"btn","btn-sm","btn-secondary","mr-2",3,"click"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-6"],["for","Name"],[3,"href"],["name","file","type","file",1,"form-control",3,"change"],[1,"modal-footer"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(t,e){1&t&&(V.Vb(0,"div",0),V.Vb(1,"div",1),V.Vb(2,"div",2),V.Vb(3,"label",3),V.Ic(4,"Change System Date"),V.Ub(),V.Vb(5,"kendo-datepicker",4),V.fc("ngModelChange",function(t){return e.currentTime=t})("valueChange",function(t){return e.onChangeReportTime(t)}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(6,"div",5),V.Vb(7,"div",6),V.Vb(8,"ejs-tab",7),V.fc("selected",function(t){return e.selected(t)}),V.Vb(9,"e-tabitems"),V.Gc(10,Qi,4,1,"ng-container",8),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Gc(11,co,2,2,"ng-template",9,10,V.Hc),V.Gc(13,ho,2,2,"ng-template",11,10,V.Hc),V.Gc(15,Io,2,2,"ng-template",12,10,V.Hc),V.Gc(17,Co,11,7,"ng-template",13,10,V.Hc),V.Gc(19,Ao,2,2,"ng-template",14,10,V.Hc),V.Gc(21,Go,2,2,"ng-template",15,10,V.Hc),V.Gc(23,$o,10,7,"ng-template",null,10,V.Hc),V.Gc(25,Fo,22,1,"ng-template",null,16,V.Hc)),2&t&&(V.Cb(5),V.oc("ngModel",e.currentTime),V.Cb(5),V.oc("ngForOf",e.accountGroupData))},directives:[r.b,c.f,c.i,Ni.a,Ni.c,n.l,_i,Ni.b,n.m,d.g,d.d,d.b,G.d,G.b,j.d,d.c,d.a,G.c,G.a,j.c],styles:[""]}),t})();var Bo=i("mrSG");const _o=["remoteDataBinding"],No=function(){return{fontWeight:"bold",textAlign:"center",backgroundColor:"#4b5366",color:"#ffffff",fontSize:"12pt"}},Ko=function(){return{textAlign:"center"}};let Ho=(()=>{class t{constructor(t,e,i){this.service=t,this.datePipe=e,this.alertify=i}ngOnInit(){this.loadData()}loadData(){this.service.getKPIObjectivesByUpdater().subscribe(t=>{this.data=t.data.map(t=>({objectiveName:t.objectiveName,percentage:t.percentage,createdTime:"0001-01-01T00:00:00"===t.createdTime?"":this.datePipe.transform(t.createdTime,"yyyy-MM-dd HH:mm:ss")})),this.originalData=t.data})}contextMenuBeforeOpen(t){console.log(t),t.element.id===this.spreadsheetObj.element.id+"_contextmenu"&&(this.spreadsheetObj.removeContextMenuItems(["Paste"],!1),this.spreadsheetObj.removeContextMenuItems(["Paste Special"],!1),this.spreadsheetObj.removeContextMenuItems(["Cut"],!1),this.spreadsheetObj.removeContextMenuItems(["Copy"],!1))}submit(){return Object(Bo.a)(this,void 0,void 0,function*(){const t=[];for(var e=0;e<this.originalData.length;e++){console.log(this.spreadsheetObj.getRowData(e+1,0));const i=this.spreadsheetObj.getRowData(e+1,0),o=i[0].objectiveName,n=i[0].percentage,c=this.originalData.filter(t=>t.objectiveName==o)[0];c.percentage=n,t.push(c)}console.log(t),0!==t.length?this.service.submit(t).subscribe(t=>{console.log(t),t.success?(this.alertify.success(y.a.CREATED_OK_MSG),this.loadData()):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)},()=>this.alertify.warning(y.a.SYSTEM_ERROR_MSG)):this.alertify.warning("Not yet complete. Can not submit! \u5c1a\u672a\u5b8c\u6210\uff0c\u7121\u6cd5\u63d0\u4ea4",!0)})}}return t.\u0275fac=function(e){return new(e||t)(V.Pb(ne),V.Pb(n.e),V.Pb(f.a))},t.\u0275cmp=V.Jb({type:t,selectors:[["app-upload-kpi"]],viewQuery:function(t,e){if(1&t&&V.Mc(_o,1),2&t){let t;V.wc(t=V.gc())&&(e.spreadsheetObj=t.first)}},features:[V.Bb([n.e])],decls:22,vars:24,consts:[[1,"row"],[1,"col-md-12","d-flex","justify-content-between","my-2"],["type","button","routerLink","/transaction/todolist",1,"btn","btn-success",2,"cursor","pointer"],["type","button",1,"btn","btn-secondary",2,"cursor","pointer",3,"click"],[3,"height","showRibbon","showSheetTabs","contextMenuBeforeOpen"],["remoteDataBinding",""],[3,"name"],["startCell","A2",3,"showFieldAsHeader","dataSource"],["value","KPI Objective \u4e00\u968eKPI"],["value","Monthly Performance","format","@"],["value","Upload date / time"],[3,"width"],["format","@",3,"width"]],template:function(t,e){1&t&&(V.Vb(0,"div",0),V.Vb(1,"div",1),V.Vb(2,"button",2),V.Ic(3,"Back"),V.Ub(),V.Vb(4,"button",3),V.fc("click",function(){return e.submit()}),V.Ic(5,"Submit"),V.Ub(),V.Ub(),V.Ub(),V.Vb(6,"ejs-spreadsheet",4,5),V.fc("contextMenuBeforeOpen",function(t){return e.contextMenuBeforeOpen(t)}),V.Vb(8,"e-sheets"),V.Vb(9,"e-sheet",6),V.Vb(10,"e-ranges"),V.Qb(11,"e-range",7),V.Ub(),V.Vb(12,"e-rows"),V.Vb(13,"e-row"),V.Vb(14,"e-cells"),V.Qb(15,"e-cell",8),V.Qb(16,"e-cell",9),V.Qb(17,"e-cell",10),V.Ub(),V.Ub(),V.Ub(),V.Vb(18,"e-columns"),V.Qb(19,"e-column",11),V.Qb(20,"e-column",12),V.Qb(21,"e-column",11),V.Ub(),V.Ub(),V.Ub(),V.Ub()),2&t&&(V.Cb(6),V.oc("height",500)("showRibbon",!1)("showSheetTabs",!1),V.Cb(3),V.oc("name","Upload Details"),V.Cb(2),V.oc("showFieldAsHeader",!1)("dataSource",e.data),V.Cb(4),V.Ec(V.rc(19,No)),V.Cb(1),V.Ec(V.rc(20,No)),V.Cb(1),V.Ec(V.rc(21,No)),V.Cb(2),V.oc("width",200),V.Cb(1),V.Ec(V.rc(22,Ko)),V.oc("width",150),V.Cb(1),V.Ec(V.rc(23,Ko)),V.oc("width",200))},directives:[L.d,j.l,j.j,j.i,j.f,j.e,j.h,j.g,j.b,j.a,d.d,d.b,G.d,G.b,j.d,d.c,d.a,G.c,G.a,j.c],styles:[""]}),t})();var Jo=i("Uc7L");const zo=["defaultupload"];let Qo=(()=>{class t{constructor(t,e){this.activeModal=t,this.service=e,this.base=C.a.apiUrl,this.allowExtensions=".doc, .docx, .xls, .xlsx, .pdf",this.files=[],this.dropElement=document.getElementsByClassName("control_wrapper")[0],this.path={saveUrl:""}}ngOnInit(){this.loadData(),this.path={saveUrl:`${this.base}UploadFile/Save?kpiId=${this.data.id}&uploadTime=${this.currentTime.toLocaleDateString()}`,removeUrl:`${this.base}UploadFile/remove?kpiId=${this.data.id}&uploadTime=${this.currentTime.toLocaleDateString()}`},this.dropElement=document.getElementsByClassName("control_wrapper")[0],console.log(this.dropElement)}onFileRemove(t){t.postRawFile=!1}success(t){this.service.changeUploadMessage(!0)}loadData(){this.files=[],this.service.getAttackFiles(this.data.id,this.currentTime.toLocaleDateString()).subscribe(t=>{this.files=t||[]})}beforeUpload(t){console.log(t),t.statusText=t.response.statusText}onSelected(t){t.filesData.splice(5);let e=this.uploadObj.getFilesData().concat(t.filesData);if(e.length>5){for(let t=0;t<e.length;t++)e.length>5&&e.shift();t.filesData=e,t.modifiedFilesData=t.filesData}t.isModified=!0,console.log(t)}}return t.\u0275fac=function(e){return new(e||t)(V.Pb(k.a),V.Pb(O))},t.\u0275cmp=V.Jb({type:t,selectors:[["app-upload-file"]],viewQuery:function(t,e){if(1&t&&V.Mc(zo,1),2&t){let t;V.wc(t=V.gc())&&(e.uploadObj=t.first)}},inputs:{data:"data",currentTime:"currentTime"},decls:15,vars:5,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body","p-0"],[1,"row"],[1,"col-12"],[1,"control_wrapper"],["id","defaultfileupload",3,"allowedExtensions","files","asyncSettings","dropArea","selected","failure","success","removing"],["defaultupload",""],[1,"modal-footer","d-flex","justify-content-end"],["type","button",1,"btn","btn-secondary","mr-2",3,"click"]],template:function(t,e){1&t&&(V.Vb(0,"div",0),V.Vb(1,"h4",1),V.Ic(2,"Upload multiple file "),V.Ub(),V.Vb(3,"button",2),V.fc("click",function(){return e.activeModal.dismiss("Cross click")}),V.Vb(4,"span",3),V.Ic(5,"\xd7"),V.Ub(),V.Ub(),V.Ub(),V.Vb(6,"div",4),V.Vb(7,"div",5),V.Vb(8,"div",6),V.Vb(9,"div",7),V.Vb(10,"ejs-uploader",8,9),V.fc("selected",function(t){return e.onSelected(t)})("failure",function(t){return e.beforeUpload(t)})("success",function(t){return e.success(t)})("removing",function(t){return e.onFileRemove(t)}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(12,"div",10),V.Vb(13,"button",11),V.fc("click",function(){return e.activeModal.close("Close click")}),V.Ic(14),V.Ub(),V.Ub()),2&t&&(V.Cb(10),V.oc("allowedExtensions",e.allowExtensions)("files",e.files)("asyncSettings",e.path)("dropArea",e.dropElement),V.Cb(4),V.Jc("Close"))},directives:[Jo.a],styles:[""]}),t})();const Yo=["grid"];function qo(t,e){1&t&&(V.Vb(0,"div",41),V.Vb(1,"span",42),V.Ic(2,"%"),V.Ub(),V.Ub())}function Wo(t,e){1&t&&(V.Vb(0,"div",41),V.Vb(1,"span",42),V.Ic(2,"%"),V.Ub(),V.Ub())}function Xo(t,e){1&t&&(V.Vb(0,"div",41),V.Vb(1,"span",42),V.Ic(2,"%"),V.Ub(),V.Ub())}function Zo(t,e){1&t&&(V.Vb(0,"div",41),V.Vb(1,"span",42),V.Ic(2,"%"),V.Ub(),V.Ub())}function tn(t,e){1&t&&(V.Vb(0,"div",41),V.Vb(1,"span",42),V.Ic(2,"%"),V.Ub(),V.Ub())}function en(t,e){if(1&t&&(V.Vb(0,"li",43),V.Vb(1,"a",44),V.Ic(2),V.Ub(),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.oc("id",t.path)("href",t.path,V.Cc),V.Cb(1),V.Jc(t.name)}}function on(t,e){if(1&t&&(V.Vb(0,"li",43),V.Vb(1,"a",44),V.Ic(2),V.Ub(),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.oc("id",t.path)("href",t.path,V.Cc),V.Cb(1),V.Jc(t.name)}}function nn(t,e){if(1&t&&(V.Vb(0,"ul",45),V.Gc(1,on,3,3,"li",19),V.Ub()),2&t){const t=V.ic();V.Cb(1),V.oc("ngForOf",t.filesRight)}}function cn(t,e){if(1&t&&(V.Vb(0,"th",52),V.Ic(1),V.Ub()),2&t){const t=V.ic(2);V.Db("rowspan",t.gridData.length),V.Cb(1),V.Jc(t.month)}}function an(t,e){if(1&t&&(V.Vb(0,"option",49),V.Ic(1),V.Ub()),2&t){const t=e.$implicit;V.oc("value",t.id),V.Cb(1),V.Jc(t.name)}}function rn(t,e){if(1&t){const t=V.Wb();V.Tb(0),V.Vb(1,"tr"),V.Gc(2,cn,2,2,"th",46),V.Vb(3,"th",10),V.Ic(4),V.Ub(),V.Vb(5,"td"),V.Ic(6),V.Ub(),V.Vb(7,"td"),V.Ic(8),V.Ub(),V.Vb(9,"td"),V.Ic(10),V.Ub(),V.Vb(11,"td"),V.Vb(12,"textarea",47),V.fc("ngModelChange",function(i){V.Ac(t);const o=e.index;return V.ic().onChangeContent(i,o)})("ngModelChange",function(t){return e.$implicit.doContent=t}),V.Ub(),V.Ub(),V.Vb(13,"td"),V.Vb(14,"textarea",47),V.fc("ngModelChange",function(i){V.Ac(t);const o=e.index;return V.ic().onChangeArchivement(i,o)})("ngModelChange",function(t){return e.$implicit.achievement=t}),V.Ub(),V.Ub(),V.Vb(15,"td"),V.Vb(16,"select",48),V.fc("ngModelChange",function(t){return e.$implicit.statusId=t})("ngModelChange",function(i){V.Ac(t);const o=e.index,n=e.$implicit;return V.ic().onChangeStatus(i,o,n)}),V.Vb(17,"option",49),V.Ic(18,"Chose status"),V.Ub(),V.Gc(19,an,2,2,"option",50),V.Ub(),V.Ub(),V.Vb(20,"td"),V.Vb(21,"textarea",51),V.fc("ngModelChange",function(t){return e.$implicit.resultContent=t})("ngModelChange",function(i){V.Ac(t);const o=e.index;return V.ic().onChangeResult(i,o)}),V.Ub(),V.Ub(),V.Ub(),V.Sb()}if(2&t){const t=e.$implicit,i=e.index,o=V.ic();V.Cb(2),V.oc("ngIf",0==i),V.Cb(2),V.Jc(i+1),V.Cb(2),V.Jc(t.content),V.Cb(2),V.Jc(t.target),V.Cb(2),V.Jc(t.deadline),V.Cb(2),V.oc("ngModel",t.doContent),V.Cb(2),V.oc("ngModel",t.achievement),V.Cb(2),V.oc("ngModel",t.statusId),V.Cb(1),V.oc("value",null),V.Cb(2),V.oc("ngForOf",o.status),V.Cb(2),V.oc("ngModel",t.resultContent)}}function sn(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic();V.Kc(" ",i.NO(t.index)," ")}}let ln=(()=>{class t{constructor(t,e,i,o,n){this.activeModal=t,this.todolist2Service=e,this.datePipe=i,this.alertify=o,this.modalService=n,this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.toolbarOptions=["Add","Delete","Search"],this.policy="\u6548\u7387\u7cbe\u9032",this.kpi="SHC CTB IE \u5de5\u6642\u9054\u6210\u7387",this.pic="\u751f\u7522\u4e2d\u5fc3 Lai He",this.gridData=[],this.months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.month="",this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.actions=[],this.subscription=[],this.base=C.a.apiUrl.replace("/api/",""),this.allowExtensions=".doc, .docx, .xls, .xlsx, .pdf",this.files=[],this.filesLeft=[],this.filesRight=[]}ngOnDestroy(){this.subscription.forEach(t=>t.unsubscribe())}ngAfterViewInit(){$(function(){$('[data-toggle="tooltip"]').tooltip()})}ngOnInit(){this.subscription.push(this.todolist2Service.currentUploadMessage.subscribe(t=>{t&&this.getDownloadFiles()}));const t=this.currentTime.getMonth();this.month=this.months[1==t?12:t-1],this.getDownloadFiles(),this.loadStatusData(),this.loadData()}openUploadModalComponent(){const t=this.modalService.open(Qo,{size:"md",backdrop:"static",keyboard:!1});t.componentInstance.data=this.data,t.componentInstance.currentTime=this.currentTime,t.result.then(t=>{},t=>{})}NO(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}onChangeThisMonthPerformance(t){null!=this.thisMonthPerformance?this.thisMonthPerformance.performance=+t:this.thisMonthPerformance={id:0,value:0,performance:+t,kPIId:this.data.id,targetTime:(new Date).toISOString(),createdTime:(new Date).toISOString(),modifiedTime:null,yTD:0,createdBy:+JSON.parse(localStorage.getItem("user")).id}}onChangeThisMonthTarget(t){null!=this.thisMonthTarget?this.thisMonthTarget.value=+t:this.thisMonthTarget={id:0,value:+t,performance:0,kPIId:this.data.id,targetTime:(new Date).toISOString(),createdTime:(new Date).toISOString(),modifiedTime:null,yTD:0,createdBy:+JSON.parse(localStorage.getItem("user")).id}}onChangeNextMonthTarget(t){null!=this.nextMonthTarget?this.nextMonthTarget.value=+t:this.nextMonthTarget={id:0,value:+t,performance:0,kPIId:this.data.id,targetTime:(new Date).toISOString(),createdTime:(new Date).toISOString(),modifiedTime:null,yTD:0,createdBy:+JSON.parse(localStorage.getItem("user")).id,submitted:!1}}onChangeThisMonthYTD(t){null!=this.thisMonthYTD?this.thisMonthYTD.yTD=+t:this.thisMonthYTD={id:0,value:this.thisMonthTargetValue,performance:this.performanceValue,kPIId:this.data.id,targetTime:(new Date).toISOString(),createdTime:(new Date).toISOString(),modifiedTime:null,yTD:+t,createdBy:+JSON.parse(localStorage.getItem("user")).id}}download(){this.todolist2Service.download(this.data.id,this.currentTime.toLocaleDateString()).subscribe(t=>{new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});const e=window.URL.createObjectURL(t),i=document.createElement("a");i.href=e;const o=new Date;i.download=`${o.getFullYear()}${o.getMonth()}${o.getDay()}_archive.zip`,i.click()})}onChangeTargetYTD(t){null!=this.targetYTD?this.targetYTD.value=+t:this.targetYTD={id:0,value:+t,createdTime:(new Date).toISOString(),modifiedBy:null,modifiedTime:null,createdBy:+JSON.parse(localStorage.getItem("user")).id,kPIId:this.data.id}}onChangeContent(t,e){this.gridData[e].doContent=t}onChangeArchivement(t,e){this.gridData[e].achievement=t}onChangeStatus(t,e,i){this.addOrUpdateStatus(i,i=>{this.gridData[e].statusId=JSON.parse(t),this.gridData[e].actionStatusId=i.data.id})}onChangeResult(t,e){this.gridData[e].resultContent=t}loadData(){this.loadKPIData(),this.loadTargetData(),this.loadPDCAAndResultData(),this.loadActionData()}loadPDCAAndResultData(){this.gridData=[];const t=this.currentTime.toLocaleDateString();this.todolist2Service.getPDCAForL0(this.data.id||0,t).subscribe(t=>{var e;console.log(t),this.gridData=t.data,this.result=t.result,this.content=null===(e=this.result)||void 0===e?void 0:e.content})}loadActionData(){this.actions=[];const t=this.currentTime.toLocaleDateString();this.todolist2Service.getActionsForUpdatePDCA(this.data.id||0,t).subscribe(t=>{this.actions=t.actions||[]})}loadKPIData(){const t=this.currentTime.toLocaleDateString();this.todolist2Service.getKPIForUpdatePDC(this.data.id||0,t).subscribe(t=>{this.type=t.type,this.kpi=t.kpi,this.policy=t.policy,this.pic=t.pic})}loadTargetData(){const t=this.currentTime.toLocaleDateString();this.todolist2Service.getTargetForUpdatePDCA(this.data.id||0,t).subscribe(t=>{var e,i,o,n,c;this.thisMonthYTD=t.thisMonthYTD,this.thisMonthPerformance=t.thisMonthPerformance,this.thisMonthTarget=t.thisMonthTarget,this.targetYTD=t.targetYTD,this.nextMonthTarget=t.nextMonthTarget,this.performanceValue=null===(e=this.thisMonthPerformance)||void 0===e?void 0:e.performance,this.thisMonthTargetValue=null===(i=this.thisMonthTarget)||void 0===i?void 0:i.value,this.nextMonthTargetValue=null===(o=this.nextMonthTarget)||void 0===o?void 0:o.value,this.ytdValue=null===(n=this.targetYTD)||void 0===n?void 0:n.value,this.thisMonthYTDValue=null===(c=this.thisMonthYTD)||void 0===c?void 0:c.ytd})}loadStatusData(){this.status=[],this.todolist2Service.getStatus().subscribe(t=>{this.status=t||[]})}submit(){this.post(!0)}back(){this.post(!1)}validate(){if(!this.thisMonthTargetValue)return this.alertify.warning("Please input this month target"),!1;if(!this.performanceValue)return this.alertify.warning("Please input this month performance"),!1;if(!this.thisMonthYTDValue)return this.alertify.warning("Please input this month YTD"),!1;if(!this.nextMonthTargetValue)return this.alertify.warning("Please input next month target"),!1;let t=!0;for(const e of this.gridData)if(null==e.actionStatusId){t=!1;break}return!!t||(this.alertify.warning("Please add status"),!1)}post(t){if(0==this.validate())return;const e={id:this.thisMonthTarget.id,value:this.thisMonthTargetValue,performance:this.performanceValue,kPIId:this.data.id,targetTime:this.thisMonthYTD.targetTime,createdTime:this.thisMonthYTD.createdTime,modifiedTime:this.thisMonthYTD.modifiedTime,yTD:this.thisMonthYTDValue,createdBy:this.thisMonthYTD.createdBy,submitted:t},i=this.gridData,o=this.grid.dataSource.map(t=>({id:t.id,target:t.target,content:t.content,deadline:this.datePipe.transform(t.deadline,"MM/dd/yyyy"),accountId:+JSON.parse(localStorage.getItem("user")).id,kPIId:this.data.id,statusId:t.statusId,createdTime:(new Date).toISOString(),modifiedTime:null})),n={target:e,targetYTD:this.targetYTD,nextMonthTarget:this.nextMonthTarget,actions:o,updatePDCA:i,result:this.result,currentTime:this.datePipe.transform(this.currentTime,"MM/dd/yyyy")};this.todolist2Service.submitUpdatePDCA(n).subscribe(t=>{!0===t.success?(this.todolist2Service.changeMessage(!0),this.activeModal.close()):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)},t=>this.alertify.warning(y.a.SYSTEM_ERROR_MSG))}addOrUpdateStatus(t,e){const i={actionId:t.actionId,statusId:+t.statusId,actionStatusId:t.actionStatusId||0,currentTime:this.currentTime.toLocaleDateString()};this.todolist2Service.addOrUpdateStatus(i).subscribe(t=>{e(t)},t=>this.alertify.warning(y.a.SYSTEM_ERROR_MSG))}getDownloadFiles(){this.files=[],this.filesLeft=[],this.filesRight=[],this.todolist2Service.getDownloadFiles(this.data.id,this.currentTime.toLocaleDateString()).subscribe(t=>{this.files=(t||[]).map(t=>({name:t.name,path:this.base+t.path}));let e=0;for(const i of this.files)e++,e<=3?this.filesLeft.push(i):this.filesRight.push(i)})}}return t.\u0275fac=function(e){return new(e||t)(V.Pb(k.a),V.Pb(O),V.Pb(n.e),V.Pb(f.a),V.Pb(k.b))},t.\u0275cmp=V.Jb({type:t,selectors:[["app-pdca"]],viewQuery:function(t,e){if(1&t&&V.Mc(Yo,1),2&t){let t;V.wc(t=V.gc())&&(e.grid=t.first)}},inputs:{data:"data",currentTime:"currentTime"},features:[V.Bb([n.e])],decls:139,vars:60,consts:[[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"row","mb-3"],[1,"col-6"],[1,"font-weight-bold"],[1,"d-flex","align-items-start"],[1,"table","table-bordered",2,"width","300px","margin-right","50px"],["scope","row"],[1,"input-group",2,"width","100px"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["class","input-group-append",4,"ngIf"],["type","text",1,"form-control",2,"pointer-events","none",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-secondary","ml-2",3,"click"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"mt-3","d-flex","justify-content-start"],[1,"list-group","mr-3",2,"width","50%"],["class","list-group-item",4,"ngFor","ngForOf"],["class","list-group","style","width: 50%;",4,"ngIf"],[1,"row"],[1,"col-12"],[1,"table","table-bordered"],["scope","col","rowspan","2",1,"text-center","align-middle",2,"width","5%"],["scope","col",1,"text-center"],["scope","col",1,"text-center",2,"width","8%"],["scope","col",1,"text-center",2,"width","15%"],["scope","col",1,"text-center",2,"width","10%"],["scope","col",1,"text-center",2,"width","20%"],[4,"ngFor","ngForOf"],["gridLines","Both",3,"dataSource","allowPaging","allowResizing","editSettings","toolbar","pageSettings"],["grid",""],["field","#","headerText","#","textAlign","Center","headerTextAlign","Center","width","30","type","number",3,"allowEditing"],["template",""],["field","content","headerTextAlign","Center","type","string",3,"headerText"],["field","target","width","80","headerTextAlign","Center","type","string",3,"headerText"],["field","deadline","type","date","format","MM/dd/yyyy","editType","datepickeredit",3,"headerText"],[1,"modal-footer","d-flex","justify-content-end"],["type","button",1,"btn","btn-secondary","mr-2",3,"click"],["type","button",1,"btn","btn-success",3,"click"],[1,"input-group-append"],[1,"input-group-text"],[1,"list-group-item"],[3,"id","href"],[1,"list-group",2,"width","50%"],["scope","row","class","text-center align-middle",4,"ngIf"],["type","text","cols","30","rows","3",1,"form-control",3,"ngModel","ngModelChange"],[1,"custom-select",3,"ngModel","ngModelChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["cols","30","rows","10",1,"form-control",3,"ngModel","ngModelChange"],["scope","row",1,"text-center","align-middle"]],template:function(t,e){1&t&&(V.Vb(0,"div",0),V.Vb(1,"h4",1),V.Ic(2),V.Ub(),V.Vb(3,"button",2),V.fc("click",function(){return e.activeModal.dismiss("Cross click")}),V.Vb(4,"span",3),V.Ic(5,"\xd7"),V.Ub(),V.Ub(),V.Ub(),V.Vb(6,"div",4),V.Vb(7,"div",5),V.Vb(8,"div",6),V.Vb(9,"p"),V.Vb(10,"label",7),V.Ic(11),V.jc(12,"translate"),V.Ub(),V.Vb(13,"span"),V.Ic(14),V.Ub(),V.Ub(),V.Vb(15,"p"),V.Vb(16,"label",7),V.Ic(17),V.jc(18,"translate"),V.Ub(),V.Vb(19,"span"),V.Ic(20),V.Ub(),V.Ub(),V.Vb(21,"p"),V.Vb(22,"label",7),V.Ic(23,"PIC: "),V.Ub(),V.Vb(24,"span"),V.Ic(25),V.Ub(),V.Ub(),V.Vb(26,"div",8),V.Vb(27,"table",9),V.Vb(28,"tbody"),V.Vb(29,"tr"),V.Vb(30,"th",10),V.Ic(31),V.jc(32,"translate"),V.Ub(),V.Vb(33,"td"),V.Vb(34,"div",11),V.Vb(35,"input",12),V.fc("ngModelChange",function(t){return e.onChangeThisMonthPerformance(t)})("ngModelChange",function(t){return e.performanceValue=t}),V.Ub(),V.Gc(36,qo,3,0,"div",13),V.Ub(),V.Ub(),V.Ub(),V.Vb(37,"tr"),V.Vb(38,"th",10),V.Ic(39),V.jc(40,"translate"),V.Ub(),V.Vb(41,"td"),V.Vb(42,"div",11),V.Vb(43,"input",14),V.fc("ngModelChange",function(t){return e.onChangeThisMonthTarget(t)})("ngModelChange",function(t){return e.thisMonthTargetValue=t}),V.Ub(),V.Gc(44,Wo,3,0,"div",13),V.Ub(),V.Ub(),V.Ub(),V.Vb(45,"tr"),V.Vb(46,"th",10),V.Ic(47),V.jc(48,"translate"),V.Ub(),V.Vb(49,"td"),V.Vb(50,"div",11),V.Vb(51,"input",12),V.fc("ngModelChange",function(t){return e.onChangeNextMonthTarget(t)})("ngModelChange",function(t){return e.nextMonthTargetValue=t}),V.Ub(),V.Gc(52,Xo,3,0,"div",13),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(53,"table",9),V.Vb(54,"tbody"),V.Vb(55,"tr"),V.Vb(56,"th",10),V.Ic(57),V.jc(58,"translate"),V.Ub(),V.Vb(59,"td"),V.Vb(60,"div",11),V.Vb(61,"input",12),V.fc("ngModelChange",function(t){return e.onChangeThisMonthYTD(t)})("ngModelChange",function(t){return e.thisMonthYTDValue=t}),V.Ub(),V.Gc(62,Zo,3,0,"div",13),V.Ub(),V.Ub(),V.Ub(),V.Vb(63,"tr"),V.Vb(64,"th",10),V.Ic(65),V.jc(66,"translate"),V.Ub(),V.Vb(67,"td"),V.Vb(68,"div",11),V.Vb(69,"input",14),V.fc("ngModelChange",function(t){return e.onChangeTargetYTD(t)})("ngModelChange",function(t){return e.ytdValue=t}),V.Ub(),V.Gc(70,tn,3,0,"div",13),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(71,"div",6),V.Vb(72,"button",15),V.fc("click",function(){return e.download()}),V.Ic(73),V.Ub(),V.Vb(74,"button",16),V.fc("click",function(){return e.openUploadModalComponent()}),V.Ic(75),V.Ub(),V.Vb(76,"div",17),V.Vb(77,"ul",18),V.Gc(78,en,3,3,"li",19),V.Ub(),V.Gc(79,nn,2,1,"ul",20),V.Ub(),V.Ub(),V.Ub(),V.Vb(80,"div",21),V.Vb(81,"div",22),V.Vb(82,"table",23),V.Vb(83,"thead"),V.Vb(84,"tr"),V.Vb(85,"th",24),V.Ic(86,"\u6708\u4efd"),V.Ub(),V.Vb(87,"th",24),V.Ic(88,"#"),V.Ub(),V.Vb(89,"th",25),V.Ic(90,"P"),V.Ub(),V.Vb(91,"th",25),V.Ic(92,"Target"),V.Ub(),V.Vb(93,"th",26),V.Ic(94,"Deadline"),V.Ub(),V.Vb(95,"th",27),V.Ic(96,"D"),V.Ub(),V.Vb(97,"th",26),V.Ic(98,"Achievement"),V.Ub(),V.Vb(99,"th",28),V.Ic(100,"Status"),V.Ub(),V.Vb(101,"th",29),V.Ic(102,"C"),V.Ub(),V.Ub(),V.Vb(103,"tr"),V.Vb(104,"th",25),V.Ic(105,"\u6708\u4efd\u8a08\u5283"),V.Ub(),V.Vb(106,"th",25),V.Ic(107,"\u76ee\u6a19\u503c "),V.Ub(),V.Vb(108,"th",25),V.Ic(109,"\u5b8c\u6210\u671f\u9650"),V.Ub(),V.Vb(110,"th",25),V.Ic(111,"\u57f7\u884c\u72c0\u6cc1"),V.Ub(),V.Vb(112,"th",25),V.Ic(113,"\u5be6\u7e3e"),V.Ub(),V.Vb(114,"th",25),V.Ic(115,"\u72c0\u614b"),V.Ub(),V.Vb(116,"th",25),V.Ic(117,"\u57f7\u884c\u5206\u6790\u6aa2\u8a0e"),V.Ub(),V.Ub(),V.Ub(),V.Vb(118,"tbody"),V.Gc(119,rn,22,11,"ng-container",30),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(120,"div",21),V.Vb(121,"div",22),V.Vb(122,"ejs-grid",31,32),V.Vb(124,"e-columns"),V.Vb(125,"e-column",33),V.Gc(126,sn,1,1,"ng-template",null,34,V.Hc),V.Ub(),V.Qb(128,"e-column",35),V.jc(129,"translate"),V.Qb(130,"e-column",36),V.jc(131,"translate"),V.Qb(132,"e-column",37),V.jc(133,"translate"),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(134,"div",38),V.Vb(135,"button",39),V.fc("click",function(){return e.back()}),V.Ic(136),V.Ub(),V.Vb(137,"button",40),V.fc("click",function(){return e.submit()}),V.Ic(138),V.Ub(),V.Ub()),2&t&&(V.Cb(2),V.Kc("Monthly update PDCA (",e.month,") "),V.Cb(9),V.Kc("",V.kc(12,40,"Policy"),": "),V.Cb(3),V.Jc(e.policy),V.Cb(3),V.Kc("",V.kc(18,42,"KPI"),": "),V.Cb(3),V.Jc(e.kpi),V.Cb(5),V.Jc(e.pic),V.Cb(6),V.Kc("",V.kc(32,44,"This month Performance")," "),V.Cb(4),V.oc("ngModel",e.performanceValue),V.Cb(1),V.oc("ngIf",1===e.type),V.Cb(3),V.Kc("",V.kc(40,46,"This month Target")," "),V.Cb(4),V.oc("ngModel",e.thisMonthTargetValue),V.Cb(1),V.oc("ngIf",1===e.type),V.Cb(3),V.Kc("",V.kc(48,48,"Next month Target")," "),V.Cb(4),V.oc("ngModel",e.nextMonthTargetValue),V.Cb(1),V.oc("ngIf",1===e.type),V.Cb(5),V.Kc("",V.kc(58,50,"This month YTD")," "),V.Cb(4),V.oc("ngModel",e.thisMonthYTDValue),V.Cb(1),V.oc("ngIf",1===e.type),V.Cb(3),V.Kc("",V.kc(66,52,"Target YTD")," "),V.Cb(4),V.oc("ngModel",e.ytdValue),V.Cb(1),V.oc("ngIf",1===e.type),V.Cb(3),V.Jc("Download"),V.Cb(2),V.Jc("Upload file"),V.Cb(2),V.Fc("width",e.filesRight.length>0?"50%":"100%"),V.Cb(1),V.oc("ngForOf",e.filesLeft),V.Cb(1),V.oc("ngIf",e.filesRight.length>0),V.Cb(40),V.oc("ngForOf",e.gridData),V.Cb(3),V.oc("dataSource",e.actions)("allowPaging",!0)("allowResizing",!0)("editSettings",e.editSettings)("toolbar",e.toolbarOptions)("pageSettings",e.pageSettings),V.Cb(3),V.oc("allowEditing",!1),V.Cb(3),V.pc("headerText",V.kc(129,54,"Content2")),V.Cb(2),V.pc("headerText",V.kc(131,56,"Target")),V.Cb(2),V.pc("headerText",V.kc(133,58,"Deadline")),V.Cb(4),V.Kc("","Save","\n"),V.Cb(2),V.Jc("Submit"))},directives:[c.a,c.f,c.i,n.m,n.l,d.g,d.d,d.b,G.d,G.b,j.d,d.c,d.a,G.c,G.a,j.c,c.m,c.j,c.o],pipes:[a.c],styles:[""]}),t})();var dn=i("7g+E");const bn=["grid"];function un(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic();V.Kc(" ",i.NO(t.index)," ")}}let hn=(()=>{class t{constructor(t,e,i,o,n){this.activeModal=t,this.todolist2Service=e,this.alertify=i,this.datePipe=o,this.spinner=n,this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.toolbarOptions=["Add","Delete","Search"],this.policy="\u6548\u7387\u7cbe\u9032",this.kpi="SHC CTB IE \u5de5\u6642\u9054\u6210\u7387",this.pic="\u751f\u7522\u4e2d\u5fc3 Lai He",this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.actions=[],this.targetValue=null,this.targetYTDValue=null}ngAfterViewInit(){$(function(){$('[data-toggle="tooltip"]').tooltip()})}ngOnInit(){this.loadData()}onChangeTarget(t){null!=this.target?this.target.value=+t:this.target={id:0,value:+t,performance:0,kPIId:this.data.id,targetTime:(new Date).toISOString(),createdTime:(new Date).toISOString(),modifiedTime:null,yTD:0,createdBy:+JSON.parse(localStorage.getItem("user")).id,submitted:!0},console.log(this.target)}onChangeTargetYTD(t){null!=this.targetYTD?this.targetYTD.value=+t:this.targetYTD={id:0,value:+t,createdTime:(new Date).toISOString(),modifiedBy:null,modifiedTime:null,createdBy:+JSON.parse(localStorage.getItem("user")).id,kPIId:this.data.id},console.log(this.targetYTD)}submit(){if(0==this.validate(!0))return;this.spinner.show();const t={actions:this.grid.dataSource.map(t=>({id:t.id,target:t.target,content:t.content,deadline:"string"!=typeof t.deadline?t.deadline.toLocaleDateString():t.deadline,accountId:+JSON.parse(localStorage.getItem("user")).id,kPIId:this.data.id,statusId:t.statusId,createdTime:(new Date).toISOString(),modifiedTime:null})),target:this.target,targetYTD:this.targetYTD,currentTime:this.currentTime.toLocaleDateString()};console.log(t);const e=this.todolist2Service.submitAction(t),i=this.todolist2Service.submitKPINew(this.data.id);Object(fe.a)([e,i]).subscribe(t=>{console.log(t),t.map(t=>t.success),t=>t.every(Boolean)?(this.todolist2Service.changeMessage(!0),this.activeModal.close(),this.spinner.hide()):this.alertify.warning(y.a.SYSTEM_ERROR_MSG)})}back(){this.post(()=>{this.todolist2Service.changeMessage(!0),this.activeModal.close()},!1)}validate(t){return this.target?this.targetYTD?!t||0!=(this.grid.dataSource||[]).length||(this.alertify.warning("Please create actions"),!1):(this.alertify.warning("Please input target YTD"),!1):(this.alertify.warning("Please input next month target"),!1)}post(t,e=!0){if(0==this.validate(e))return;const i={actions:this.grid.dataSource.map(t=>({id:t.id,target:t.target,content:t.content,deadline:"string"!=typeof t.deadline?t.deadline.toLocaleDateString():t.deadline,accountId:+JSON.parse(localStorage.getItem("user")).id,kPIId:this.data.id,statusId:t.statusId,createdTime:(new Date).toISOString(),modifiedTime:null})),target:this.target,targetYTD:this.targetYTD,currentTime:this.currentTime.toLocaleDateString()};console.log(i),this.todolist2Service.submitAction(i).subscribe(e=>{!0===e.success?t():this.alertify.warning(y.a.SYSTEM_ERROR_MSG)},t=>this.alertify.warning(y.a.SYSTEM_ERROR_MSG))}submitKPINew(){this.todolist2Service.submitKPINew(this.data.id).subscribe(t=>{this.todolist2Service.changeMessage(!0),this.activeModal.close(),this.spinner.hide()},t=>{this.spinner.hide()})}loadData(){this.gridData=[],this.todolist2Service.getActionsForL0(this.data.id||0).subscribe(t=>{var e,i;this.actions=t.actions||[],this.pic=t.pic,this.policy=t.policy,this.kpi=t.kpi,this.target=t.target,this.targetYTD=t.targetYTD,this.targetValue=null===(e=this.target)||void 0===e?void 0:e.value,this.targetYTDValue=null===(i=this.targetYTD)||void 0===i?void 0:i.value})}NO(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}return t.\u0275fac=function(e){return new(e||t)(V.Pb(k.a),V.Pb(O),V.Pb(f.a),V.Pb(n.e),V.Pb(dn.c))},t.\u0275cmp=V.Jb({type:t,selectors:[["app-plan"]],viewQuery:function(t,e){if(1&t&&V.Mc(bn,1),2&t){let t;V.wc(t=V.gc())&&(e.grid=t.first)}},inputs:{data:"data",currentTime:"currentTime"},features:[V.Bb([n.e])],decls:61,vars:38,consts:[["type","square-jelly-box","size","medium",3,"fullScreen"],[1,"loading"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"row"],[1,"col-12"],[1,"font-weight-bold"],[1,"col-12","d-flex","align-items-start"],[1,"input-group","mb-3",2,"width","300px"],[1,"input-group-prepend"],["id","target",1,"input-group-text","font-weight-bold"],["type","text","id","next-month-target","aria-describedby","target",1,"form-control",3,"ngModel","ngModelChange"],[1,"input-group","mb-3","ml-5",2,"width","300px"],["id","ytd",1,"input-group-text","font-weight-bold"],["type","text","id","target-ytd","aria-describedby","ytd",1,"form-control",3,"ngModel","ngModelChange"],["allowTextWrap","true","gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","toolbar","pageSettings","editSettings","allowExcelExport"],["grid",""],["field","#","headerText","#","textAlign","Center","width","80","type","number",3,"allowEditing"],["template",""],["field","content","type","string",3,"headerText"],["field","target","type","string",3,"headerText"],["field","deadline","type","date","format","MM/dd/yyyy","editType","datepickeredit",3,"headerText"],[1,"modal-footer","d-flex","justify-content-end"],["type","button",1,"btn","btn-secondary","mr-2",3,"click"],["type","button",1,"btn","btn-success",3,"click"]],template:function(t,e){1&t&&(V.Vb(0,"ngx-spinner",0),V.Vb(1,"p",1),V.Ic(2,"Loading data..."),V.Ub(),V.Ub(),V.Vb(3,"div",2),V.Vb(4,"h4",3),V.Ic(5,"\u4e2d\u5fc3\u4e3b\u7ba1\u6536\u5230KPI\u9805\u76ee\u5f8c\u65b0\u589e\u7b2c\u4e00\u500bP (Center head update the first Plan of 2nd KPI) "),V.Ub(),V.Vb(6,"button",4),V.fc("click",function(){return e.activeModal.dismiss("Cross click")}),V.Vb(7,"span",5),V.Ic(8,"\xd7"),V.Ub(),V.Ub(),V.Ub(),V.Vb(9,"div",6),V.Vb(10,"div",7),V.Vb(11,"div",8),V.Vb(12,"p"),V.Vb(13,"label",9),V.Ic(14),V.jc(15,"translate"),V.Ub(),V.Vb(16,"span"),V.Ic(17),V.Ub(),V.Ub(),V.Vb(18,"p"),V.Vb(19,"label",9),V.Ic(20),V.jc(21,"translate"),V.Ub(),V.Vb(22,"span"),V.Ic(23),V.Ub(),V.Ub(),V.Vb(24,"p"),V.Vb(25,"label",9),V.Ic(26,"PIC: "),V.Ub(),V.Vb(27,"span"),V.Ic(28),V.Ub(),V.Ub(),V.Ub(),V.Vb(29,"div",10),V.Vb(30,"div",11),V.Vb(31,"div",12),V.Vb(32,"span",13),V.Ic(33),V.jc(34,"translate"),V.Ub(),V.Ub(),V.Vb(35,"input",14),V.fc("ngModelChange",function(t){return e.onChangeTarget(t)})("ngModelChange",function(t){return e.targetValue=t}),V.Ub(),V.Ub(),V.Vb(36,"div",15),V.Vb(37,"div",12),V.Vb(38,"span",16),V.Ic(39),V.jc(40,"translate"),V.Ub(),V.Ub(),V.Vb(41,"input",17),V.fc("ngModelChange",function(t){return e.onChangeTargetYTD(t)})("ngModelChange",function(t){return e.targetYTDValue=t}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(42,"div",7),V.Vb(43,"div",8),V.Vb(44,"ejs-grid",18,19),V.Vb(46,"e-columns"),V.Vb(47,"e-column",20),V.Gc(48,un,1,1,"ng-template",null,21,V.Hc),V.Ub(),V.Qb(50,"e-column",22),V.jc(51,"translate"),V.Qb(52,"e-column",23),V.jc(53,"translate"),V.Qb(54,"e-column",24),V.jc(55,"translate"),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(56,"div",25),V.Vb(57,"button",26),V.fc("click",function(){return e.back()}),V.Ic(58),V.Ub(),V.Vb(59,"button",27),V.fc("click",function(){return e.submit()}),V.Ic(60),V.Ub(),V.Ub()),2&t&&(V.oc("fullScreen",!1),V.Cb(14),V.Kc("",V.kc(15,24,"Policy"),": "),V.Cb(3),V.Jc(e.policy),V.Cb(3),V.Kc("",V.kc(21,26,"KPI"),": "),V.Cb(3),V.Jc(e.kpi),V.Cb(5),V.Jc(e.pic),V.Cb(5),V.Jc(V.kc(34,28,"Next month Target")),V.Cb(2),V.oc("ngModel",e.targetValue),V.Cb(4),V.Jc(V.kc(40,30,"Target YTD")),V.Cb(2),V.oc("ngModel",e.targetYTDValue),V.Cb(3),V.oc("dataSource",e.actions)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",e.toolbarOptions)("pageSettings",e.pageSettings)("editSettings",e.editSettings)("allowExcelExport",!0),V.Cb(3),V.oc("allowEditing",!1),V.Cb(3),V.pc("headerText",V.kc(51,32,"Content")),V.Cb(2),V.pc("headerText",V.kc(53,34,"Target")),V.Cb(2),V.pc("headerText",V.kc(55,36,"Deadline")),V.Cb(4),V.Kc("","Back","\n"),V.Cb(2),V.Jc("Submit"))},directives:[dn.a,c.a,c.f,c.i,d.g,d.d,d.b,G.d,G.b,j.d,d.c,d.a,G.c,G.a,j.c],pipes:[a.c],styles:[""]}),t})();const pn=["grid"],gn=["importModal"],fn=["remoteDataBinding"];function mn(t,e){if(1&t&&(V.Vb(0,"div"),V.Ic(1),V.Ub()),2&t){const t=V.ic().$implicit;V.Cb(1),V.Kc(" ",t.name," ")}}function yn(t,e){if(1&t&&(V.Tb(0),V.Vb(1,"e-tabitem",17),V.Gc(2,mn,2,1,"ng-template",null,18,V.Hc),V.Ub(),V.Sb()),2&t){const t=e.$implicit,i=V.ic();V.Cb(1),V.oc("content",i.getGridTemplate(t.position))}}function vn(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic(3);V.Kc(" ",i.NO(t.index)," ")}}function In(t,e){1&t&&(V.Vb(0,"span",28),V.Ic(1,"Rejected"),V.Ub())}function Sn(t,e){1&t&&(V.Vb(0,"span",29),V.Ic(1,"Done"),V.Ub())}function Un(t,e){if(1&t&&(V.Vb(0,"span"),V.Ic(1),V.Ub(),V.Gc(2,In,2,0,"span",26),V.Gc(3,Sn,2,0,"span",27)),2&t){const t=e.$implicit;V.Cb(1),V.Jc(t.topic),V.Cb(1),V.oc("ngIf",t.isReject&&t.isDisplayAction),V.Cb(1),V.oc("ngIf",t.isUpdatedResult)}}function Cn(t,e){if(1&t){const t=V.Wb();V.Vb(0,"button",32),V.fc("click",function(){V.Ac(t);const e=V.ic().$implicit;return V.ic(3).openActionModalComponent(e)}),V.Ic(1,"Action"),V.Ub()}}function Vn(t,e){if(1&t){const t=V.Wb();V.Vb(0,"button",32),V.fc("click",function(){V.Ac(t);const e=V.ic().$implicit;return V.ic(3).openUpdatePdcaModalComponent(e)}),V.Ic(1,"Update PDCA"),V.Ub()}}function Tn(t,e){if(1&t){const t=V.Wb();V.Vb(0,"button",32),V.fc("click",function(){V.Ac(t);const e=V.ic().$implicit;return V.ic(3).openSelfScoreModalComponent(e)}),V.Ic(1,"Self-score"),V.Ub()}}function xn(t,e){if(1&t&&(V.Vb(0,"div",30),V.Gc(1,Cn,2,0,"button",31),V.Gc(2,Vn,2,0,"button",31),V.Gc(3,Tn,2,0,"button",31),V.Ub()),2&t){const t=e.$implicit;V.Cb(1),V.oc("ngIf","Action"==t.type),V.Cb(1),V.oc("ngIf","UpdatePDCA"==t.type),V.Cb(1),V.oc("ngIf",t.isDisplaySelfScore)}}function wn(t,e){if(1&t&&(V.Vb(0,"div"),V.Vb(1,"ejs-grid",20,21),V.Vb(3,"e-columns"),V.Vb(4,"e-column",22),V.Gc(5,vn,1,1,"ng-template",null,23,V.Hc),V.Ub(),V.Vb(7,"e-column",24),V.Gc(8,Un,4,3,"ng-template",null,23,V.Hc),V.Ub(),V.Vb(10,"e-column",25),V.Gc(11,xn,4,3,"ng-template",null,23,V.Hc),V.Ub(),V.Ub(),V.Ub(),V.Ub()),2&t){const t=V.ic(2);V.Cb(1),V.oc("dataSource",t.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings)("allowExcelExport",!0)}}function Mn(t,e){1&t&&(V.Vb(0,"div"),V.Vb(1,"p",33),V.Ic(2," No authority to view. "),V.Ub(),V.Ub())}function Dn(t,e){if(1&t&&(V.Gc(0,wn,13,7,"div",19),V.Gc(1,Mn,3,0,"div",19)),2&t){const t=V.ic();V.oc("ngIf",t.isAllowAccess(1)),V.Cb(1),V.oc("ngIf",!t.isAllowAccess(1))}}function An(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic(3);V.Kc(" ",i.NO(t.index)," ")}}function On(t,e){if(1&t){const t=V.Wb();V.Vb(0,"button",32),V.fc("click",function(){V.Ac(t);const e=V.ic().$implicit;return V.ic(3).openKPIScoreModalComponent(e)}),V.Ic(1,"KPI Score"),V.Ub()}}function Pn(t,e){if(1&t){const t=V.Wb();V.Vb(0,"button",32),V.fc("click",function(){V.Ac(t);const e=V.ic().$implicit;return V.ic(3).openAttitudeScoreModalComponent(e)}),V.Ic(1,"Attitude Score"),V.Ub()}}function kn(t,e){if(1&t&&(V.Vb(0,"div",30),V.Gc(1,On,2,0,"button",31),V.Gc(2,Pn,2,0,"button",31),V.Ub()),2&t){const t=e.$implicit,i=V.ic(3);V.Cb(1),V.oc("ngIf",t.type==i.KPI),V.Cb(1),V.oc("ngIf",t.type==i.Attitude)}}function Ln(t,e){if(1&t&&(V.Vb(0,"div"),V.Vb(1,"ejs-grid",20,21),V.Vb(3,"e-columns"),V.Vb(4,"e-column",22),V.Gc(5,An,1,1,"ng-template",null,23,V.Hc),V.Ub(),V.Qb(7,"e-column",34),V.Vb(8,"e-column",25),V.Gc(9,kn,3,2,"ng-template",null,23,V.Hc),V.Ub(),V.Ub(),V.Ub(),V.Ub()),2&t){const t=V.ic(2);V.Cb(1),V.oc("dataSource",t.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings)("allowExcelExport",!0)}}function Gn(t,e){1&t&&(V.Vb(0,"div"),V.Vb(1,"p",33),V.Ic(2," No authority to view. "),V.Ub(),V.Ub())}function jn(t,e){if(1&t&&(V.Gc(0,Ln,11,7,"div",19),V.Gc(1,Gn,3,0,"div",19)),2&t){const t=V.ic();V.oc("ngIf",t.isAllowAccess(2)),V.Cb(1),V.oc("ngIf",!t.isAllowAccess(2))}}function Rn(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic(3);V.Kc(" ",i.NO(t.index)," ")}}function $n(t,e){if(1&t){const t=V.Wb();V.Vb(0,"button",32),V.fc("click",function(){V.Ac(t);const e=V.ic().$implicit;return V.ic(3).openKPIScoreL2ModalComponent(e)}),V.Ic(1,"KPI Score"),V.Ub()}}function Fn(t,e){if(1&t){const t=V.Wb();V.Vb(0,"button",32),V.fc("click",function(){V.Ac(t);const e=V.ic().$implicit;return V.ic(3).openAttitudeScoreL2ModalComponent(e)}),V.Ic(1,"Attitude Score"),V.Ub()}}function En(t,e){if(1&t&&(V.Vb(0,"div",30),V.Gc(1,$n,2,0,"button",31),V.Gc(2,Fn,2,0,"button",31),V.Ub()),2&t){const t=e.$implicit,i=V.ic(3);V.Cb(1),V.oc("ngIf",t.type==i.KPI),V.Cb(1),V.oc("ngIf",t.type==i.Attitude)}}function Bn(t,e){if(1&t&&(V.Vb(0,"div"),V.Vb(1,"ejs-grid",20,21),V.Vb(3,"e-columns"),V.Vb(4,"e-column",22),V.Gc(5,Rn,1,1,"ng-template",null,23,V.Hc),V.Ub(),V.Qb(7,"e-column",34),V.Vb(8,"e-column",25),V.Gc(9,En,3,2,"ng-template",null,23,V.Hc),V.Ub(),V.Ub(),V.Ub(),V.Ub()),2&t){const t=V.ic(2);V.Cb(1),V.oc("dataSource",t.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings)("allowExcelExport",!0)}}function _n(t,e){1&t&&(V.Vb(0,"div"),V.Vb(1,"p",33),V.Ic(2," No authority to view. "),V.Ub(),V.Ub())}function Nn(t,e){if(1&t&&(V.Gc(0,Bn,11,7,"div",19),V.Gc(1,_n,3,0,"div",19)),2&t){const t=V.ic();V.oc("ngIf",t.isAllowAccess(3)),V.Cb(1),V.oc("ngIf",!t.isAllowAccess(3))}}function Kn(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic(2);V.Kc(" ",i.NO(t.index)," ")}}function Hn(t,e){if(1&t){const t=V.Wb();V.Vb(0,"div",30),V.Vb(1,"button",32),V.fc("click",function(){return V.Ac(t),V.ic(2).gotoUpdate()}),V.Ic(2,"Update"),V.Ub(),V.Ub()}}function Jn(t,e){if(1&t&&(V.Vb(0,"div"),V.Vb(1,"ejs-grid",20,21),V.Vb(3,"e-columns"),V.Vb(4,"e-column",22),V.Gc(5,Kn,1,1,"ng-template",null,23,V.Hc),V.Ub(),V.Qb(7,"e-column",35),V.Vb(8,"e-column",25),V.Gc(9,Hn,3,0,"ng-template",null,23,V.Hc),V.Ub(),V.Ub(),V.Ub(),V.Ub()),2&t){const t=V.ic();V.Cb(1),V.oc("dataSource",t.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings)("allowExcelExport",!0)}}function zn(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic(3);V.Kc(" ",i.NO(t.index)," ")}}function Qn(t,e){if(1&t){const t=V.Wb();V.Vb(0,"button",32),V.fc("click",function(){V.Ac(t);const e=V.ic().$implicit;return V.ic(3).openKPIScoreGHRModalComponent(e)}),V.Ic(1,"SMART Score"),V.Ub()}}function Yn(t,e){if(1&t){const t=V.Wb();V.Vb(0,"button",32),V.fc("click",function(){V.Ac(t);const e=V.ic().$implicit;return V.ic(3).openAttitudeScoreGHRModalComponent(e)}),V.Ic(1,"Attitude Score"),V.Ub()}}function qn(t,e){if(1&t&&(V.Vb(0,"div",30),V.Gc(1,Qn,2,0,"button",31),V.Gc(2,Yn,2,0,"button",31),V.Ub()),2&t){const t=e.$implicit,i=V.ic(3);V.Cb(1),V.oc("ngIf",t.type==i.KPI),V.Cb(1),V.oc("ngIf",t.type==i.Attitude)}}function Wn(t,e){if(1&t&&(V.Vb(0,"div"),V.Vb(1,"ejs-grid",20,21),V.Vb(3,"e-columns"),V.Vb(4,"e-column",22),V.Gc(5,zn,1,1,"ng-template",null,23,V.Hc),V.Ub(),V.Qb(7,"e-column",34),V.Vb(8,"e-column",25),V.Gc(9,qn,3,2,"ng-template",null,23,V.Hc),V.Ub(),V.Ub(),V.Ub(),V.Ub()),2&t){const t=V.ic(2);V.Cb(1),V.oc("dataSource",t.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings)("allowExcelExport",!0)}}function Xn(t,e){1&t&&(V.Vb(0,"div"),V.Vb(1,"p",33),V.Ic(2," No authority to view. "),V.Ub(),V.Ub())}function Zn(t,e){if(1&t&&(V.Gc(0,Wn,11,7,"div",19),V.Gc(1,Xn,3,0,"div",19)),2&t){const t=V.ic();V.oc("ngIf",t.isAllowAccess(5)),V.Cb(1),V.oc("ngIf",!t.isAllowAccess(5))}}function tc(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic(3);V.Kc(" ",i.NO(t.index)," ")}}function ec(t,e){if(1&t){const t=V.Wb();V.Vb(0,"div",30),V.Vb(1,"button",37),V.fc("click",function(){V.Ac(t);const i=e.$implicit;return V.ic(3).openAttitudeScoreFunctionalLeaderModalComponent(i)}),V.Ic(2,"Attitude Score"),V.Ub(),V.Ub()}}function ic(t,e){if(1&t&&(V.Vb(0,"div"),V.Vb(1,"ejs-grid",20,21),V.Vb(3,"e-columns"),V.Vb(4,"e-column",22),V.Gc(5,tc,1,1,"ng-template",null,23,V.Hc),V.Ub(),V.Qb(7,"e-column",36),V.Vb(8,"e-column",25),V.Gc(9,ec,3,0,"ng-template",null,23,V.Hc),V.Ub(),V.Ub(),V.Ub(),V.Ub()),2&t){const t=V.ic(2);V.Cb(1),V.oc("dataSource",t.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings)("allowExcelExport",!0)}}function oc(t,e){1&t&&(V.Vb(0,"div"),V.Vb(1,"p",33),V.Ic(2," No authority to view. "),V.Ub(),V.Ub())}function nc(t,e){if(1&t&&(V.Gc(0,ic,11,7,"div",19),V.Gc(1,oc,3,0,"div",19)),2&t){const t=V.ic();V.oc("ngIf",t.isAllowAccess(6)),V.Cb(1),V.oc("ngIf",!t.isAllowAccess(6))}}function cc(t,e){if(1&t&&V.Ic(0),2&t){const t=e.$implicit,i=V.ic(2);V.Kc(" ",i.NO(t.index)," ")}}function ac(t,e){if(1&t){const t=V.Wb();V.Vb(0,"div",30),V.Vb(1,"button",32),V.fc("click",function(){V.Ac(t);const i=e.$implicit;return V.ic(2).openKPIScoreGMModalComponent(i)}),V.Ic(2,"KPI Score"),V.Ub(),V.Ub()}}function rc(t,e){if(1&t&&(V.Vb(0,"ejs-grid",20,21),V.Vb(2,"e-columns"),V.Vb(3,"e-column",22),V.Gc(4,cc,1,1,"ng-template",null,23,V.Hc),V.Ub(),V.Qb(6,"e-column",34),V.Vb(7,"e-column",25),V.Gc(8,ac,3,0,"ng-template",null,23,V.Hc),V.Ub(),V.Ub(),V.Ub()),2&t){const t=V.ic();V.oc("dataSource",t.gridData)("allowPaging",!0)("allowResizing",!0)("showColumnMenu",!0)("toolbar",t.toolbarOptions)("pageSettings",t.pageSettings)("allowExcelExport",!0)}}function sc(t,e){if(1&t){const t=V.Wb();V.Vb(0,"div",38),V.Vb(1,"h4",39),V.Qb(2,"i",40),V.Ic(3," Import Excel "),V.Ub(),V.Vb(4,"button",41),V.fc("click",function(){return e.$implicit.dismiss("Cross click")}),V.Vb(5,"span",42),V.Ic(6,"\xd7"),V.Ub(),V.Ub(),V.Ub(),V.Vb(7,"div",43),V.Vb(8,"div",0),V.Vb(9,"div",44),V.Vb(10,"div",2),V.Vb(11,"label",45),V.Ic(12,"Select File (*Notice: Excel file must be followed a system template. If you do not have a template, please "),V.Vb(13,"a",46),V.Ic(14,"click here"),V.Ub(),V.Ic(15," to download. Thank you!)"),V.Ub(),V.Vb(16,"input",47),V.fc("change",function(e){return V.Ac(t),V.ic().fileProgress(e)}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(17,"div",48),V.Vb(18,"button",49),V.fc("click",function(){return V.Ac(t),V.ic().uploadFile()}),V.Ic(19,"Upload File"),V.Ub(),V.Vb(20,"button",50),V.fc("click",function(){return e.$implicit.close("Close click")}),V.Ic(21,"Close"),V.Ub(),V.Ub()}if(2&t){const t=V.ic();V.Cb(13),V.oc("href",t.excelDownloadUrl,V.Cc)}}const lc=[{path:"",data:{title:"Transaction",breadcrumb:"Transaction"},children:[{path:"objective",component:oe,data:{title:"Objective",breadcrumb:"KPI Objective",functionCode:"objective"}},{path:"todolist",component:Eo,data:{title:"To Do List",breadcrumb:"To Do List",functionCode:"todolist"}},{path:"todolist2",component:(()=>{class t{constructor(t,e,i,o,n,c,a,r,s){this.service=t,this.router=e,this.alertify=i,this.todolistService=o,this.todolist2Service=n,this.accountGroupService=c,this.modalService=a,this.datePipe=r,this.performanceService=s,this.toolbarOptions=["Search"],this.pageSettings={pageCount:20,pageSizes:!0,pageSize:10},this.editSettings={showDeleteConfirmDialog:!1,allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},this.KPI=se.KPI,this.Attitude=se.Attitude,this.index=1,this.subscription=[],this.sheetName="Upload Details",this.isAuthorize=!1}ngOnDestroy(){this.subscription.forEach(t=>t.unsubscribe())}onChangeReportTime(t){this.loadData()}ngOnInit(){this.currentTime=new Date,this.content="",this.loadAccountGroupData(),this.subscription.push(this.todolist2Service.currentMessage.subscribe(t=>{t&&this.loadData()}))}isAllowAccess(t){return(JSON.parse(localStorage.getItem("user")).accountGroupPositions||[]).includes(t)}loadData(){switch(this.currentTimeRequest=this.datePipe.transform(this.currentTime,"YYYY-MM-dd HH:mm"),1){case ce.L0:this.scoreType=re.L0,this.loadDataL0();break;case ce.L1:this.scoreType=re.L1;break;case ce.FunctionalLeader:this.scoreType=re.FunctionalLeader;break;case ce.L2:this.scoreType=re.L2;break;case ce.Updater:this.scoreType=re.FHO;break;case ce.GHR:this.scoreType=re.GHR;break;case ce.GM:this.scoreType=re.GM}}selected(t){var e,i;this.currentTimeRequest=this.datePipe.transform(this.currentTime,"YYYY-MM-dd HH:mm"),this.index=t.selectedIndex+1;let o=0;switch(this.content=t.selectedItem.outerText,""===this.content?(this.content=null===(e=this.accountGroupData[0])||void 0===e?void 0:e.name,o=ce[null===(i=this.accountGroupData[0])||void 0===i?void 0:i.name]||0):o=ce[t.selectedItem.outerText],o){case ce.L0:this.scoreType=re.L0,this.loadDataL0();break;case ce.L1:this.scoreType=re.L1;break;case ce.GFL:this.scoreType=re.FunctionalLeader;break;case ce.L2:this.scoreType=re.L2;break;case ce.Updater:this.scoreType=re.FHO;break;case ce.GHR:this.scoreType=re.GHR;break;case ce.GM:this.scoreType=re.GM}}getGridTemplate(t){const e=this.Gridtemplates.find(e=>e.name===t+"");return e?e.template:null}loadDataL0(){this.gridData=[],this.todolist2Service.l0(this.currentTimeRequest).subscribe(t=>{this.gridData=t})}loadDataL1(){this.gridData=[],this.todolistService.l1(this.currentTimeRequest).subscribe(t=>{this.gridData=t}),this.gridData=[]}loadDataUpdater(){this.gridData=[],this.todolistService.updater(this.currentTimeRequest).subscribe(t=>{this.gridData=t})}loadDataFunctionalLeader(){this.gridData=[],this.todolistService.functionalLeader(this.currentTimeRequest).subscribe(t=>{this.gridData=t})}loadDataL2(){this.gridData=[],this.todolistService.l2(this.currentTimeRequest).subscribe(t=>{this.gridData=t})}loadDataFHO(){this.gridData=[],this.todolistService.fho(this.currentTimeRequest).subscribe(t=>{this.gridData=t})}loadDataGHR(){this.gridData=[],this.todolistService.ghr(this.currentTimeRequest).subscribe(t=>{this.gridData=t})}loadDataGM(){this.gridData=[],this.todolistService.gm(this.currentTimeRequest).subscribe(t=>{this.gridData=t})}loadAccountGroupData(){this.accountGroupService.getAccountGroupForTodolistByAccountId().subscribe(t=>{this.accountGroupData=t,this.loadData()})}gotoUpdate(){return this.router.navigateByUrl("/transaction/upload-kpi-objective")}openActionModalComponent(t){const e=this.modalService.open(hn,{size:"xl",backdrop:"static",keyboard:!1});e.componentInstance.data=t,e.componentInstance.currentTime=this.currentTime,e.result.then(t=>{},t=>{})}openUpdatePdcaModalComponent(t){const e=this.modalService.open(ln,{size:"xxl",backdrop:"static",keyboard:!1});e.componentInstance.data=t,e.componentInstance.currentTime=this.currentTime,e.result.then(t=>{},t=>{})}openSelfScoreModalComponent(t){}openKPIScoreModalComponent(t){}openKPIScoreL2ModalComponent(t){}openKPIScoreGHRModalComponent(t){}openKPIScoreGMModalComponent(t){}openAttitudeScoreModalComponent(t){}openAttitudeScoreL2ModalComponent(t){}openAttitudeScoreGHRModalComponent(t){}openAttitudeScoreFunctionalLeaderModalComponent(t){}openImportExcelModalComponent(){this.excelDownloadUrl=`${C.a.apiUrl}todolist/ExcelExport`,this.modalReference=this.modalService.open(this.importModal,{size:"xl"})}fileProgress(t){this.file=t.target.files[0]}uploadFile(){const t=JSON.parse(localStorage.getItem("user")).id;this.todolistService.import(this.file,t).subscribe(t=>{this.loadDataFHO(),this.alertify.success("The excel has been imported into system!"),this.modalService.dismissAll()},t=>{this.alertify.error(t,!0)})}NO(t){return(this.grid.pageSettings.currentPage-1)*this.pageSettings.pageSize+Number(t)+1}}return t.\u0275fac=function(e){return new(e||t)(V.Pb(Ht),V.Pb(L.c),V.Pb(f.a),V.Pb(ue),V.Pb(O),V.Pb(v.a),V.Pb(k.b),V.Pb(n.e),V.Pb(ne))},t.\u0275cmp=V.Jb({type:t,selectors:[["app-todolist2"]],viewQuery:function(t,e){if(1&t&&(V.Mc(pn,1),V.Mc(gn,1),V.Mc(fn,1),V.Mc(_i,1)),2&t){let t;V.wc(t=V.gc())&&(e.grid=t.first),V.wc(t=V.gc())&&(e.importModal=t.first),V.wc(t=V.gc())&&(e.spreadsheetObj=t.first),V.wc(t=V.gc())&&(e.Gridtemplates=t)}},features:[V.Bb([n.e])],decls:27,vars:2,consts:[[1,"row"],[1,"col-md-3","d-flex","justify-content-center"],[1,"form-group"],["for","exampleInputEmail1"],[2,"width","100%",3,"ngModel","ngModelChange","valueChange"],[1,"card"],[1,"card-body"],["id","element",3,"selected"],[4,"ngFor","ngForOf"],["name","1"],["GridtemplateRef",""],["name","2"],["name","3"],["name","4"],["name","5"],["name","6"],["importModal",""],[3,"content"],["headerText",""],[4,"ngIf"],["gridLines","Both",3,"dataSource","allowPaging","allowResizing","showColumnMenu","toolbar","pageSettings","allowExcelExport"],["grid",""],["field","#","headerText","#","textAlign","Center","width","80","type","number"],["template",""],["field","topic","headerText","KPI Objective","type","string"],["field","option","headerText","Option"],["class","badge badge-danger",4,"ngIf"],["class","badge badge-success",4,"ngIf"],[1,"badge","badge-danger"],[1,"badge","badge-success"],[1,"btn-group"],["type","button","class","btn btn-sm btn-success mr-2",3,"click",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-success","mr-2",3,"click"],[2,"text-align","center","color","red","font-size","xx-large"],["field","objective","headerText","KPI Objective","type","string"],["field","title","headerText","KPI Objective","type","string"],["field","objective","headerText","Objective","type","string"],["type","button",1,"btn","btn-sm","btn-secondary","mr-2",3,"click"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-plus"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"col-md-6"],["for","Name"],[3,"href"],["name","file","type","file",1,"form-control",3,"change"],[1,"modal-footer"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(t,e){1&t&&(V.Vb(0,"div",0),V.Vb(1,"div",1),V.Vb(2,"div",2),V.Vb(3,"label",3),V.Ic(4,"Change System Date"),V.Ub(),V.Vb(5,"kendo-datepicker",4),V.fc("ngModelChange",function(t){return e.currentTime=t})("valueChange",function(t){return e.onChangeReportTime(t)}),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Vb(6,"div",5),V.Vb(7,"div",6),V.Vb(8,"ejs-tab",7),V.fc("selected",function(t){return e.selected(t)}),V.Vb(9,"e-tabitems"),V.Gc(10,yn,4,1,"ng-container",8),V.Ub(),V.Ub(),V.Ub(),V.Ub(),V.Gc(11,Dn,2,2,"ng-template",9,10,V.Hc),V.Gc(13,jn,2,2,"ng-template",11,10,V.Hc),V.Gc(15,Nn,2,2,"ng-template",12,10,V.Hc),V.Gc(17,Jn,11,7,"ng-template",13,10,V.Hc),V.Gc(19,Zn,2,2,"ng-template",14,10,V.Hc),V.Gc(21,nc,2,2,"ng-template",15,10,V.Hc),V.Gc(23,rc,10,7,"ng-template",null,10,V.Hc),V.Gc(25,sc,22,1,"ng-template",null,16,V.Hc)),2&t&&(V.Cb(5),V.oc("ngModel",e.currentTime),V.Cb(5),V.oc("ngForOf",e.accountGroupData))},directives:[r.b,c.f,c.i,Ni.a,Ni.c,n.l,_i,Ni.b,n.m,d.g,d.d,d.b,G.d,G.b,j.d,d.c,d.a,G.c,G.a,j.c],styles:[""]}),t})(),data:{title:"To Do List 2",breadcrumb:"To Do List 2",functionCode:"todolist"}},{path:"meeting",component:Bt,data:{title:"Meeting",breadcrumb:"Meeting",functionCode:"meeting"}},{path:"upload-kpi-objective",component:Ho,data:{title:"Upload KPI Objective",breadcrumb:"Upload KPI Objective",functionCode:"todolist"}}]}];let dc,bc=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=V.Nb({type:t}),t.\u0275inj=V.Mb({imports:[[L.g.forChild(lc)],L.g]}),t})();function uc(t){return new b.a(t,"./assets/i18n/",".json")}const hc=localStorage.getItem("lang");Object(u.eb)(i("2PVe"),i("GFvd"),i("GFWS"),i("0zpJ"),i("LRxf")),Object(u.eb)(i("2PVe"),i("oP7I"),i("Joj5"),i("3JeS"),i("LRxf")),Object(u.eb)(i("2PVe"),i("1OsK"),i("pm0Y"),i("K8f6"),i("LRxf")),"vi"===hc?dc=hc:"en"===hc?dc="en":"zh"===hc&&(dc="zh");let pc=(()=>{class t{constructor(t){this.translate=t,t.addLangs(["en","zh","vi"]),"vi"===hc?(dc="vi",setTimeout(()=>{u.q.load(i("+7Wi")),Object(u.qb)("vi")})):"en"===hc?(dc="en",setTimeout(()=>{u.q.load(i("7j5C")),Object(u.qb)("en")})):(dc="zh",setTimeout(()=>{u.q.load(i("7e+1")),Object(u.qb)("zh")})),t.use(dc)}}return t.\u0275fac=function(e){return new(e||t)(V.cc(a.d))},t.\u0275mod=V.Nb({type:t}),t.\u0275inj=V.Mb({imports:[[n.c,R.c,c.b,c.k,l.c,d.f,G.e,s.a,s.b,bc,r.a,Ni.e,l.d,o.b,Ni.d,j.k,Jo.b,dn.b,a.b.forChild({loader:{provide:a.a,useFactory:uc,deps:[h.b]},defaultLanguage:dc})]]}),t})()},qb46:function(t,e,i){t.exports=function(t){"use strict";var e=(t=t&&t.hasOwnProperty("default")?t.default:t).helpers,i=function(){if("undefined"!=typeof window){if(window.devicePixelRatio)return window.devicePixelRatio;var t=window.screen;if(t)return(t.deviceXDPI||1)/(t.logicalXDPI||1)}return 1}(),o={toTextLines:function(t){var i,o=[];for(t=[].concat(t);t.length;)"string"==typeof(i=t.pop())?o.unshift.apply(o,i.split("\n")):Array.isArray(i)?t.push.apply(t,i):e.isNullOrUndef(t)||o.unshift(""+i);return o},toFontString:function(t){return!t||e.isNullOrUndef(t.size)||e.isNullOrUndef(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family},textSize:function(t,e,i){var o,n=[].concat(e),c=n.length,a=t.font,r=0;for(t.font=i.string,o=0;o<c;++o)r=Math.max(t.measureText(n[o]).width,r);return t.font=a,{height:c*i.lineHeight,width:r}},parseFont:function(i){var n=t.defaults.global,c=e.valueOrDefault(i.size,n.defaultFontSize),a={family:e.valueOrDefault(i.family,n.defaultFontFamily),lineHeight:e.options.toLineHeight(i.lineHeight,c),size:c,style:e.valueOrDefault(i.style,n.defaultFontStyle),weight:e.valueOrDefault(i.weight,null),string:""};return a.string=o.toFontString(a),a},bound:function(t,e,i){return Math.max(t,Math.min(e,i))},arrayDiff:function(t,e){var i,o,n,c,a=t.slice(),r=[];for(i=0,n=e.length;i<n;++i)-1===(o=a.indexOf(c=e[i]))?r.push([c,1]):a.splice(o,1);for(i=0,n=a.length;i<n;++i)r.push([a[i],-1]);return r},rasterize:function(t){return Math.round(t*i)/i}};function n(t,e){var i=e.x,o=e.y;if(null===i)return{x:0,y:-1};if(null===o)return{x:1,y:0};var n=t.x-i,c=t.y-o,a=Math.sqrt(n*n+c*c);return{x:a?n/a:0,y:a?c/a:-1}}function c(t,e,i){var o=0;return t<i.left?o|=1:t>i.right&&(o|=2),e<i.top?o|=8:e>i.bottom&&(o|=4),o}function a(t,e){var i,o,n=e.anchor,a=t;return e.clamp&&(a=function(t,e){for(var i,o,n,a=t.x0,r=t.y0,s=t.x1,l=t.y1,d=c(a,r,e),b=c(s,l,e);d|b&&!(d&b);)8&(i=d||b)?(o=a+(s-a)*(e.top-r)/(l-r),n=e.top):4&i?(o=a+(s-a)*(e.bottom-r)/(l-r),n=e.bottom):2&i?(n=r+(l-r)*(e.right-a)/(s-a),o=e.right):1&i&&(n=r+(l-r)*(e.left-a)/(s-a),o=e.left),i===d?d=c(a=o,r=n,e):b=c(s=o,l=n,e);return{x0:a,x1:s,y0:r,y1:l}}(a,e.area)),"start"===n?(i=a.x0,o=a.y0):"end"===n?(i=a.x1,o=a.y1):(i=(a.x0+a.x1)/2,o=(a.y0+a.y1)/2),function(t,e,i,o,n){switch(n){case"center":i=o=0;break;case"bottom":i=0,o=1;break;case"right":i=1,o=0;break;case"left":i=-1,o=0;break;case"top":i=0,o=-1;break;case"start":i=-i,o=-o;break;case"end":break;default:n*=Math.PI/180,i=Math.cos(n),o=Math.sin(n)}return{x:t,y:e,vx:i,vy:o}}(i,o,t.vx,t.vy,e.align)}var r={arc:function(t,e){var i=(t.startAngle+t.endAngle)/2,o=Math.cos(i),n=Math.sin(i),c=t.innerRadius,r=t.outerRadius;return a({x0:t.x+o*c,y0:t.y+n*c,x1:t.x+o*r,y1:t.y+n*r,vx:o,vy:n},e)},point:function(t,e){var i=n(t,e.origin),o=i.x*t.radius,c=i.y*t.radius;return a({x0:t.x-o,y0:t.y-c,x1:t.x+o,y1:t.y+c,vx:i.x,vy:i.y},e)},rect:function(t,e){var i=n(t,e.origin),o=t.x,c=t.y,r=0,s=0;return t.horizontal?(o=Math.min(t.x,t.base),r=Math.abs(t.base-t.x)):(c=Math.min(t.y,t.base),s=Math.abs(t.base-t.y)),a({x0:o,y0:c+s,x1:o+r,y1:c,vx:i.x,vy:i.y},e)},fallback:function(t,e){var i=n(t,e.origin);return a({x0:t.x,y0:t.y,x1:t.x,y1:t.y,vx:i.x,vy:i.y},e)}},s=t.helpers,l=o.rasterize;function d(t){var e=t._model.horizontal,i=t._scale||e&&t._xScale||t._yScale;if(!i)return null;if(void 0!==i.xCenter&&void 0!==i.yCenter)return{x:i.xCenter,y:i.yCenter};var o=i.getBasePixel();return e?{x:o,y:null}:{x:null,y:o}}function b(t,e,i){var o=t.shadowBlur,n=i.stroked,c=l(i.x),a=l(i.y),r=l(i.w);n&&t.strokeText(e,c,a,r),i.filled&&(o&&n&&(t.shadowBlur=0),t.fillText(e,c,a,r),o&&n&&(t.shadowBlur=o))}var u=function(t,e,i,o){var n=this;n._config=t,n._index=o,n._model=null,n._rects=null,n._ctx=e,n._el=i};s.extend(u.prototype,{_modelize:function(e,i,n,c){var a,l=this._index,b=s.options.resolve,u=o.parseFont(b([n.font,{}],c,l)),h=b([n.color,t.defaults.global.defaultFontColor],c,l);return{align:b([n.align,"center"],c,l),anchor:b([n.anchor,"center"],c,l),area:c.chart.chartArea,backgroundColor:b([n.backgroundColor,null],c,l),borderColor:b([n.borderColor,null],c,l),borderRadius:b([n.borderRadius,0],c,l),borderWidth:b([n.borderWidth,0],c,l),clamp:b([n.clamp,!1],c,l),clip:b([n.clip,!1],c,l),color:h,display:e,font:u,lines:i,offset:b([n.offset,0],c,l),opacity:b([n.opacity,1],c,l),origin:d(this._el),padding:s.options.toPadding(b([n.padding,0],c,l)),positioner:(a=this._el,a instanceof t.elements.Arc?r.arc:a instanceof t.elements.Point?r.point:a instanceof t.elements.Rectangle?r.rect:r.fallback),rotation:b([n.rotation,0],c,l)*(Math.PI/180),size:o.textSize(this._ctx,i,u),textAlign:b([n.textAlign,"start"],c,l),textShadowBlur:b([n.textShadowBlur,0],c,l),textShadowColor:b([n.textShadowColor,h],c,l),textStrokeColor:b([n.textStrokeColor,h],c,l),textStrokeWidth:b([n.textStrokeWidth,0],c,l)}},update:function(t){var e,i,n,c=this,a=null,r=null,l=c._index,d=c._config,b=s.options.resolve([d.display,!0],t,l);b&&(i=s.valueOrDefault(s.callback(d.formatter,[e=t.dataset.data[l],t]),e),(n=s.isNullOrUndef(i)?[]:o.toTextLines(i)).length&&(r=function(t){var e=t.borderWidth||0,i=t.padding,o=t.size.height,n=t.size.width,c=-n/2,a=-o/2;return{frame:{x:c-i.left-e,y:a-i.top-e,w:n+i.width+2*e,h:o+i.height+2*e},text:{x:c,y:a,w:n,h:o}}}(a=c._modelize(b,n,d,t)))),c._model=a,c._rects=r},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(t,e){var i,n=t.ctx,c=this._model,a=this._rects;this.visible()&&(n.save(),c.clip&&(i=c.area,n.beginPath(),n.rect(i.left,i.top,i.right-i.left,i.bottom-i.top),n.clip()),n.globalAlpha=o.bound(0,c.opacity,1),n.translate(l(e.x),l(e.y)),n.rotate(c.rotation),function(t,e,i){var o=i.backgroundColor,n=i.borderColor,c=i.borderWidth;(o||n&&c)&&(t.beginPath(),s.canvas.roundedRect(t,l(e.x)+c/2,l(e.y)+c/2,l(e.w)-c,l(e.h)-c,i.borderRadius),t.closePath(),o&&(t.fillStyle=o,t.fill()),n&&c&&(t.strokeStyle=n,t.lineWidth=c,t.lineJoin="miter",t.stroke()))}(n,a.frame,c),function(t,e,i,o){var n,c=o.textAlign,a=o.color,r=!!a,s=o.font,l=e.length,d=o.textStrokeColor,u=o.textStrokeWidth,h=d&&u;if(l&&(r||h))for(i=function(t,e,i){var o=i.lineHeight,n=t.w,c=t.x;return"center"===e?c+=n/2:"end"!==e&&"right"!==e||(c+=n),{h:o,w:n,x:c,y:t.y+o/2}}(i,c,s),t.font=s.string,t.textAlign=c,t.textBaseline="middle",t.shadowBlur=o.textShadowBlur,t.shadowColor=o.textShadowColor,r&&(t.fillStyle=a),h&&(t.lineJoin="round",t.lineWidth=u,t.strokeStyle=d),n=0,l=e.length;n<l;++n)b(t,e[n],{stroked:h,filled:r,w:i.w,x:i.x,y:i.y+i.h*n})}(n,c.lines,a.text,c),n.restore())}});var h=Number.MIN_SAFE_INTEGER||-9007199254740991,p=Number.MAX_SAFE_INTEGER||9007199254740991;function g(t,e,i){var o=Math.cos(i),n=Math.sin(i),c=e.x,a=e.y;return{x:c+o*(t.x-c)-n*(t.y-a),y:a+n*(t.x-c)+o*(t.y-a)}}function f(t,e){var i,o,n,c=p,a=h,r=e.origin;for(i=0;i<t.length;++i)n=e.vx*((o=t[i]).x-r.x)+e.vy*(o.y-r.y),c=Math.min(c,n),a=Math.max(a,n);return{min:c,max:a}}function m(t,e){var i=e.x-t.x,o=e.y-t.y,n=Math.sqrt(i*i+o*o);return{vx:(e.x-t.x)/n,vy:(e.y-t.y)/n,origin:t,ln:n}}var y=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};function v(t,e,i){var o=e.positioner(t,e),n=o.vx,c=o.vy;if(!n&&!c)return{x:o.x,y:o.y};var a=i.w,r=i.h,s=e.rotation,l=Math.abs(a/2*Math.cos(s))+Math.abs(r/2*Math.sin(s)),d=Math.abs(a/2*Math.sin(s))+Math.abs(r/2*Math.cos(s)),b=1/Math.max(Math.abs(n),Math.abs(c));return l*=n*b,d*=c*b,{x:o.x+(l+=e.offset*n),y:o.y+(d+=e.offset*c)}}t.helpers.extend(y.prototype,{center:function(){var t=this._rect;return{x:t.x+t.w/2,y:t.y+t.h/2}},update:function(t,e,i){this._rotation=i,this._rect={x:e.x+t.x,y:e.y+t.y,w:e.w,h:e.h}},contains:function(t){var e=this._rect;return!((t=g(t,this.center(),-this._rotation)).x<e.x-1||t.y<e.y-1||t.x>e.x+e.w+2||t.y>e.y+e.h+2)},intersects:function(t){var e,i,o,n=this._points(),c=t._points(),a=[m(n[0],n[1]),m(n[0],n[3])];for(this._rotation!==t._rotation&&a.push(m(c[0],c[1]),m(c[0],c[3])),e=0;e<a.length;++e)if(i=f(n,a[e]),o=f(c,a[e]),i.max<o.min||o.max<i.min)return!1;return!0},_points:function(){var t=this._rect,e=this._rotation,i=this.center();return[g({x:t.x,y:t.y},i,e),g({x:t.x+t.w,y:t.y},i,e),g({x:t.x+t.w,y:t.y+t.h},i,e),g({x:t.x,y:t.y+t.h},i,e)]}});var I={prepare:function(t){var e,i,o,n,c,a=[];for(e=0,o=t.length;e<o;++e)for(i=0,n=t[e].length;i<n;++i)a.push(c=t[e][i]),c.$layout={_box:new y,_hidable:!1,_visible:!0,_set:e,_idx:i};return a.sort(function(t,e){var i=t.$layout,o=e.$layout;return i._idx===o._idx?o._set-i._set:o._idx-i._idx}),this.update(a),a},update:function(t){var e,i,o,n,c,a=!1;for(e=0,i=t.length;e<i;++e)n=(o=t[e]).model(),(c=o.$layout)._hidable=n&&"auto"===n.display,c._visible=o.visible(),a|=c._hidable;a&&function(t){var e,i,o,n,c,a;for(e=0,i=t.length;e<i;++e)(n=(o=t[e]).$layout)._visible&&(c=o.geometry(),a=v(o._el._model,o.model(),c),n._box.update(a,c,o.rotation()));!function(t,e){var i,o,n,c;for(i=t.length-1;i>=0;--i)for(n=t[i].$layout,o=i-1;o>=0&&n._visible;--o)(c=t[o].$layout)._visible&&n._box.intersects(c._box)&&e(n,c)}(t,function(t,e){var i=t._hidable,o=e._hidable;i&&o||o?e._visible=!1:i&&(t._visible=!1)})}(t)},lookup:function(t,e){var i,o;for(i=t.length-1;i>=0;--i)if((o=t[i].$layout)&&o._visible&&o._box.contains(e))return t[i];return null},draw:function(t,e){var i,o,n,c,a,r;for(i=0,o=e.length;i<o;++i)(c=(n=e[i]).$layout)._visible&&(a=n.geometry(),r=v(n._el._view,n.model(),a),c._box.update(r,a,n.rotation()),n.draw(t,r))}},S=t.helpers,U=t.helpers;function C(t,e,i){if(e){var o,n=i.$context,c=i.$groups;e[c._set]&&(o=e[c._set][c._key])&&!0===U.callback(o,[n])&&(t.$datalabels._dirty=!0,i.update(n))}}t.defaults.global.plugins.datalabels={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:function(t){if(S.isNullOrUndef(t))return null;var e,i,o,n=t;if(S.isObject(t))if(S.isNullOrUndef(t.label))if(S.isNullOrUndef(t.r))for(n="",o=0,i=(e=Object.keys(t)).length;o<i;++o)n+=(0!==o?", ":"")+e[o]+": "+t[e[o]];else n=t.r;else n=t.label;return""+n},labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0};var V={id:"datalabels",beforeInit:function(t){t.$datalabels={_actives:[]}},beforeUpdate:function(t){var e=t.$datalabels;e._listened=!1,e._listeners={},e._datasets=[],e._labels=[]},afterDatasetUpdate:function(t,e,i){var o,n,c,a,r,s,l,d,b=e.index,h=t.$datalabels,p=h._datasets[b]=[],g=t.isDatasetVisible(b),f=t.data.datasets[b],m=function(t,e){var i,o,n=t.datalabels,c={},a=[];return!1===n?null:(!0===n&&(n={}),e=U.merge({},[e,n]),i=e.labels||{},o=Object.keys(i),delete e.labels,o.length?o.forEach(function(t){i[t]&&a.push(U.merge({},[e,i[t],{_key:t}]))}):a.push(e),c=a.reduce(function(t,e){return U.each(e.listeners||{},function(i,o){t[o]=t[o]||{},t[o][e._key||"$default"]=i}),delete e.listeners,t},{}),{labels:a,listeners:c})}(f,i),y=e.meta.data||[],v=t.ctx;for(v.save(),o=0,c=y.length;o<c;++o)if((l=y[o]).$datalabels=[],g&&l&&!l.hidden&&!l._model.skip)for(n=0,a=m.labels.length;n<a;++n)s=(r=m.labels[n])._key,(d=new u(r,v,l,o)).$groups={_set:b,_key:s||"$default"},d.$context={active:!1,chart:t,dataIndex:o,dataset:f,datasetIndex:b},d.update(d.$context),l.$datalabels.push(d),p.push(d);v.restore(),U.merge(h._listeners,m.listeners,{merger:function(t,i,o){i[t]=i[t]||{},i[t][e.index]=o[t],h._listened=!0}})},afterUpdate:function(t,e){t.$datalabels._labels=I.prepare(t.$datalabels._datasets,e)},afterDatasetsDraw:function(t){I.draw(t,t.$datalabels._labels)},beforeEvent:function(t,e){if(t.$datalabels._listened)switch(e.type){case"mousemove":case"mouseout":!function(t,e){var i,o,n=t.$datalabels,c=n._listeners;if(c.enter||c.leave){if("mousemove"===e.type)o=I.lookup(n._labels,e);else if("mouseout"!==e.type)return;i=n._hovered,n._hovered=o,function(t,e,i,o){var n,c;(i||o)&&(i?o?i!==o&&(c=n=!0):c=!0:n=!0,c&&C(t,e.leave,i),n&&C(t,e.enter,o))}(t,c,i,o)}}(t,e);break;case"click":!function(t,e){var i=t.$datalabels,o=i._listeners.click,n=o&&I.lookup(i._labels,e);n&&C(t,o,n)}(t,e)}},afterEvent:function(e){var i,n,c,a,r,s,l,d=e.$datalabels,b=d._actives,u=d._actives=e.lastActive||[],h=o.arrayDiff(b,u);for(i=0,n=h.length;i<n;++i)if((r=h[i])[1])for(c=0,a=(l=r[0].$datalabels||[]).length;c<a;++c)(s=l[c]).$context.active=1===r[1],s.update(s.$context);(d._dirty||h.length)&&(I.update(d._labels),function(e){if(!e.animating){for(var i=t.animationService.animations,o=0,n=i.length;o<n;++o)if(i[o].chart===e)return;e.render({duration:1,lazy:!0})}}(e)),delete d._dirty}};return t.plugins.register(V),V}(i("MO+k"))}}]);